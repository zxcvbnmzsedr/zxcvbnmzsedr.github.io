(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{380:function(t,a,s){"use strict";s.r(a);var r=s(7),e=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"解决爱快安装debian虚拟机中ksoftirqd高cpu占用问题的有效方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决爱快安装debian虚拟机中ksoftirqd高cpu占用问题的有效方案"}},[t._v("#")]),t._v(" 解决爱快安装Debian虚拟机中ksoftirqd高CPU占用问题的有效方案")]),t._v(" "),a("p",[t._v("在爱快安装虚拟机过程中，遇到ksoftirqd CPU占用异常高的情况，但是网络占用一直上不去，导致系统性能下降。")]),t._v(" "),a("p",[t._v("经过猜测与分析，这一问题可能与未安装virtio驱动有关。本文将介绍一种有效的解决方案，以优化系统性能并提升IO性能。")]),t._v(" "),a("h2",{attrs:{id:"问题背景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#问题背景"}},[t._v("#")]),t._v(" 问题背景")]),t._v(" "),a("p",[t._v("爱快内置Debian虚拟机在半虚拟化网卡模式下，某些情况下可能触发ksoftirqd CPU占用100%的问题。通过初步分析，有理由怀疑这一问题可能源于"),a("a",{attrs:{href:"https://wiki.debian.org/DebianKVMGuests",target:"_blank",rel:"noopener noreferrer"}},[t._v("未安装virtio驱动"),a("OutboundLink")],1),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"解决方案步骤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解决方案步骤"}},[t._v("#")]),t._v(" 解决方案步骤")]),t._v(" "),a("h3",{attrs:{id:"_1-编辑initramfs-tools配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-编辑initramfs-tools配置文件"}},[t._v("#")]),t._v(" 1. 编辑initramfs-tools配置文件")]),t._v(" "),a("p",[t._v("打开终端，使用以下命令编辑"),a("code",[t._v("/etc/initramfs-tools/modules")]),t._v("​文件：")]),t._v(" "),a("div",{staticClass:"language-pgsql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("vim /etc/initramfs-tools/modules\n")])])]),a("h3",{attrs:{id:"_2-添加virtio驱动模块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-添加virtio驱动模块"}},[t._v("#")]),t._v(" 2. 添加virtio驱动模块")]),t._v(" "),a("p",[t._v("在打开的文件中，添加以下两行，用于指定加载virtio_pci和virtio_blk模块：")]),t._v(" "),a("div",{staticClass:"language-pgsql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("virtio_pci\nvirtio_blk\n")])])]),a("p",[t._v("保存文件后，使用以下命令重新编译并安装：")]),t._v(" "),a("div",{staticClass:"language-pgsql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("update-initramfs -u\n")])])]),a("h3",{attrs:{id:"_3-重启系统"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-重启系统"}},[t._v("#")]),t._v(" 3. 重启系统")]),t._v(" "),a("p",[t._v("完成模块的重新编译和安装后，通过执行以下命令重启系统：")]),t._v(" "),a("div",{staticClass:"language-pgsql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("reboot\n")])])]),a("h2",{attrs:{id:"结果验证"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#结果验证"}},[t._v("#")]),t._v(" 结果验证")]),t._v(" "),a("p",[t._v("重启系统后，观察系统性能有明显改善，虽然检查ksoftirqd CPU占用依旧非常高，但与此同时整体的网络速度也有明显的提高。")]),t._v(" "),a("p",[t._v("通过正确安装virtio驱动，系统的IO性能可能会翻倍，提升整体虚拟机性能。")])])}),[],!1,null,null,null);a.default=e.exports}}]);