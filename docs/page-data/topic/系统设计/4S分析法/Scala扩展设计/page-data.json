{"componentChunkName":"component---src-templates-topic-post-template-js","path":"/topic/系统设计/4S分析法/Scala扩展设计","result":{"data":{"siYuan":{"excerpt":"Scala扩展设计 Optimize 优化 Maintenance 维护 处理步骤 第一步：优化 解决设计缺陷 Pull 和 Push 模式的局限性 更多的功能 Like、Follow & Unfollow、Ads 特殊情况 僵尸粉、热搜 ...","raw":"# Scala扩展设计\n\n1. Optimize 优化\n2. Maintenance 维护\n\n# 处理步骤\n\n## 第一步：优化\n\n* 解决设计缺陷\n\n  * Pull 和 Push 模式的局限性\n* 更多的功能\n\n  * Like、Follow & Unfollow、Ads\n* 特殊情况\n\n  * 僵尸粉、热搜\n\n## 第二部：维护\n\n* 健壮性\n\n  * 服务器或者数据库挂了\n* 扩展性\n\n  * 应对流量暴增的情况\n\n# Pull的缺陷\n\n![](https://image.ztianzeng.com/uPic/20220615151033.png)\n\n在用户进行读请求时，会访问每个关注的人的DB，所以这一块将会成为瓶颈\n\n1. 在访问DB之前，加入Cache\n2. 缓存每个用户的TimeLine\n\n    * N次DB请求 转化为 N次Cache请求\n3. 缓存每个用户的News Feeds\n\n    * 没有Cache News Feed的用户：归并N个用户最近的100条Tweets，取出结果前的100条\n    * 有Cache News Feed的用户：归并N个用户在某个时间戳之后的所有Tweets\n\n# Push的缺陷\n\n![](https://image.ztianzeng.com/uPic/20220615151122.png)\n\n在用户发布一篇文章时，会向关注者的TimeLine中都插入一条Tweets。\n\n* 会浪费更多的存储空间\n\n  * 每个人那都会有一条Tweets数据\n  * 存储相对内存便宜，可以接受\n* 不活跃用户的问题\n\n  * 导致每个人收到的时间不一样\n* 粉丝数量超级大，亿级\n\n  * 插入的时长即使异步，也非常慢\n  * 切换回Pull模式，需要Trade Off ： Pull 和 Push成本\n","html":"<div></div>","field":{"slug":"/topic/系统设计/4S分析法/Scala扩展设计","topic":"系统设计"},"frontmatter":{"title":"Scala扩展设计","tags":["系统设计","4S分析法"],"date":"2022-06-14","description":"Scala扩展设计 Optimize 优化 Maintenance 维护 处理步骤 第一步：优化 解决设计缺陷 Pull 和 Push 模式的局限性 更多的功能 Like、Follow & Unfollow、Ads 特殊情况 僵尸粉、热搜 ..."}},"topic":{"title":"系统设计","tree":"{\"title\":\"系统设计\",\"id\":\"20220523142842-5ohvsi1\",\"parentId\":\"\",\"href\":\"/topic/系统设计\",\"path\":\"/topic/系统设计\",\"children\":[{\"title\":\"4S分析法\",\"id\":\"20220531175247-wjawyqd\",\"type\":\"d\",\"href\":\"/topic/系统设计/4S分析法\",\"parentId\":\"\",\"path\":\"/topic/系统设计/4S分析法\",\"parentPath\":\"/topic/系统设计\",\"sort\":1,\"children\":[{\"title\":\"Scenario场景\",\"id\":\"20220531175901-ev27fyc\",\"type\":\"d\",\"href\":\"/topic/系统设计/4S分析法/Scenario场景\",\"parentId\":\"\",\"path\":\"/topic/系统设计/4S分析法/Scenario场景\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"sort\":1,\"children\":[{\"title\":\"需要设计哪些功能\",\"id\":\"20220531195141-ow2ml5e\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scenario场景#需要设计哪些功能\",\"parentId\":\"20220531175901-ev27fyc\",\"path\":\"/topic/系统设计/4S分析法/Scenario场景\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":3},{\"title\":\"需要承受的访问量\",\"id\":\"20220531203443-fb6pb36\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scenario场景#需要承受的访问量\",\"parentId\":\"20220531175901-ev27fyc\",\"path\":\"/topic/系统设计/4S分析法/Scenario场景\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":3}],\"level\":2},{\"title\":\"Service服务\",\"id\":\"20220614172546-4odjpcl\",\"type\":\"d\",\"href\":\"/topic/系统设计/4S分析法/Service服务\",\"parentId\":\"\",\"path\":\"/topic/系统设计/4S分析法/Service服务\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"sort\":2,\"children\":[],\"level\":2},{\"title\":\"Storage存储\",\"id\":\"20220614172607-izfm0ob\",\"type\":\"d\",\"href\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentId\":\"\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"sort\":3,\"children\":[{\"title\":\"存储模型\",\"id\":\"20220615132413-5oarx2u\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#存储模型\",\"parentId\":\"20220614172607-izfm0ob\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[{\"title\":\"模型对比\",\"id\":\"20220615153206-lt1196f\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#模型对比\",\"parentId\":\"20220615132413-5oarx2u\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4},{\"title\":\"典型架构设计\",\"id\":\"20220615153617-t9y0a15\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#典型架构设计\",\"parentId\":\"20220615132413-5oarx2u\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4},{\"title\":\"Pull Model 拉模型\",\"id\":\"20220615145318-tmy8g0q\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#Pull Model 拉模型\",\"parentId\":\"20220615132413-5oarx2u\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4},{\"title\":\"Push Model 推模型\",\"id\":\"20220615150822-gqx7zgj\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#Push Model 推模型\",\"parentId\":\"20220615132413-5oarx2u\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4}],\"level\":3},{\"title\":\"处理步骤\",\"id\":\"20220615145305-gjyn1u5\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#处理步骤\",\"parentId\":\"20220614172607-izfm0ob\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[{\"title\":\"第一步：为每个Service选择存储结构\",\"id\":\"20220615132802-cci7hqv\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#第一步：为每个Service选择存储结构\",\"parentId\":\"20220615145305-gjyn1u5\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4},{\"title\":\"第二步：细化表结构\",\"id\":\"20220615132817-ddcbi3h\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Storage存储#第二步：细化表结构\",\"parentId\":\"20220615145305-gjyn1u5\",\"path\":\"/topic/系统设计/4S分析法/Storage存储\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4}],\"level\":3}],\"level\":2},{\"title\":\"Scala扩展设计\",\"id\":\"20220614172632-df2ppkx\",\"type\":\"d\",\"href\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentId\":\"\",\"path\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"sort\":4,\"children\":[{\"title\":\"处理步骤\",\"id\":\"20220615164841-wh8azku\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scala扩展设计#处理步骤\",\"parentId\":\"20220614172632-df2ppkx\",\"path\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[{\"title\":\"第一步：优化\",\"id\":\"20220615164902-ro9q1e5\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scala扩展设计#第一步：优化\",\"parentId\":\"20220615164841-wh8azku\",\"path\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4},{\"title\":\"第二部：维护\",\"id\":\"20220615165043-8nj0syq\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scala扩展设计#第二部：维护\",\"parentId\":\"20220615164841-wh8azku\",\"path\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":4}],\"level\":3},{\"title\":\"Pull的缺陷\",\"id\":\"20220615165130-evylsdz\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scala扩展设计#Pull的缺陷\",\"parentId\":\"20220614172632-df2ppkx\",\"path\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":3},{\"title\":\"Push的缺陷\",\"id\":\"20220615195617-yb7ounn\",\"type\":\"h\",\"href\":\"/topic/系统设计/4S分析法/Scala扩展设计#Push的缺陷\",\"parentId\":\"20220614172632-df2ppkx\",\"path\":\"/topic/系统设计/4S分析法/Scala扩展设计\",\"parentPath\":\"/topic/系统设计/4S分析法\",\"children\":[],\"level\":3}],\"level\":2}],\"level\":1},{\"title\":\"样例\",\"id\":\"20220523161014-1vkr1si\",\"type\":\"d\",\"href\":\"/topic/系统设计/样例\",\"parentId\":\"\",\"path\":\"/topic/系统设计/样例\",\"parentPath\":\"/topic/系统设计\",\"sort\":3,\"children\":[{\"title\":\"短链系统\",\"id\":\"20220523142856-tm0dduf\",\"type\":\"d\",\"href\":\"/topic/系统设计/样例/短链系统\",\"parentId\":\"\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"sort\":1,\"children\":[{\"title\":\"概述用例和约束\",\"id\":\"20220523152802-ora3luz\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#概述用例和约束\",\"parentId\":\"20220523142856-tm0dduf\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[{\"title\":\"用例\",\"id\":\"20220523153231-cqe7c6z\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#用例\",\"parentId\":\"20220523152802-ora3luz\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"约束和假设\",\"id\":\"20220523153213-tyokdre\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#约束和假设\",\"parentId\":\"20220523152802-ora3luz\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"预估容量\",\"id\":\"20220523153245-akx221a\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#预估容量\",\"parentId\":\"20220523152802-ora3luz\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4}],\"level\":3},{\"title\":\"创建一个高层次设计\",\"id\":\"20220523154027-n2m6mb0\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#创建一个高层次设计\",\"parentId\":\"20220523142856-tm0dduf\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":3},{\"title\":\"设计核心组件\",\"id\":\"20220523155756-as6zfq4\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#设计核心组件\",\"parentId\":\"20220523142856-tm0dduf\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[{\"title\":\"用例: 用户输入一段文本，然后得到一个随机生成的链接\",\"id\":\"20220523155920-i5awrmn\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#用例: 用户输入一段文本，然后得到一个随机生成的链接\",\"parentId\":\"20220523155756-as6zfq4\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"用例：用户输入一个 paste 的 url 后可以看到它存储的内容\",\"id\":\"20220523160445-ppzjfcg\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#用例：用户输入一个 paste 的 url 后可以看到它存储的内容\",\"parentId\":\"20220523155756-as6zfq4\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"用例： 服务跟踪分析页面\",\"id\":\"20220523160523-x0zwdli\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#用例： 服务跟踪分析页面\",\"parentId\":\"20220523155756-as6zfq4\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"用例： 服务删除过期的 pastes\",\"id\":\"20220523160541-cln3fph\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#用例： 服务删除过期的 pastes\",\"parentId\":\"20220523155756-as6zfq4\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4}],\"level\":3},{\"title\":\"扩展设计\",\"id\":\"20220523160546-vbv6n9j\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#扩展设计\",\"parentId\":\"20220523142856-tm0dduf\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":3},{\"title\":\"总结\",\"id\":\"20220523163729-9u3wkrv\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/短链系统#总结\",\"parentId\":\"20220523142856-tm0dduf\",\"path\":\"/topic/系统设计/样例/短链系统\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":3}],\"level\":2},{\"title\":\"微博架构设计\",\"id\":\"20220524140048-zkiqvui\",\"type\":\"d\",\"href\":\"/topic/系统设计/样例/微博架构设计\",\"parentId\":\"\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"sort\":2,\"children\":[{\"title\":\"概述用例和约束\",\"id\":\"20220524140533-yb6pk63\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#概述用例和约束\",\"parentId\":\"20220524140048-zkiqvui\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[{\"title\":\"用例\",\"id\":\"20220524140955-hl15d6z\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#用例\",\"parentId\":\"20220524140533-yb6pk63\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"限制条件与假设\",\"id\":\"20220524142056-m6nm6xm\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#限制条件与假设\",\"parentId\":\"20220524140533-yb6pk63\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4}],\"level\":3},{\"title\":\"概要设计\",\"id\":\"20220524145303-hrsunb1\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#概要设计\",\"parentId\":\"20220524140048-zkiqvui\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":3},{\"title\":\"设计核心组件\",\"id\":\"20220524154837-c7lw852\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#设计核心组件\",\"parentId\":\"20220524140048-zkiqvui\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[{\"title\":\"用例: 用户发表了一篇微博\",\"id\":\"20220524155958-ygnj4py\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#用例: 用户发表了一篇微博\",\"parentId\":\"20220524154837-c7lw852\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"用例：用户浏览聚合主页时间轴\",\"id\":\"20220524163832-k1u2urx\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#用例：用户浏览聚合主页时间轴\",\"parentId\":\"20220524154837-c7lw852\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"用例：用户浏览用户时间轴\",\"id\":\"20220524164247-audibq3\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#用例：用户浏览用户时间轴\",\"parentId\":\"20220524154837-c7lw852\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4},{\"title\":\"用例：用户搜索关键词\",\"id\":\"20220524164312-1obgv97\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#用例：用户搜索关键词\",\"parentId\":\"20220524154837-c7lw852\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":4}],\"level\":3},{\"title\":\"架构扩展\",\"id\":\"20220524164325-q9o9ung\",\"type\":\"h\",\"href\":\"/topic/系统设计/样例/微博架构设计#架构扩展\",\"parentId\":\"20220524140048-zkiqvui\",\"path\":\"/topic/系统设计/样例/微博架构设计\",\"parentPath\":\"/topic/系统设计/样例\",\"children\":[],\"level\":3}],\"level\":2}],\"level\":1},{\"title\":\"每个程序员都应该知道的延迟数字\",\"id\":\"20220524194105-29b5zns\",\"type\":\"d\",\"href\":\"/topic/系统设计/每个程序员都应该知道的延迟数字\",\"parentId\":\"\",\"path\":\"/topic/系统设计/每个程序员都应该知道的延迟数字\",\"parentPath\":\"/topic/系统设计\",\"sort\":4,\"children\":[],\"level\":1},{\"title\":\"概念\",\"id\":\"20220615132453-664g7l0\",\"type\":\"d\",\"href\":\"/topic/系统设计/概念\",\"parentId\":\"\",\"path\":\"/topic/系统设计/概念\",\"parentPath\":\"/topic/系统设计\",\"children\":[{\"title\":\"数据库系统 VS 文件系统\",\"id\":\"20220615102743-qj0plmz\",\"type\":\"h\",\"href\":\"/topic/系统设计/概念#数据库系统 VS 文件系统\",\"parentId\":\"20220615132453-664g7l0\",\"path\":\"/topic/系统设计/概念\",\"parentPath\":\"/topic/系统设计\",\"children\":[{\"title\":\"关系\",\"id\":\"20220615102811-lmbzu19\",\"type\":\"h\",\"href\":\"/topic/系统设计/概念#关系\",\"parentId\":\"20220615102743-qj0plmz\",\"path\":\"/topic/系统设计/概念\",\"parentPath\":\"/topic/系统设计\",\"children\":[],\"level\":3},{\"title\":\"区别\",\"id\":\"20220615102835-8kegc0y\",\"type\":\"h\",\"href\":\"/topic/系统设计/概念#区别\",\"parentId\":\"20220615102743-qj0plmz\",\"path\":\"/topic/系统设计/概念\",\"parentPath\":\"/topic/系统设计\",\"children\":[],\"level\":3},{\"title\":\"总结\",\"id\":\"20220615103035-c70ck6k\",\"type\":\"h\",\"href\":\"/topic/系统设计/概念#总结\",\"parentId\":\"20220615102743-qj0plmz\",\"path\":\"/topic/系统设计/概念\",\"parentPath\":\"/topic/系统设计\",\"children\":[],\"level\":3}],\"level\":2}],\"level\":1}],\"level\":0}"}},"pageContext":{"slug":"/topic/系统设计/4S分析法/Scala扩展设计","topic":"系统设计"}},"staticQueryHashes":["1284643331","2841359383"]}