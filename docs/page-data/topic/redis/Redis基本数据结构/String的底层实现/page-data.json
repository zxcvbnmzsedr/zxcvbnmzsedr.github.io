{
    "componentChunkName": "component---src-templates-topic-page-template-tsx",
    "path": "/topic/redis/Redis基本数据结构/String的底层实现",
    "result": {"pageContext":{"id":"/topic/redis/Redis基本数据结构/String的底层实现","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"String的底层实现是SDS（Simple dynamic String）。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"SDS 结构"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","dark-default-dark"],"dataLanguage":"","dataIndex":"0"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"struct __attribute__ ((__packed__)) sdshdr8 {"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    uint8_t len; /* 当前字符串数组的长度 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    uint8_t alloc; /* 当前字符串分配的总内存大小 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    unsigned char flags; /* 当前的字符串标记，用来标识是sdshdr8,sdshdr16等 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    char buf[]; /* 字符串真正的值 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"};"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"相对于C语言的优势"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"统计长度时间复杂度 O(1)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　工作中使用redis，经常会通过STRLEN命令得到一个字符串的长度， 在SDS结构中len属性记录了字符串的长度，所以我们获取一个字符串长度直接取len的值，复杂度是O(1)。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348311","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"139.125","style":"max-width: 753.078125px;","viewBox":"-2.2109375 0 753.078125 139.125"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348311 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348311 .error-icon{fill:#552222;}#mermaid-1659928348311 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348311 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348311 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348311 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348311 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348311 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348311 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348311 .marker.cross{stroke:#333333;}#mermaid-1659928348311 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348311 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348311 .cluster-label text{fill:#333;}#mermaid-1659928348311 .cluster-label span{color:#333;}#mermaid-1659928348311 .label text,#mermaid-1659928348311 span{fill:#333;color:#333;}#mermaid-1659928348311 .node rect,#mermaid-1659928348311 .node circle,#mermaid-1659928348311 .node ellipse,#mermaid-1659928348311 .node polygon,#mermaid-1659928348311 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348311 .node .label{text-align:center;}#mermaid-1659928348311 .node.clickable{cursor:pointer;}#mermaid-1659928348311 .arrowheadPath{fill:#333333;}#mermaid-1659928348311 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348311 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348311 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348311 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348311 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348311 .cluster text{fill:#333;}#mermaid-1659928348311 .cluster span{color:#333;}#mermaid-1659928348311 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348311 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'B'"],"id":"L-'A'-'B'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M42.546875,43.84226817702845L47.08203125,41.076890147523706C51.6171875,38.31151211801897,60.6875,32.780756059009484,69.38932291666667,30.015378029504742C78.09114583333333,27.25,86.42447916666667,27.25,90.59114583333333,27.25L94.7578125,27.25","markerEnd":"url(#arrowhead46)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead46","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'B'","LE-'C'"],"id":"L-'B'-'C'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M128.921875,27.25L136.3359375,27.25C143.75,27.25,158.578125,27.25,173.40625,27.25C188.234375,27.25,203.0625,27.25,210.4765625,27.25L217.890625,27.25","markerEnd":"url(#arrowhead47)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead47","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'C'","LE-'D'"],"id":"L-'C'-'D'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M252.5703125,27.25L256.7369791666667,27.25C260.9036458333333,27.25,269.2369791666667,27.25,277.5703125,29.911760196258815C285.9036458333333,32.57352039251763,294.2369791666667,37.897040785035266,298.4036458333333,40.55880098129408L302.5703125,43.220561177552895","markerEnd":"url(#arrowhead48)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead48","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'\\0'"],"id":"L-'D'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M337.4921875,54.375L341.6588541666667,54.375C345.8255208333333,54.375,354.1588541666667,54.375,367.4921875,54.375C380.8255208333333,54.375,399.1588541666667,54.375,408.3255208333333,54.375L417.4921875,54.375","markerEnd":"url(#arrowhead49)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead49","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'1'"],"id":"L-'\\0'-'1'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M456.6796875,54.375L465.8463541666667,54.375C475.0130208333333,54.375,493.3463541666667,54.375,506.6796875,54.375C520.0130208333334,54.375,528.3463541666666,54.375,532.5130208333334,54.375L536.6796875,54.375","markerEnd":"url(#arrowhead50)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead50","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'\\0'"],"id":"L-'\\0'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M429.55489548668885,73.625L427.544444155574,78.76388888888889C425.5339928244592,83.90277777777777,421.5130901622296,94.18055555555554,419.50263883111484,100.60416666666667C417.4921875,107.02777777777777,417.4921875,109.59722222222221,420.7578125,112.16666666666667C424.0234375,114.7361111111111,430.5546875,117.30555555555554,437.0859375,117.30555555555554C443.6171875,117.30555555555554,450.1484375,114.7361111111111,453.4140625,112.16666666666667C456.6796875,109.59722222222221,456.6796875,107.02777777777777,454.66923616888516,100.60416666666667C452.6587848377704,94.18055555555554,448.6378821755408,83.90277777777777,446.627430844426,78.76388888888889L444.61697951331115,73.625","markerEnd":"url(#arrowhead51)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead51","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'1'","LE-'2'"],"id":"L-'1'-'2'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M570.1796875,54.375L574.3463541666666,54.375C578.5130208333334,54.375,586.8463541666666,54.375,595.1796875,54.375C603.5130208333334,54.375,611.8463541666666,54.375,616.0130208333334,54.375L620.1796875,54.375","markerEnd":"url(#arrowhead52)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead52","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'2'","LE-2"],"id":"L-'2'-2","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M653.6796875,54.375L657.8463541666666,54.375C662.0130208333334,54.375,670.3463541666666,54.375,678.6796875,54.375C687.0130208333334,54.375,695.3463541666666,54.375,699.5130208333334,54.375L703.6796875,54.375","markerEnd":"url(#arrowhead53)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead53","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'A'"],"id":"L-'A'-'A'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M18.45264423076923,73.625L16.71053685897436,78.54166666666667C14.968429487179487,83.45833333333333,11.484214743589744,93.29166666666667,9.742107371794871,99.4375C8,105.58333333333333,8,108.04166666666667,10.87890625,110.5C13.7578125,112.95833333333333,19.515625,115.41666666666667,25.2734375,115.41666666666667C31.03125,115.41666666666667,36.7890625,112.95833333333333,39.66796875,110.5C42.546875,108.04166666666667,42.546875,105.58333333333333,40.80476762820513,99.4375C39.062660256410254,93.29166666666667,35.578445512820515,83.45833333333333,33.83633814102564,78.54166666666667L32.09423076923077,73.625","markerEnd":"url(#arrowhead54)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead54","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'A'"],"id":"L-'D'-'A'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M302.5703125,65.5294388224471L298.4036458333333,68.19119901870592C294.2369791666667,70.85295921496474,285.9036458333333,76.17647960748236,274.6803385416667,78.83823980374119C263.45703125,81.5,249.34375,81.5,231.98307291666666,81.5C214.62239583333334,81.5,194.01432291666666,81.5,173.44921875,81.5C152.88411458333334,81.5,132.36197916666666,81.5,115.08723958333333,81.5C97.8125,81.5,83.78515625,81.5,72.236328125,78.73462197049525C60.6875,75.96924394099052,51.6171875,70.43848788198103,47.08203125,67.67310985247629L42.546875,64.90773182297156","markerEnd":"url(#arrowhead55)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead55","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'B'","className":["edgeLabel","L-LS-'A''","L-LE-'B'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'B'-'C'","className":["edgeLabel","L-LS-'B''","L-LE-'C'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'C'-'D'","className":["edgeLabel","L-LS-'C''","L-LE-'D'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'\\0'","className":["edgeLabel","L-LS-'D''","L-LE-'\\0'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'1'","className":["edgeLabel","L-LS-'\\0''","L-LE-'1'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(437.0859375,119.875)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-49.59375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"99.1875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"99.1875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'\\0'","className":["edgeLabel","L-LS-'\\0''","L-LE-'\\0'"]},"children":[{"type":"text","value":"发现'\\0'不计数"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'1'-'2'","className":["edgeLabel","L-LS-'1''","L-LE-'2'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'2'-2","className":["edgeLabel","L-LS-'2''","L-LE-2"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(25.2734375,117.875)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-19.484375,-9.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"38.96875","height":"18.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"38.96875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'A'","className":["edgeLabel","L-LS-'A''","L-LE-'A'"]},"children":[{"type":"text","value":"len=1"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(173.40625,81.5)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-19.484375,-9.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"38.96875","height":"18.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"38.96875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'A'","className":["edgeLabel","L-LS-'D''","L-LE-'A'"]},"children":[{"type":"text","value":"len=4"}]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-2-35","transform":"translate(723.2734375,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'A'-20","transform":"translate(25.2734375,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.2734375","y":"-19.25","width":"34.546875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.2734375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.546875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'A'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'B'-21","transform":"translate(111.83984375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.08203125","y":"-19.25","width":"34.1640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.08203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.1640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'B'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'C'-23","transform":"translate(235.23046875,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.33984375","y":"-19.25","width":"34.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.33984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'C'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'D'-25","transform":"translate(320.03125,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.4609375","y":"-19.25","width":"34.921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.4609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'D'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'\\0'-27","transform":"translate(437.0859375,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'1'-29","transform":"translate(553.4296875,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'1'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'2'-33","transform":"translate(636.9296875,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'2'"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　而如果用C字符串，在获取一个字符串长度时，需对整个字符串进行遍历，直至遍历到空格符结束（C中遇到空格符代表一个完整字符串），此时的复杂度是O(N)。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　在高并发场景下频繁遍历字符串，获取字符串的长度很有可能成为redis的性能瓶颈，所以SDS性能更好一些。数据溢出"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"数据溢出"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　由于C字符串是不记录自身长度的，相邻的两个字符串存储的方式可能如下图，在创建字符串的时候就分配了合适的内存空间。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348310","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"54.5","style":"max-width: 649.6875px;","viewBox":"0 0 649.6875 54.5"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348310 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348310 .error-icon{fill:#552222;}#mermaid-1659928348310 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348310 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348310 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348310 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348310 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348310 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348310 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348310 .marker.cross{stroke:#333333;}#mermaid-1659928348310 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348310 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348310 .cluster-label text{fill:#333;}#mermaid-1659928348310 .cluster-label span{color:#333;}#mermaid-1659928348310 .label text,#mermaid-1659928348310 span{fill:#333;color:#333;}#mermaid-1659928348310 .node rect,#mermaid-1659928348310 .node circle,#mermaid-1659928348310 .node ellipse,#mermaid-1659928348310 .node polygon,#mermaid-1659928348310 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348310 .node .label{text-align:center;}#mermaid-1659928348310 .node.clickable{cursor:pointer;}#mermaid-1659928348310 .arrowheadPath{fill:#333333;}#mermaid-1659928348310 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348310 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348310 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348310 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348310 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348310 .cluster text{fill:#333;}#mermaid-1659928348310 .cluster span{color:#333;}#mermaid-1659928348310 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348310 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'B'"],"id":"L-'A'-'B'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M42.546875,27.25L46.713541666666664,27.25C50.880208333333336,27.25,59.213541666666664,27.25,67.546875,27.25C75.88020833333333,27.25,84.21354166666667,27.25,88.38020833333333,27.25L92.546875,27.25","markerEnd":"url(#arrowhead37)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead37","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'B'","LE-'C'"],"id":"L-'B'-'C'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M126.7109375,27.25L130.87760416666666,27.25C135.04427083333334,27.25,143.37760416666666,27.25,151.7109375,27.25C160.04427083333334,27.25,168.37760416666666,27.25,172.54427083333334,27.25L176.7109375,27.25","markerEnd":"url(#arrowhead38)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead38","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'C'","LE-'D'"],"id":"L-'C'-'D'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M211.390625,27.25L215.55729166666666,27.25C219.72395833333334,27.25,228.05729166666666,27.25,236.390625,27.25C244.72395833333334,27.25,253.05729166666666,27.25,257.2239583333333,27.25L261.390625,27.25","markerEnd":"url(#arrowhead39)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead39","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'\\0'"],"id":"L-'D'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M296.3125,27.25L300.4791666666667,27.25C304.6458333333333,27.25,312.9791666666667,27.25,321.3125,27.25C329.6458333333333,27.25,337.9791666666667,27.25,342.1458333333333,27.25L346.3125,27.25","markerEnd":"url(#arrowhead40)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead40","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'1'"],"id":"L-'\\0'-'1'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M385.5,27.25L389.6666666666667,27.25C393.8333333333333,27.25,402.1666666666667,27.25,410.5,27.25C418.8333333333333,27.25,427.1666666666667,27.25,431.3333333333333,27.25L435.5,27.25","markerEnd":"url(#arrowhead41)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead41","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'1'","LE-'2'"],"id":"L-'1'-'2'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M469,27.25L473.1666666666667,27.25C477.3333333333333,27.25,485.6666666666667,27.25,494,27.25C502.3333333333333,27.25,510.6666666666667,27.25,514.8333333333334,27.25L519,27.25","markerEnd":"url(#arrowhead42)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead42","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'2'","LE-2"],"id":"L-'2'-2","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M552.5,27.25L556.6666666666666,27.25C560.8333333333334,27.25,569.1666666666666,27.25,577.5,27.25C585.8333333333334,27.25,594.1666666666666,27.25,598.3333333333334,27.25L602.5,27.25","markerEnd":"url(#arrowhead43)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead43","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'B'","className":["edgeLabel","L-LS-'A''","L-LE-'B'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'B'-'C'","className":["edgeLabel","L-LS-'B''","L-LE-'C'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'C'-'D'","className":["edgeLabel","L-LS-'C''","L-LE-'D'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'\\0'","className":["edgeLabel","L-LS-'D''","L-LE-'\\0'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'1'","className":["edgeLabel","L-LS-'\\0''","L-LE-'1'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'1'-'2'","className":["edgeLabel","L-LS-'1''","L-LE-'2'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'2'-2","className":["edgeLabel","L-LS-'2''","L-LE-2"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-2-27","transform":"translate(622.09375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'A'-14","transform":"translate(25.2734375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.2734375","y":"-19.25","width":"34.546875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.2734375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.546875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'A'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'B'-15","transform":"translate(109.62890625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.08203125","y":"-19.25","width":"34.1640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.08203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.1640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'B'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'C'-17","transform":"translate(194.05078125,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.33984375","y":"-19.25","width":"34.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.33984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'C'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'D'-19","transform":"translate(278.8515625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.4609375","y":"-19.25","width":"34.921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.4609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'D'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'\\0'-21","transform":"translate(365.90625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'1'-23","transform":"translate(452.25,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'1'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'2'-25","transform":"translate(535.75,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'2'"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　如果这个时候，想修改字符串 ABCD 成 ABCDE ，就会侵占相邻字符串的空间，自身数据溢出导致其他字符串的内容被修改。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348310","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"54.5","style":"max-width: 649.8671875px;","viewBox":"0 0 649.8671875 54.5"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348310 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348310 .error-icon{fill:#552222;}#mermaid-1659928348310 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348310 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348310 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348310 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348310 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348310 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348310 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348310 .marker.cross{stroke:#333333;}#mermaid-1659928348310 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348310 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348310 .cluster-label text{fill:#333;}#mermaid-1659928348310 .cluster-label span{color:#333;}#mermaid-1659928348310 .label text,#mermaid-1659928348310 span{fill:#333;color:#333;}#mermaid-1659928348310 .node rect,#mermaid-1659928348310 .node circle,#mermaid-1659928348310 .node ellipse,#mermaid-1659928348310 .node polygon,#mermaid-1659928348310 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348310 .node .label{text-align:center;}#mermaid-1659928348310 .node.clickable{cursor:pointer;}#mermaid-1659928348310 .arrowheadPath{fill:#333333;}#mermaid-1659928348310 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348310 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348310 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348310 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348310 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348310 .cluster text{fill:#333;}#mermaid-1659928348310 .cluster span{color:#333;}#mermaid-1659928348310 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348310 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'B'"],"id":"L-'A'-'B'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M42.546875,27.25L46.713541666666664,27.25C50.880208333333336,27.25,59.213541666666664,27.25,67.546875,27.25C75.88020833333333,27.25,84.21354166666667,27.25,88.38020833333333,27.25L92.546875,27.25","markerEnd":"url(#arrowhead37)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead37","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'B'","LE-'C'"],"id":"L-'B'-'C'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M126.7109375,27.25L130.87760416666666,27.25C135.04427083333334,27.25,143.37760416666666,27.25,151.7109375,27.25C160.04427083333334,27.25,168.37760416666666,27.25,172.54427083333334,27.25L176.7109375,27.25","markerEnd":"url(#arrowhead38)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead38","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'C'","LE-'D'"],"id":"L-'C'-'D'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M211.390625,27.25L215.55729166666666,27.25C219.72395833333334,27.25,228.05729166666666,27.25,236.390625,27.25C244.72395833333334,27.25,253.05729166666666,27.25,257.2239583333333,27.25L261.390625,27.25","markerEnd":"url(#arrowhead39)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead39","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'E'"],"id":"L-'D'-'E'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M296.3125,27.25L300.4791666666667,27.25C304.6458333333333,27.25,312.9791666666667,27.25,321.3125,27.25C329.6458333333333,27.25,337.9791666666667,27.25,342.1458333333333,27.25L346.3125,27.25","markerEnd":"url(#arrowhead40)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead40","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'E'","LE-'\\0'"],"id":"L-'E'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M379.9921875,27.25L384.1588541666667,27.25C388.3255208333333,27.25,396.6588541666667,27.25,404.9921875,27.25C413.3255208333333,27.25,421.6588541666667,27.25,425.8255208333333,27.25L429.9921875,27.25","markerEnd":"url(#arrowhead41)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead41","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'2'"],"id":"L-'\\0'-'2'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M469.1796875,27.25L473.3463541666667,27.25C477.5130208333333,27.25,485.8463541666667,27.25,494.1796875,27.25C502.5130208333333,27.25,510.8463541666667,27.25,515.0130208333334,27.25L519.1796875,27.25","markerEnd":"url(#arrowhead42)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead42","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'2'","LE-2"],"id":"L-'2'-2","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M552.6796875,27.25L556.8463541666666,27.25C561.0130208333334,27.25,569.3463541666666,27.25,577.6796875,27.25C586.0130208333334,27.25,594.3463541666666,27.25,598.5130208333334,27.25L602.6796875,27.25","markerEnd":"url(#arrowhead43)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead43","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'B'","className":["edgeLabel","L-LS-'A''","L-LE-'B'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'B'-'C'","className":["edgeLabel","L-LS-'B''","L-LE-'C'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'C'-'D'","className":["edgeLabel","L-LS-'C''","L-LE-'D'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'E'","className":["edgeLabel","L-LS-'D''","L-LE-'E'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'E'-'\\0'","className":["edgeLabel","L-LS-'E''","L-LE-'\\0'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'2'","className":["edgeLabel","L-LS-'\\0''","L-LE-'2'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'2'-2","className":["edgeLabel","L-LS-'2''","L-LE-2"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-2-27","transform":"translate(622.2734375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'A'-14","transform":"translate(25.2734375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.2734375","y":"-19.25","width":"34.546875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.2734375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.546875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'A'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'B'-15","transform":"translate(109.62890625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.08203125","y":"-19.25","width":"34.1640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.08203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.1640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'B'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'C'-17","transform":"translate(194.05078125,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.33984375","y":"-19.25","width":"34.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.33984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'C'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'D'-19","transform":"translate(278.8515625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.4609375","y":"-19.25","width":"34.921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.4609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'D'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'E'-21","transform":"translate(363.15234375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.83984375","y":"-19.25","width":"33.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.83984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'E'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'\\0'-23","transform":"translate(449.5859375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'2'-25","transform":"translate(535.9296875,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'2'"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　而SDS很好的规避了这点，当我们需要修改数据时，首先会检查当前SDS空间len是否满足，不满足则自动扩容空间至修改所需的大小，然后再执行修改。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"内存重分配策略"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　C字符串的长度是一定的，所以每次在增长或者是缩短字符串的时候，都需要做内存的重新分配，而内存重新分配又是一个\n比较耗时的操作。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　SDS通过两种内存重分配策略，在解决字符串增长和缩短时兼顾效率和性能"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"空间预分配 优化SDS字符串增长"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"当修改字符串并需要对SDS空间进行扩展式，不仅会分配修改所必要的空间，还会为SDS分配额外的未使用空间，\n下次修改先检查未使用空间是否满足，满足则不用再扩展空间。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果对 SDS 字符串修改后，len 值小于 1M，那么此时额外分配未使用空间 free 的大小与len相等。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果对 SDS 字符串修改后，len 值大于等于 1M，那么此时额外分配未使用空间 free 的大小为1M。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":3},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"惰性空间释放 优化SDS字符串缩短"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　惰性空间释放策略则用于优化SDS字符串缩短操作，当缩短SDS字符串后，并不会立即执行内存重分配来回收多余的空间，而是用free属性将这些空间记录下来，如果后续有增长操作，则可直接使用。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"数据格式多样性"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　C字符串中的字符必须符合某些特定的编码格式，C字符串以\\0空字符结尾标识一个字符串结束，所以字符串里边是不能包含\\0的，不然就会被误认是多个。\n由于这种限制，使得C字符串只能保存文本数据，像音视频、图片等二进制格式的数据是无法存储的。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　redis 会以处理二进制的方式操作Buf数组中的数据，所以对存入其中的数据做任何的限制、过滤，只要存进来什么样，取出来还是什么样。"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{"align":"center"},"children":[]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"C语言"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"SDS"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"字符串长度处理"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"需要从头开始遍历，直到遇到 '\\0' 为止，时间复杂度O(N)"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"记录当前字符串的长度，直接读取即可，时间复杂度 O(1)"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"内存重新分配"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"分配内存空间超过后，"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"会导致数组下标越级或者内存分配溢出"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"空间预分配 "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"SDS 修改后，len 长度小于 1M，那么将会额外分配与 len 相同长度的未使用空间。如果修改后长度大于 1M，那么将分配1M的使用空间。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"惰性空间释放有"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"空间分配对应的就有空间释放。SDS 缩短时并不会回收多余的内存空间，而是使用 free 字段将多出来的空间记录下来。如果后续有变更操作，直接使用 free 中记录的空间，减少了内存的分配。"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"二进制安全"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"二进制数据并不是规则的字符串格式，可能会包含一些特殊的字符，比如 '\\0' 等。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"前面提到过，C中字符串遇到 '\\0' 会结束，那 '\\0' 之后的数据就读取不上了"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"根据 len 长度来判断字符串结束的，二进制安全的问题就解决了"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"三大编码"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　Redis 内部会根据用户给的不同键值而使用不同的编码格式!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"int: 保存long型的64位有符号整数,范围 [ -2^63 , 2^63-1 ]"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"embstr: 保存长度小于44字节的字符串"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"raw: 保存长度大于44字节的字符串"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　以下是处理流程"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348310","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"1274.698486328125","style":"max-width: 814.0784912109375px;","viewBox":"0 0 814.0784912109375 1274.698486328125"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348310 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348310 .error-icon{fill:#552222;}#mermaid-1659928348310 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348310 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348310 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348310 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348310 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348310 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348310 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348310 .marker.cross{stroke:#333333;}#mermaid-1659928348310 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348310 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348310 .cluster-label text{fill:#333;}#mermaid-1659928348310 .cluster-label span{color:#333;}#mermaid-1659928348310 .label text,#mermaid-1659928348310 span{fill:#333;color:#333;}#mermaid-1659928348310 .node rect,#mermaid-1659928348310 .node circle,#mermaid-1659928348310 .node ellipse,#mermaid-1659928348310 .node polygon,#mermaid-1659928348310 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348310 .node .label{text-align:center;}#mermaid-1659928348310 .node.clickable{cursor:pointer;}#mermaid-1659928348310 .arrowheadPath{fill:#333333;}#mermaid-1659928348310 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348310 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348310 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348310 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348310 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348310 .cluster text{fill:#333;}#mermaid-1659928348310 .cluster span{color:#333;}#mermaid-1659928348310 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348310 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-开始","LE-B"],"id":"L-开始-B","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M318.521484375,50.5L318.521484375,54.666666666666664C318.521484375,58.833333333333336,318.521484375,67.16666666666667,318.521484375,75.5C318.521484375,83.83333333333333,318.521484375,92.16666666666667,318.521484375,96.33333333333333L318.521484375,100.5","markerEnd":"url(#arrowhead50)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead50","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-B","LE-结束"],"id":"L-B-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M206.72006623641306,143L174.93338853034422,149.04166666666666C143.14671082427537,155.08333333333334,79.57335541213769,167.16666666666666,47.78667770606884,205.6042963663737C16,244.04192606608072,16,308.83385213216144,16,373.6257781982422C16,438.41770426432294,16,503.2096303304036,16,568.650774637858C16,634.0919189453125,16,700.1822814941406,16,766.2726440429688C16,832.3630065917969,16,898.453369140625,16,950.115608215332C16,1001.7778472900391,16,1039.011962890625,16,1076.246078491211C16,1113.4801940917969,16,1150.7143096923828,80.86568959554036,1178.314579956955C145.73137919108072,1205.9148502215269,275.46275838216144,1223.8812751500852,340.32844797770184,1232.8644876143644L405.1941375732422,1241.8477000786436","markerEnd":"url(#arrowhead51)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead51","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-B","LE-C"],"id":"L-B-C","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M356.40581578793734,143L367.1768511896548,149.04166666666666C377.9478865913723,155.08333333333334,399.4899573948073,167.16666666666666,410.344326129858,179.33333384195964C421.1986948649089,191.50000101725266,421.3653615315755,203.75000203450531,421.4486948649089,209.87500254313161L421.5320281982422,216.00000305175794","markerEnd":"url(#arrowhead52)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead52","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-C","LE-D"],"id":"L-C-D","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M363.42341297500826,474.1429442250083L354.2032342622139,489.7860462535877C344.98305554941953,505.429148282167,326.54269812383086,536.7153523393257,317.40585274436984,558.4834553851576C308.2690073649089,580.2515584309896,308.4356740315755,592.5015604654949,308.5190073649089,598.6265614827474L308.6023406982422,604.7515625000001","markerEnd":"url(#arrowhead53)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead53","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-D","LE-E"],"id":"L-D-E","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M246.54331483706795,866.7347119317945L236.28785300143034,883.0362152247376C226.0323911657927,899.3377185176809,205.52146749451745,931.9407251035669,195.26600565887983,963.3176195301363C185.0105438232422,994.6945139567057,185.0105438232422,1024.8452962239583,185.0105438232422,1039.9206873575847L185.0105438232422,1054.996078491211","markerEnd":"url(#arrowhead54)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead54","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-D","LE-结束"],"id":"L-D-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M370.66137123508213,866.7347194631602L380.7501656247755,883.0362215008757C390.8389600144688,899.3377235385911,411.0165487938555,931.9407276140222,421.1053431835489,966.8592874520306C431.1941375732422,1001.7778472900391,431.1941375732422,1039.011962890625,431.1941375732422,1076.246078491211C431.1941375732422,1113.4801940917969,431.1941375732422,1150.7143096923828,431.1941375732422,1175.3730341593425C431.1941375732422,1200.031758626302,431.1941375732422,1212.1150919596355,431.1941375732422,1218.156758626302L431.1941375732422,1224.1984252929688","markerEnd":"url(#arrowhead55)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead55","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-C","LE-F"],"id":"L-C-F","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M508.0601964307761,445.7233973192242L532.7071295838335,466.1030904987676C557.3540627368911,486.4827836783109,606.6479290430061,527.2421700373976,631.2948621960636,580.6670444913551C655.9417953491211,634.0919189453125,655.9417953491211,700.1822814941406,655.9417953491211,766.2726440429688C655.9417953491211,832.3630065917969,655.9417953491211,898.453369140625,656.0251286824545,937.6235509236652C656.1084620157877,976.7937327067056,656.2751286824545,989.0437337239579,656.3584620157877,995.168734232584L656.4417953491211,1001.2937347412103","markerEnd":"url(#arrowhead56)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead56","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-F","LE-结束"],"id":"L-F-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M626.0837976185709,1121.840424510662L618.5269274486626,1132.8584246410464C610.9700572787543,1143.876424771431,595.8563169389377,1165.9124250322,567.7080402647163,1184.847631665777C539.5597635904948,1203.7828382993541,498.37695058186847,1219.6172513057395,477.78554407755536,1227.5344578089323L457.1941375732422,1235.4516643121249","markerEnd":"url(#arrowhead57)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead57","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-F","LE-结束"],"id":"L-F-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M686.7997906239412,1121.840420862874L694.1899945364712,1132.8584216012232C701.5801984490012,1143.8764223395722,716.3606062740611,1165.9124238162706,678.0929974322779,1185.6830552330275C639.8253885904948,1205.4536866497845,548.5097630818685,1222.9589480066,502.85195032755536,1231.711578685008L457.1941375732422,1240.4642093634156","markerEnd":"url(#arrowhead58)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead58","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-E","LE-结束"],"id":"L-E-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M185.0105438232422,1097.496078491211L185.0105438232422,1112.5714696248372C185.0105438232422,1127.6468607584636,185.0105438232422,1157.797643025716,221.7078094482422,1181.444250223319C258.4050750732422,1205.090857420922,331.7996063232422,1222.2332895488753,368.4968719482422,1230.804505612852L405.1941375732422,1239.3757216768286","markerEnd":"url(#arrowhead59)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead59","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-开始-B","className":["edgeLabel","L-LS-开始'","L-LE-B"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(16,766.2726440429688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-B-结束","className":["edgeLabel","L-LS-B'","L-LE-结束"]},"children":[{"type":"text","value":"否"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(421.0320281982422,179.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-B-C","className":["edgeLabel","L-LS-B'","L-LE-C"]},"children":[{"type":"text","value":"是"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(308.1023406982422,568.0015563964844)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-C-D","className":["edgeLabel","L-LS-C'","L-LE-D"]},"children":[{"type":"text","value":"是"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(185.0105438232422,964.5437316894531)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-D-E","className":["edgeLabel","L-LS-D'","L-LE-E"]},"children":[{"type":"text","value":"是"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(431.1941375732422,1076.246078491211)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-113.18359375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"226.3671875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"226.3671875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-D-结束","className":["edgeLabel","L-LS-D'","L-LE-结束"]},"children":[{"type":"text","value":"否,根据embstr和raw再分别处理"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(655.9417953491211,766.2726440429688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-C-F","className":["edgeLabel","L-LS-C'","L-LE-F"]},"children":[{"type":"text","value":"否"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(580.7425765991211,1187.9484252929688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-55.4609375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"110.921875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"110.921875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-F-结束","className":["edgeLabel","L-LS-F'","L-LE-结束"]},"children":[{"type":"text","value":"是,编码为emstr"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(731.1410140991211,1187.9484252929688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-74.9375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"149.875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"149.875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-F-结束","className":["edgeLabel","L-LS-F'","L-LE-结束"]},"children":[{"type":"text","value":"否,直接返回原始对象"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-E-结束","className":["edgeLabel","L-LS-E'","L-LE-结束"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-开始-20","transform":"translate(318.521484375,29.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-26","y":"-21.25","width":"52","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-16,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"32","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"开始"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-B-21","transform":"translate(318.521484375,121.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-115.18359375","y":"-21.25","width":"230.3671875","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-105.18359375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"210.3671875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"是不是embstr或者raw字符串?"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-结束-23","transform":"translate(431.1941375732422,1245.4484252929688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-26","y":"-21.25","width":"52","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-16,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"32","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"结束"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-C-25","transform":"translate(421.0320281982422,373.6257781982422)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"polygon","properties":{"points":"158.12578125000002,0 316.25156250000003,-158.12578125000002 158.12578125000002,-316.25156250000003 0,-158.12578125000002","transform":"translate(-158.12578125000002,158.12578125000002)","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-144.4453125,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"288.890625","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"字符串长度<20 并且可以 转换为long类型"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-D-27","transform":"translate(308.1023406982422,766.2726440429688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"polygon","properties":{"points":"162.02109375,0 324.0421875,-162.02109375 162.02109375,-324.0421875 0,-162.02109375","transform":"translate(-162.02109375,162.02109375)","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-148.7734375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"297.546875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"是否配置maxmemory切整数范围 0 ,10000"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-E-29","transform":"translate(185.0105438232422,1076.246078491211)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-98","y":"-21.25","width":"196","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-88,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"176","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"直接从共享数据里面拿到"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-F-33","transform":"translate(655.9417953491211,1076.246078491211)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"polygon","properties":{"points":"75.45234375,0 150.9046875,-75.45234375 75.45234375,-150.9046875 0,-75.45234375","transform":"translate(-75.45234375,75.45234375)","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-52.5859375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"105.171875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"字符串长度<44"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n"}]}],"data":{"quirksMode":false}},"html":"<p updated=\"20220808111208\">　　String的底层实现是SDS（Simple dynamic String）。</p>\n<h1 id=\"SDS-结构\">SDS 结构</h1>\n<pre class=\"code-block\" data-language=\"\"><code class=\"hljs\">struct __attribute__ ((__packed__)) sdshdr8 {\n    uint8_t len; /* 当前字符串数组的长度 */\n    uint8_t alloc; /* 当前字符串分配的总内存大小 */\n    unsigned char flags; /* 当前的字符串标记，用来标识是sdshdr8,sdshdr16等 */\n    char buf[]; /* 字符串真正的值 */\n};\n</code></pre>\n<h1 id=\"相对于C语言的优势\">相对于C语言的优势</h1>\n<h2 id=\"统计长度时间复杂度-O-1-\">统计长度时间复杂度 O(1)</h2>\n<p updated=\"20220808111208\">　　工作中使用redis，经常会通过STRLEN命令得到一个字符串的长度， 在SDS结构中len属性记录了字符串的长度，所以我们获取一个字符串长度直接取len的值，复杂度是O(1)。</p>\n<div data-content=\"graph LR;\n  'A'--&gt;'B'\n  'B'--&gt;'C'\n  'C'--&gt;'D'\n  'D'--&gt;'\\0'\n  '\\0'--&gt;'1'\n  '\\0'--&gt;|发现'\\0'不计数|'\\0'\n  '1'--&gt;'2'\n  '2'--&gt;2('\\0')\n  'A'--&gt;|len=1|'A'\n  'D' &lt;--&gt; |len=4|'A'\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220808111208\">　　而如果用C字符串，在获取一个字符串长度时，需对整个字符串进行遍历，直至遍历到空格符结束（C中遇到空格符代表一个完整字符串），此时的复杂度是O(N)。</p>\n<p updated=\"20220808111208\">　　在高并发场景下频繁遍历字符串，获取字符串的长度很有可能成为redis的性能瓶颈，所以SDS性能更好一些。数据溢出</p>\n<h2 id=\"数据溢出\">数据溢出</h2>\n<p updated=\"20220808111208\">　　由于C字符串是不记录自身长度的，相邻的两个字符串存储的方式可能如下图，在创建字符串的时候就分配了合适的内存空间。</p>\n<div data-content=\"graph LR;\n  'A'--&gt;'B'\n  'B'--&gt;'C'\n  'C'--&gt;'D'\n  'D'--&gt;'\\0'\n  '\\0'--&gt;'1'\n  '1'--&gt;'2'\n  '2'--&gt;2('\\0')\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220808111208\">　　如果这个时候，想修改字符串 ABCD 成 ABCDE ，就会侵占相邻字符串的空间，自身数据溢出导致其他字符串的内容被修改。</p>\n<div data-content=\"graph LR;\n  'A'--&gt;'B'\n  'B'--&gt;'C'\n  'C'--&gt;'D'\n  'D'--&gt;'E'\n  'E'--&gt;'\\0'\n  '\\0'--&gt;'2'\n  '2'--&gt;2('\\0')\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220808111208\">　　而SDS很好的规避了这点，当我们需要修改数据时，首先会检查当前SDS空间len是否满足，不满足则自动扩容空间至修改所需的大小，然后再执行修改。</p>\n<h2 id=\"内存重分配策略\">内存重分配策略</h2>\n<p updated=\"20220808111208\">　　C字符串的长度是一定的，所以每次在增长或者是缩短字符串的时候，都需要做内存的重新分配，而内存重新分配又是一个<br />\n比较耗时的操作。</p>\n<p updated=\"20220808111208\">　　SDS通过两种内存重分配策略，在解决字符串增长和缩短时兼顾效率和性能</p>\n<ol updated=\"20220808111208\">\n<li id=\"20220808111208-ushr6ce\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">空间预分配 优化SDS字符串增长</p>\n<p updated=\"20220808111208\">当修改字符串并需要对SDS空间进行扩展式，不仅会分配修改所必要的空间，还会为SDS分配额外的未使用空间，<br />\n下次修改先检查未使用空间是否满足，满足则不用再扩展空间。</p>\n</li>\n</ol>\n<ul updated=\"20220808111208\">\n<li id=\"20220808111208-avvuhva\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">如果对 SDS 字符串修改后，len 值小于 1M，那么此时额外分配未使用空间 free 的大小与len相等。</p>\n</li>\n<li id=\"20220808111208-hh9muyl\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">如果对 SDS 字符串修改后，len 值大于等于 1M，那么此时额外分配未使用空间 free 的大小为1M。</p>\n</li>\n</ul>\n<ol start=\"3\" updated=\"20220808111208\">\n<li id=\"20220808111208-3nf56pl\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">惰性空间释放 优化SDS字符串缩短</p>\n</li>\n</ol>\n<p updated=\"20220808111208\">　　惰性空间释放策略则用于优化SDS字符串缩短操作，当缩短SDS字符串后，并不会立即执行内存重分配来回收多余的空间，而是用free属性将这些空间记录下来，如果后续有增长操作，则可直接使用。</p>\n<h2 id=\"数据格式多样性\">数据格式多样性</h2>\n<p updated=\"20220808111208\">　　C字符串中的字符必须符合某些特定的编码格式，C字符串以\\0空字符结尾标识一个字符串结束，所以字符串里边是不能包含\\0的，不然就会被误认是多个。<br />\n由于这种限制，使得C字符串只能保存文本数据，像音视频、图片等二进制格式的数据是无法存储的。</p>\n<p updated=\"20220808111208\">　　redis 会以处理二进制的方式操作Buf数组中的数据，所以对存入其中的数据做任何的限制、过滤，只要存进来什么样，取出来还是什么样。</p>\n<table updated=\"20220808111208\">\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th>C语言</th>\n<th>SDS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">字符串长度处理</td>\n<td>需要从头开始遍历，直到遇到 '\\0' 为止，时间复杂度O(N)</td>\n<td>记录当前字符串的长度，直接读取即可，时间复杂度 O(1)</td>\n</tr>\n<tr>\n<td align=\"center\">内存重新分配</td>\n<td>分配内存空间超过后，<br />会导致数组下标越级或者内存分配溢出</td>\n<td>空间预分配 &lt;br&gt;SDS 修改后，len 长度小于 1M，那么将会额外分配与 len 相同长度的未使用空间。如果修改后长度大于 1M，那么将分配1M的使用空间。&lt;br&gt;惰性空间释放有&lt;br&gt;空间分配对应的就有空间释放。SDS 缩短时并不会回收多余的内存空间，而是使用 free 字段将多出来的空间记录下来。如果后续有变更操作，直接使用 free 中记录的空间，减少了内存的分配。</td>\n</tr>\n<tr>\n<td align=\"center\">二进制安全</td>\n<td>二进制数据并不是规则的字符串格式，可能会包含一些特殊的字符，比如 '\\0' 等。<br />前面提到过，C中字符串遇到 '\\0' 会结束，那 '\\0' 之后的数据就读取不上了</td>\n<td>根据 len 长度来判断字符串结束的，二进制安全的问题就解决了</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"三大编码\">三大编码</h1>\n<p updated=\"20220808111208\">　　Redis 内部会根据用户给的不同键值而使用不同的编码格式!</p>\n<ul updated=\"20220808111208\">\n<li id=\"20220808111208-zs7jw6y\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">int: 保存long型的64位有符号整数,范围 [ -2<sup>63 , 2</sup>63-1 ]</p>\n</li>\n<li id=\"20220808111208-16ttt7a\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">embstr: 保存长度小于44字节的字符串</p>\n</li>\n<li id=\"20220808111208-fwkkj7w\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">raw: 保存长度大于44字节的字符串</p>\n</li>\n</ul>\n<p updated=\"20220808111208\">　　以下是处理流程</p>\n<div data-content=\"graph TD;\n    开始--&gt;B(是不是embstr或者raw字符串?);\n    B--&gt;|否|结束;\n    B--&gt;|是|C{字符串长度&lt;20 并且可以 转换为long类型};\n    C--&gt;|是|D{是否配置maxmemory切整数范围 0 ,10000};\n    D--&gt;|是|E(直接从共享数据里面拿到);\n    D--&gt;|否,根据embstr和raw再分别处理|结束;\n    C--&gt;|否|F{字符串长度&lt;44}\n    F--&gt;|是,编码为emstr|结束\n    F--&gt;|否,直接返回原始对象|结束\n    E--&gt;结束\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n","articleNode":{"field":{"contentType":"topic","topic":"redis"},"frontmatter":{"id":"/topic/redis/Redis基本数据结构/String的底层实现","title":"String的底层实现","date":"2022-04-28 14:17","absolute_path":"/topic/redis/Redis基本数据结构/String的底层实现"},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"String的底层实现是SDS（Simple dynamic String）。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"SDS 结构"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","dark-default-dark"],"dataLanguage":"","dataIndex":"0"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"struct __attribute__ ((__packed__)) sdshdr8 {"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    uint8_t len; /* 当前字符串数组的长度 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    uint8_t alloc; /* 当前字符串分配的总内存大小 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    unsigned char flags; /* 当前的字符串标记，用来标识是sdshdr8,sdshdr16等 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"    char buf[]; /* 字符串真正的值 */"}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"text","value":"};"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"相对于C语言的优势"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"统计长度时间复杂度 O(1)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　工作中使用redis，经常会通过STRLEN命令得到一个字符串的长度， 在SDS结构中len属性记录了字符串的长度，所以我们获取一个字符串长度直接取len的值，复杂度是O(1)。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348311","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"139.125","style":"max-width: 753.078125px;","viewBox":"-2.2109375 0 753.078125 139.125"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348311 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348311 .error-icon{fill:#552222;}#mermaid-1659928348311 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348311 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348311 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348311 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348311 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348311 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348311 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348311 .marker.cross{stroke:#333333;}#mermaid-1659928348311 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348311 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348311 .cluster-label text{fill:#333;}#mermaid-1659928348311 .cluster-label span{color:#333;}#mermaid-1659928348311 .label text,#mermaid-1659928348311 span{fill:#333;color:#333;}#mermaid-1659928348311 .node rect,#mermaid-1659928348311 .node circle,#mermaid-1659928348311 .node ellipse,#mermaid-1659928348311 .node polygon,#mermaid-1659928348311 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348311 .node .label{text-align:center;}#mermaid-1659928348311 .node.clickable{cursor:pointer;}#mermaid-1659928348311 .arrowheadPath{fill:#333333;}#mermaid-1659928348311 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348311 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348311 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348311 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348311 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348311 .cluster text{fill:#333;}#mermaid-1659928348311 .cluster span{color:#333;}#mermaid-1659928348311 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348311 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'B'"],"id":"L-'A'-'B'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M42.546875,43.84226817702845L47.08203125,41.076890147523706C51.6171875,38.31151211801897,60.6875,32.780756059009484,69.38932291666667,30.015378029504742C78.09114583333333,27.25,86.42447916666667,27.25,90.59114583333333,27.25L94.7578125,27.25","markerEnd":"url(#arrowhead46)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead46","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'B'","LE-'C'"],"id":"L-'B'-'C'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M128.921875,27.25L136.3359375,27.25C143.75,27.25,158.578125,27.25,173.40625,27.25C188.234375,27.25,203.0625,27.25,210.4765625,27.25L217.890625,27.25","markerEnd":"url(#arrowhead47)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead47","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'C'","LE-'D'"],"id":"L-'C'-'D'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M252.5703125,27.25L256.7369791666667,27.25C260.9036458333333,27.25,269.2369791666667,27.25,277.5703125,29.911760196258815C285.9036458333333,32.57352039251763,294.2369791666667,37.897040785035266,298.4036458333333,40.55880098129408L302.5703125,43.220561177552895","markerEnd":"url(#arrowhead48)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead48","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'\\0'"],"id":"L-'D'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M337.4921875,54.375L341.6588541666667,54.375C345.8255208333333,54.375,354.1588541666667,54.375,367.4921875,54.375C380.8255208333333,54.375,399.1588541666667,54.375,408.3255208333333,54.375L417.4921875,54.375","markerEnd":"url(#arrowhead49)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead49","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'1'"],"id":"L-'\\0'-'1'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M456.6796875,54.375L465.8463541666667,54.375C475.0130208333333,54.375,493.3463541666667,54.375,506.6796875,54.375C520.0130208333334,54.375,528.3463541666666,54.375,532.5130208333334,54.375L536.6796875,54.375","markerEnd":"url(#arrowhead50)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead50","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'\\0'"],"id":"L-'\\0'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M429.55489548668885,73.625L427.544444155574,78.76388888888889C425.5339928244592,83.90277777777777,421.5130901622296,94.18055555555554,419.50263883111484,100.60416666666667C417.4921875,107.02777777777777,417.4921875,109.59722222222221,420.7578125,112.16666666666667C424.0234375,114.7361111111111,430.5546875,117.30555555555554,437.0859375,117.30555555555554C443.6171875,117.30555555555554,450.1484375,114.7361111111111,453.4140625,112.16666666666667C456.6796875,109.59722222222221,456.6796875,107.02777777777777,454.66923616888516,100.60416666666667C452.6587848377704,94.18055555555554,448.6378821755408,83.90277777777777,446.627430844426,78.76388888888889L444.61697951331115,73.625","markerEnd":"url(#arrowhead51)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead51","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'1'","LE-'2'"],"id":"L-'1'-'2'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M570.1796875,54.375L574.3463541666666,54.375C578.5130208333334,54.375,586.8463541666666,54.375,595.1796875,54.375C603.5130208333334,54.375,611.8463541666666,54.375,616.0130208333334,54.375L620.1796875,54.375","markerEnd":"url(#arrowhead52)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead52","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'2'","LE-2"],"id":"L-'2'-2","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M653.6796875,54.375L657.8463541666666,54.375C662.0130208333334,54.375,670.3463541666666,54.375,678.6796875,54.375C687.0130208333334,54.375,695.3463541666666,54.375,699.5130208333334,54.375L703.6796875,54.375","markerEnd":"url(#arrowhead53)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead53","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'A'"],"id":"L-'A'-'A'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M18.45264423076923,73.625L16.71053685897436,78.54166666666667C14.968429487179487,83.45833333333333,11.484214743589744,93.29166666666667,9.742107371794871,99.4375C8,105.58333333333333,8,108.04166666666667,10.87890625,110.5C13.7578125,112.95833333333333,19.515625,115.41666666666667,25.2734375,115.41666666666667C31.03125,115.41666666666667,36.7890625,112.95833333333333,39.66796875,110.5C42.546875,108.04166666666667,42.546875,105.58333333333333,40.80476762820513,99.4375C39.062660256410254,93.29166666666667,35.578445512820515,83.45833333333333,33.83633814102564,78.54166666666667L32.09423076923077,73.625","markerEnd":"url(#arrowhead54)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead54","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'A'"],"id":"L-'D'-'A'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M302.5703125,65.5294388224471L298.4036458333333,68.19119901870592C294.2369791666667,70.85295921496474,285.9036458333333,76.17647960748236,274.6803385416667,78.83823980374119C263.45703125,81.5,249.34375,81.5,231.98307291666666,81.5C214.62239583333334,81.5,194.01432291666666,81.5,173.44921875,81.5C152.88411458333334,81.5,132.36197916666666,81.5,115.08723958333333,81.5C97.8125,81.5,83.78515625,81.5,72.236328125,78.73462197049525C60.6875,75.96924394099052,51.6171875,70.43848788198103,47.08203125,67.67310985247629L42.546875,64.90773182297156","markerEnd":"url(#arrowhead55)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead55","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'B'","className":["edgeLabel","L-LS-'A''","L-LE-'B'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'B'-'C'","className":["edgeLabel","L-LS-'B''","L-LE-'C'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'C'-'D'","className":["edgeLabel","L-LS-'C''","L-LE-'D'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'\\0'","className":["edgeLabel","L-LS-'D''","L-LE-'\\0'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'1'","className":["edgeLabel","L-LS-'\\0''","L-LE-'1'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(437.0859375,119.875)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-49.59375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"99.1875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"99.1875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'\\0'","className":["edgeLabel","L-LS-'\\0''","L-LE-'\\0'"]},"children":[{"type":"text","value":"发现'\\0'不计数"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'1'-'2'","className":["edgeLabel","L-LS-'1''","L-LE-'2'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'2'-2","className":["edgeLabel","L-LS-'2''","L-LE-2"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(25.2734375,117.875)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-19.484375,-9.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"38.96875","height":"18.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"38.96875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'A'","className":["edgeLabel","L-LS-'A''","L-LE-'A'"]},"children":[{"type":"text","value":"len=1"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(173.40625,81.5)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-19.484375,-9.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"38.96875","height":"18.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"38.96875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'A'","className":["edgeLabel","L-LS-'D''","L-LE-'A'"]},"children":[{"type":"text","value":"len=4"}]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-2-35","transform":"translate(723.2734375,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'A'-20","transform":"translate(25.2734375,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.2734375","y":"-19.25","width":"34.546875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.2734375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.546875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'A'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'B'-21","transform":"translate(111.83984375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.08203125","y":"-19.25","width":"34.1640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.08203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.1640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'B'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'C'-23","transform":"translate(235.23046875,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.33984375","y":"-19.25","width":"34.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.33984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'C'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'D'-25","transform":"translate(320.03125,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.4609375","y":"-19.25","width":"34.921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.4609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'D'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'\\0'-27","transform":"translate(437.0859375,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'1'-29","transform":"translate(553.4296875,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'1'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'2'-33","transform":"translate(636.9296875,54.375)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'2'"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　而如果用C字符串，在获取一个字符串长度时，需对整个字符串进行遍历，直至遍历到空格符结束（C中遇到空格符代表一个完整字符串），此时的复杂度是O(N)。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　在高并发场景下频繁遍历字符串，获取字符串的长度很有可能成为redis的性能瓶颈，所以SDS性能更好一些。数据溢出"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"数据溢出"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　由于C字符串是不记录自身长度的，相邻的两个字符串存储的方式可能如下图，在创建字符串的时候就分配了合适的内存空间。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348310","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"54.5","style":"max-width: 649.6875px;","viewBox":"0 0 649.6875 54.5"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348310 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348310 .error-icon{fill:#552222;}#mermaid-1659928348310 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348310 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348310 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348310 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348310 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348310 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348310 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348310 .marker.cross{stroke:#333333;}#mermaid-1659928348310 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348310 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348310 .cluster-label text{fill:#333;}#mermaid-1659928348310 .cluster-label span{color:#333;}#mermaid-1659928348310 .label text,#mermaid-1659928348310 span{fill:#333;color:#333;}#mermaid-1659928348310 .node rect,#mermaid-1659928348310 .node circle,#mermaid-1659928348310 .node ellipse,#mermaid-1659928348310 .node polygon,#mermaid-1659928348310 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348310 .node .label{text-align:center;}#mermaid-1659928348310 .node.clickable{cursor:pointer;}#mermaid-1659928348310 .arrowheadPath{fill:#333333;}#mermaid-1659928348310 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348310 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348310 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348310 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348310 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348310 .cluster text{fill:#333;}#mermaid-1659928348310 .cluster span{color:#333;}#mermaid-1659928348310 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348310 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'B'"],"id":"L-'A'-'B'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M42.546875,27.25L46.713541666666664,27.25C50.880208333333336,27.25,59.213541666666664,27.25,67.546875,27.25C75.88020833333333,27.25,84.21354166666667,27.25,88.38020833333333,27.25L92.546875,27.25","markerEnd":"url(#arrowhead37)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead37","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'B'","LE-'C'"],"id":"L-'B'-'C'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M126.7109375,27.25L130.87760416666666,27.25C135.04427083333334,27.25,143.37760416666666,27.25,151.7109375,27.25C160.04427083333334,27.25,168.37760416666666,27.25,172.54427083333334,27.25L176.7109375,27.25","markerEnd":"url(#arrowhead38)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead38","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'C'","LE-'D'"],"id":"L-'C'-'D'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M211.390625,27.25L215.55729166666666,27.25C219.72395833333334,27.25,228.05729166666666,27.25,236.390625,27.25C244.72395833333334,27.25,253.05729166666666,27.25,257.2239583333333,27.25L261.390625,27.25","markerEnd":"url(#arrowhead39)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead39","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'\\0'"],"id":"L-'D'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M296.3125,27.25L300.4791666666667,27.25C304.6458333333333,27.25,312.9791666666667,27.25,321.3125,27.25C329.6458333333333,27.25,337.9791666666667,27.25,342.1458333333333,27.25L346.3125,27.25","markerEnd":"url(#arrowhead40)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead40","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'1'"],"id":"L-'\\0'-'1'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M385.5,27.25L389.6666666666667,27.25C393.8333333333333,27.25,402.1666666666667,27.25,410.5,27.25C418.8333333333333,27.25,427.1666666666667,27.25,431.3333333333333,27.25L435.5,27.25","markerEnd":"url(#arrowhead41)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead41","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'1'","LE-'2'"],"id":"L-'1'-'2'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M469,27.25L473.1666666666667,27.25C477.3333333333333,27.25,485.6666666666667,27.25,494,27.25C502.3333333333333,27.25,510.6666666666667,27.25,514.8333333333334,27.25L519,27.25","markerEnd":"url(#arrowhead42)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead42","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'2'","LE-2"],"id":"L-'2'-2","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M552.5,27.25L556.6666666666666,27.25C560.8333333333334,27.25,569.1666666666666,27.25,577.5,27.25C585.8333333333334,27.25,594.1666666666666,27.25,598.3333333333334,27.25L602.5,27.25","markerEnd":"url(#arrowhead43)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead43","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'B'","className":["edgeLabel","L-LS-'A''","L-LE-'B'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'B'-'C'","className":["edgeLabel","L-LS-'B''","L-LE-'C'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'C'-'D'","className":["edgeLabel","L-LS-'C''","L-LE-'D'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'\\0'","className":["edgeLabel","L-LS-'D''","L-LE-'\\0'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'1'","className":["edgeLabel","L-LS-'\\0''","L-LE-'1'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'1'-'2'","className":["edgeLabel","L-LS-'1''","L-LE-'2'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'2'-2","className":["edgeLabel","L-LS-'2''","L-LE-2"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-2-27","transform":"translate(622.09375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'A'-14","transform":"translate(25.2734375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.2734375","y":"-19.25","width":"34.546875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.2734375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.546875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'A'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'B'-15","transform":"translate(109.62890625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.08203125","y":"-19.25","width":"34.1640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.08203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.1640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'B'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'C'-17","transform":"translate(194.05078125,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.33984375","y":"-19.25","width":"34.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.33984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'C'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'D'-19","transform":"translate(278.8515625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.4609375","y":"-19.25","width":"34.921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.4609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'D'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'\\0'-21","transform":"translate(365.90625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'1'-23","transform":"translate(452.25,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'1'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'2'-25","transform":"translate(535.75,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'2'"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　如果这个时候，想修改字符串 ABCD 成 ABCDE ，就会侵占相邻字符串的空间，自身数据溢出导致其他字符串的内容被修改。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348310","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"54.5","style":"max-width: 649.8671875px;","viewBox":"0 0 649.8671875 54.5"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348310 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348310 .error-icon{fill:#552222;}#mermaid-1659928348310 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348310 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348310 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348310 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348310 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348310 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348310 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348310 .marker.cross{stroke:#333333;}#mermaid-1659928348310 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348310 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348310 .cluster-label text{fill:#333;}#mermaid-1659928348310 .cluster-label span{color:#333;}#mermaid-1659928348310 .label text,#mermaid-1659928348310 span{fill:#333;color:#333;}#mermaid-1659928348310 .node rect,#mermaid-1659928348310 .node circle,#mermaid-1659928348310 .node ellipse,#mermaid-1659928348310 .node polygon,#mermaid-1659928348310 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348310 .node .label{text-align:center;}#mermaid-1659928348310 .node.clickable{cursor:pointer;}#mermaid-1659928348310 .arrowheadPath{fill:#333333;}#mermaid-1659928348310 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348310 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348310 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348310 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348310 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348310 .cluster text{fill:#333;}#mermaid-1659928348310 .cluster span{color:#333;}#mermaid-1659928348310 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348310 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'A'","LE-'B'"],"id":"L-'A'-'B'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M42.546875,27.25L46.713541666666664,27.25C50.880208333333336,27.25,59.213541666666664,27.25,67.546875,27.25C75.88020833333333,27.25,84.21354166666667,27.25,88.38020833333333,27.25L92.546875,27.25","markerEnd":"url(#arrowhead37)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead37","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'B'","LE-'C'"],"id":"L-'B'-'C'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M126.7109375,27.25L130.87760416666666,27.25C135.04427083333334,27.25,143.37760416666666,27.25,151.7109375,27.25C160.04427083333334,27.25,168.37760416666666,27.25,172.54427083333334,27.25L176.7109375,27.25","markerEnd":"url(#arrowhead38)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead38","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'C'","LE-'D'"],"id":"L-'C'-'D'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M211.390625,27.25L215.55729166666666,27.25C219.72395833333334,27.25,228.05729166666666,27.25,236.390625,27.25C244.72395833333334,27.25,253.05729166666666,27.25,257.2239583333333,27.25L261.390625,27.25","markerEnd":"url(#arrowhead39)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead39","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'D'","LE-'E'"],"id":"L-'D'-'E'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M296.3125,27.25L300.4791666666667,27.25C304.6458333333333,27.25,312.9791666666667,27.25,321.3125,27.25C329.6458333333333,27.25,337.9791666666667,27.25,342.1458333333333,27.25L346.3125,27.25","markerEnd":"url(#arrowhead40)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead40","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'E'","LE-'\\0'"],"id":"L-'E'-'\\0'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M379.9921875,27.25L384.1588541666667,27.25C388.3255208333333,27.25,396.6588541666667,27.25,404.9921875,27.25C413.3255208333333,27.25,421.6588541666667,27.25,425.8255208333333,27.25L429.9921875,27.25","markerEnd":"url(#arrowhead41)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead41","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'\\0'","LE-'2'"],"id":"L-'\\0'-'2'","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M469.1796875,27.25L473.3463541666667,27.25C477.5130208333333,27.25,485.8463541666667,27.25,494.1796875,27.25C502.5130208333333,27.25,510.8463541666667,27.25,515.0130208333334,27.25L519.1796875,27.25","markerEnd":"url(#arrowhead42)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead42","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-'2'","LE-2"],"id":"L-'2'-2","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M552.6796875,27.25L556.8463541666666,27.25C561.0130208333334,27.25,569.3463541666666,27.25,577.6796875,27.25C586.0130208333334,27.25,594.3463541666666,27.25,598.5130208333334,27.25L602.6796875,27.25","markerEnd":"url(#arrowhead43)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead43","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'A'-'B'","className":["edgeLabel","L-LS-'A''","L-LE-'B'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'B'-'C'","className":["edgeLabel","L-LS-'B''","L-LE-'C'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'C'-'D'","className":["edgeLabel","L-LS-'C''","L-LE-'D'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'D'-'E'","className":["edgeLabel","L-LS-'D''","L-LE-'E'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'E'-'\\0'","className":["edgeLabel","L-LS-'E''","L-LE-'\\0'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'\\0'-'2'","className":["edgeLabel","L-LS-'\\0''","L-LE-'2'"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-'2'-2","className":["edgeLabel","L-LS-'2''","L-LE-2"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-2-27","transform":"translate(622.2734375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'A'-14","transform":"translate(25.2734375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.2734375","y":"-19.25","width":"34.546875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.2734375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.546875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'A'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'B'-15","transform":"translate(109.62890625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.08203125","y":"-19.25","width":"34.1640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.08203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.1640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'B'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'C'-17","transform":"translate(194.05078125,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.33984375","y":"-19.25","width":"34.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.33984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'C'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'D'-19","transform":"translate(278.8515625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-17.4609375","y":"-19.25","width":"34.921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-7.4609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"14.921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'D'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'E'-21","transform":"translate(363.15234375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.83984375","y":"-19.25","width":"33.6796875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.83984375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.6796875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'E'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'\\0'-23","transform":"translate(449.5859375,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-19.59375","y":"-19.25","width":"39.1875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-9.59375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"19.1875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'\\0'"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-'2'-25","transform":"translate(535.9296875,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-16.75","y":"-19.25","width":"33.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-6.75,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"13.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"'2'"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　而SDS很好的规避了这点，当我们需要修改数据时，首先会检查当前SDS空间len是否满足，不满足则自动扩容空间至修改所需的大小，然后再执行修改。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"内存重分配策略"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　C字符串的长度是一定的，所以每次在增长或者是缩短字符串的时候，都需要做内存的重新分配，而内存重新分配又是一个\n比较耗时的操作。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　SDS通过两种内存重分配策略，在解决字符串增长和缩短时兼顾效率和性能"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"空间预分配 优化SDS字符串增长"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"当修改字符串并需要对SDS空间进行扩展式，不仅会分配修改所必要的空间，还会为SDS分配额外的未使用空间，\n下次修改先检查未使用空间是否满足，满足则不用再扩展空间。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果对 SDS 字符串修改后，len 值小于 1M，那么此时额外分配未使用空间 free 的大小与len相等。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果对 SDS 字符串修改后，len 值大于等于 1M，那么此时额外分配未使用空间 free 的大小为1M。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{"start":3},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"惰性空间释放 优化SDS字符串缩短"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　惰性空间释放策略则用于优化SDS字符串缩短操作，当缩短SDS字符串后，并不会立即执行内存重分配来回收多余的空间，而是用free属性将这些空间记录下来，如果后续有增长操作，则可直接使用。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"数据格式多样性"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　C字符串中的字符必须符合某些特定的编码格式，C字符串以\\0空字符结尾标识一个字符串结束，所以字符串里边是不能包含\\0的，不然就会被误认是多个。\n由于这种限制，使得C字符串只能保存文本数据，像音视频、图片等二进制格式的数据是无法存储的。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　redis 会以处理二进制的方式操作Buf数组中的数据，所以对存入其中的数据做任何的限制、过滤，只要存进来什么样，取出来还是什么样。"}]},{"type":"text","value":"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"},{"type":"element","tagName":"table","properties":{},"children":[{"type":"element","tagName":"thead","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"th","properties":{"align":"center"},"children":[]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"C语言"}]},{"type":"element","tagName":"th","properties":{},"children":[{"type":"text","value":"SDS"}]}]}]},{"type":"element","tagName":"tbody","properties":{},"children":[{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"字符串长度处理"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"需要从头开始遍历，直到遇到 '\\0' 为止，时间复杂度O(N)"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"记录当前字符串的长度，直接读取即可，时间复杂度 O(1)"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"内存重新分配"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"分配内存空间超过后，"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"会导致数组下标越级或者内存分配溢出"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"空间预分配 "},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"SDS 修改后，len 长度小于 1M，那么将会额外分配与 len 相同长度的未使用空间。如果修改后长度大于 1M，那么将分配1M的使用空间。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"惰性空间释放有"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"空间分配对应的就有空间释放。SDS 缩短时并不会回收多余的内存空间，而是使用 free 字段将多出来的空间记录下来。如果后续有变更操作，直接使用 free 中记录的空间，减少了内存的分配。"}]}]},{"type":"element","tagName":"tr","properties":{},"children":[{"type":"element","tagName":"td","properties":{"align":"center"},"children":[{"type":"text","value":"二进制安全"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"二进制数据并不是规则的字符串格式，可能会包含一些特殊的字符，比如 '\\0' 等。"},{"type":"element","tagName":"br","properties":{},"children":[]},{"type":"text","value":"前面提到过，C中字符串遇到 '\\0' 会结束，那 '\\0' 之后的数据就读取不上了"}]},{"type":"element","tagName":"td","properties":{},"children":[{"type":"text","value":"根据 len 长度来判断字符串结束的，二进制安全的问题就解决了"}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"三大编码"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　Redis 内部会根据用户给的不同键值而使用不同的编码格式!"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"int: 保存long型的64位有符号整数,范围 [ -2^63 , 2^63-1 ]"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"embstr: 保存长度小于44字节的字符串"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"raw: 保存长度大于44字节的字符串"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　以下是处理流程"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659928348310","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"1274.698486328125","style":"max-width: 814.0784912109375px;","viewBox":"0 0 814.0784912109375 1274.698486328125"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659928348310 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659928348310 .error-icon{fill:#552222;}#mermaid-1659928348310 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659928348310 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659928348310 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659928348310 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659928348310 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659928348310 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659928348310 .marker{fill:#333333;stroke:#333333;}#mermaid-1659928348310 .marker.cross{stroke:#333333;}#mermaid-1659928348310 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659928348310 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659928348310 .cluster-label text{fill:#333;}#mermaid-1659928348310 .cluster-label span{color:#333;}#mermaid-1659928348310 .label text,#mermaid-1659928348310 span{fill:#333;color:#333;}#mermaid-1659928348310 .node rect,#mermaid-1659928348310 .node circle,#mermaid-1659928348310 .node ellipse,#mermaid-1659928348310 .node polygon,#mermaid-1659928348310 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659928348310 .node .label{text-align:center;}#mermaid-1659928348310 .node.clickable{cursor:pointer;}#mermaid-1659928348310 .arrowheadPath{fill:#333333;}#mermaid-1659928348310 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659928348310 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659928348310 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659928348310 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659928348310 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659928348310 .cluster text{fill:#333;}#mermaid-1659928348310 .cluster span{color:#333;}#mermaid-1659928348310 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659928348310 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-开始","LE-B"],"id":"L-开始-B","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M318.521484375,50.5L318.521484375,54.666666666666664C318.521484375,58.833333333333336,318.521484375,67.16666666666667,318.521484375,75.5C318.521484375,83.83333333333333,318.521484375,92.16666666666667,318.521484375,96.33333333333333L318.521484375,100.5","markerEnd":"url(#arrowhead50)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead50","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-B","LE-结束"],"id":"L-B-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M206.72006623641306,143L174.93338853034422,149.04166666666666C143.14671082427537,155.08333333333334,79.57335541213769,167.16666666666666,47.78667770606884,205.6042963663737C16,244.04192606608072,16,308.83385213216144,16,373.6257781982422C16,438.41770426432294,16,503.2096303304036,16,568.650774637858C16,634.0919189453125,16,700.1822814941406,16,766.2726440429688C16,832.3630065917969,16,898.453369140625,16,950.115608215332C16,1001.7778472900391,16,1039.011962890625,16,1076.246078491211C16,1113.4801940917969,16,1150.7143096923828,80.86568959554036,1178.314579956955C145.73137919108072,1205.9148502215269,275.46275838216144,1223.8812751500852,340.32844797770184,1232.8644876143644L405.1941375732422,1241.8477000786436","markerEnd":"url(#arrowhead51)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead51","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-B","LE-C"],"id":"L-B-C","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M356.40581578793734,143L367.1768511896548,149.04166666666666C377.9478865913723,155.08333333333334,399.4899573948073,167.16666666666666,410.344326129858,179.33333384195964C421.1986948649089,191.50000101725266,421.3653615315755,203.75000203450531,421.4486948649089,209.87500254313161L421.5320281982422,216.00000305175794","markerEnd":"url(#arrowhead52)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead52","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-C","LE-D"],"id":"L-C-D","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M363.42341297500826,474.1429442250083L354.2032342622139,489.7860462535877C344.98305554941953,505.429148282167,326.54269812383086,536.7153523393257,317.40585274436984,558.4834553851576C308.2690073649089,580.2515584309896,308.4356740315755,592.5015604654949,308.5190073649089,598.6265614827474L308.6023406982422,604.7515625000001","markerEnd":"url(#arrowhead53)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead53","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-D","LE-E"],"id":"L-D-E","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M246.54331483706795,866.7347119317945L236.28785300143034,883.0362152247376C226.0323911657927,899.3377185176809,205.52146749451745,931.9407251035669,195.26600565887983,963.3176195301363C185.0105438232422,994.6945139567057,185.0105438232422,1024.8452962239583,185.0105438232422,1039.9206873575847L185.0105438232422,1054.996078491211","markerEnd":"url(#arrowhead54)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead54","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-D","LE-结束"],"id":"L-D-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M370.66137123508213,866.7347194631602L380.7501656247755,883.0362215008757C390.8389600144688,899.3377235385911,411.0165487938555,931.9407276140222,421.1053431835489,966.8592874520306C431.1941375732422,1001.7778472900391,431.1941375732422,1039.011962890625,431.1941375732422,1076.246078491211C431.1941375732422,1113.4801940917969,431.1941375732422,1150.7143096923828,431.1941375732422,1175.3730341593425C431.1941375732422,1200.031758626302,431.1941375732422,1212.1150919596355,431.1941375732422,1218.156758626302L431.1941375732422,1224.1984252929688","markerEnd":"url(#arrowhead55)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead55","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-C","LE-F"],"id":"L-C-F","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M508.0601964307761,445.7233973192242L532.7071295838335,466.1030904987676C557.3540627368911,486.4827836783109,606.6479290430061,527.2421700373976,631.2948621960636,580.6670444913551C655.9417953491211,634.0919189453125,655.9417953491211,700.1822814941406,655.9417953491211,766.2726440429688C655.9417953491211,832.3630065917969,655.9417953491211,898.453369140625,656.0251286824545,937.6235509236652C656.1084620157877,976.7937327067056,656.2751286824545,989.0437337239579,656.3584620157877,995.168734232584L656.4417953491211,1001.2937347412103","markerEnd":"url(#arrowhead56)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead56","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-F","LE-结束"],"id":"L-F-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M626.0837976185709,1121.840424510662L618.5269274486626,1132.8584246410464C610.9700572787543,1143.876424771431,595.8563169389377,1165.9124250322,567.7080402647163,1184.847631665777C539.5597635904948,1203.7828382993541,498.37695058186847,1219.6172513057395,477.78554407755536,1227.5344578089323L457.1941375732422,1235.4516643121249","markerEnd":"url(#arrowhead57)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead57","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-F","LE-结束"],"id":"L-F-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M686.7997906239412,1121.840420862874L694.1899945364712,1132.8584216012232C701.5801984490012,1143.8764223395722,716.3606062740611,1165.9124238162706,678.0929974322779,1185.6830552330275C639.8253885904948,1205.4536866497845,548.5097630818685,1222.9589480066,502.85195032755536,1231.711578685008L457.1941375732422,1240.4642093634156","markerEnd":"url(#arrowhead58)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead58","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-E","LE-结束"],"id":"L-E-结束","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M185.0105438232422,1097.496078491211L185.0105438232422,1112.5714696248372C185.0105438232422,1127.6468607584636,185.0105438232422,1157.797643025716,221.7078094482422,1181.444250223319C258.4050750732422,1205.090857420922,331.7996063232422,1222.2332895488753,368.4968719482422,1230.804505612852L405.1941375732422,1239.3757216768286","markerEnd":"url(#arrowhead59)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead59","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-开始-B","className":["edgeLabel","L-LS-开始'","L-LE-B"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(16,766.2726440429688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-B-结束","className":["edgeLabel","L-LS-B'","L-LE-结束"]},"children":[{"type":"text","value":"否"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(421.0320281982422,179.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-B-C","className":["edgeLabel","L-LS-B'","L-LE-C"]},"children":[{"type":"text","value":"是"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(308.1023406982422,568.0015563964844)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-C-D","className":["edgeLabel","L-LS-C'","L-LE-D"]},"children":[{"type":"text","value":"是"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(185.0105438232422,964.5437316894531)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-D-E","className":["edgeLabel","L-LS-D'","L-LE-E"]},"children":[{"type":"text","value":"是"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(431.1941375732422,1076.246078491211)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-113.18359375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"226.3671875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"226.3671875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-D-结束","className":["edgeLabel","L-LS-D'","L-LE-结束"]},"children":[{"type":"text","value":"否,根据embstr和raw再分别处理"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(655.9417953491211,766.2726440429688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-8,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"16","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"16","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-C-F","className":["edgeLabel","L-LS-C'","L-LE-F"]},"children":[{"type":"text","value":"否"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(580.7425765991211,1187.9484252929688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-55.4609375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"110.921875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"110.921875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-F-结束","className":["edgeLabel","L-LS-F'","L-LE-结束"]},"children":[{"type":"text","value":"是,编码为emstr"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"translate(731.1410140991211,1187.9484252929688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-74.9375,-11.25)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"149.875","height":"22.5"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"149.875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-F-结束","className":["edgeLabel","L-LS-F'","L-LE-结束"]},"children":[{"type":"text","value":"否,直接返回原始对象"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-E-结束","className":["edgeLabel","L-LS-E'","L-LE-结束"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-开始-20","transform":"translate(318.521484375,29.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-26","y":"-21.25","width":"52","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-16,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"32","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"开始"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-B-21","transform":"translate(318.521484375,121.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-115.18359375","y":"-21.25","width":"230.3671875","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-105.18359375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"210.3671875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"是不是embstr或者raw字符串?"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-结束-23","transform":"translate(431.1941375732422,1245.4484252929688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-26","y":"-21.25","width":"52","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-16,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"32","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"结束"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-C-25","transform":"translate(421.0320281982422,373.6257781982422)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"polygon","properties":{"points":"158.12578125000002,0 316.25156250000003,-158.12578125000002 158.12578125000002,-316.25156250000003 0,-158.12578125000002","transform":"translate(-158.12578125000002,158.12578125000002)","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-144.4453125,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"288.890625","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"字符串长度<20 并且可以 转换为long类型"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-D-27","transform":"translate(308.1023406982422,766.2726440429688)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"polygon","properties":{"points":"162.02109375,0 324.0421875,-162.02109375 162.02109375,-324.0421875 0,-162.02109375","transform":"translate(-162.02109375,162.02109375)","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-148.7734375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"297.546875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"是否配置maxmemory切整数范围 0 ,10000"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-E-29","transform":"translate(185.0105438232422,1076.246078491211)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"5","ry":"5","x":"-98","y":"-21.25","width":"196","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-88,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"176","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"直接从共享数据里面拿到"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-F-33","transform":"translate(655.9417953491211,1076.246078491211)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"polygon","properties":{"points":"75.45234375,0 150.9046875,-75.45234375 75.45234375,-150.9046875 0,-75.45234375","transform":"translate(-75.45234375,75.45234375)","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-52.5859375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"105.171875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"字符串长度<44"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n"}]}],"data":{"quirksMode":false}},"html":"<p updated=\"20220808111208\">　　String的底层实现是SDS（Simple dynamic String）。</p>\n<h1 id=\"SDS-结构\">SDS 结构</h1>\n<pre class=\"code-block\" data-language=\"\"><code class=\"hljs\">struct __attribute__ ((__packed__)) sdshdr8 {\n    uint8_t len; /* 当前字符串数组的长度 */\n    uint8_t alloc; /* 当前字符串分配的总内存大小 */\n    unsigned char flags; /* 当前的字符串标记，用来标识是sdshdr8,sdshdr16等 */\n    char buf[]; /* 字符串真正的值 */\n};\n</code></pre>\n<h1 id=\"相对于C语言的优势\">相对于C语言的优势</h1>\n<h2 id=\"统计长度时间复杂度-O-1-\">统计长度时间复杂度 O(1)</h2>\n<p updated=\"20220808111208\">　　工作中使用redis，经常会通过STRLEN命令得到一个字符串的长度， 在SDS结构中len属性记录了字符串的长度，所以我们获取一个字符串长度直接取len的值，复杂度是O(1)。</p>\n<div data-content=\"graph LR;\n  'A'--&gt;'B'\n  'B'--&gt;'C'\n  'C'--&gt;'D'\n  'D'--&gt;'\\0'\n  '\\0'--&gt;'1'\n  '\\0'--&gt;|发现'\\0'不计数|'\\0'\n  '1'--&gt;'2'\n  '2'--&gt;2('\\0')\n  'A'--&gt;|len=1|'A'\n  'D' &lt;--&gt; |len=4|'A'\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220808111208\">　　而如果用C字符串，在获取一个字符串长度时，需对整个字符串进行遍历，直至遍历到空格符结束（C中遇到空格符代表一个完整字符串），此时的复杂度是O(N)。</p>\n<p updated=\"20220808111208\">　　在高并发场景下频繁遍历字符串，获取字符串的长度很有可能成为redis的性能瓶颈，所以SDS性能更好一些。数据溢出</p>\n<h2 id=\"数据溢出\">数据溢出</h2>\n<p updated=\"20220808111208\">　　由于C字符串是不记录自身长度的，相邻的两个字符串存储的方式可能如下图，在创建字符串的时候就分配了合适的内存空间。</p>\n<div data-content=\"graph LR;\n  'A'--&gt;'B'\n  'B'--&gt;'C'\n  'C'--&gt;'D'\n  'D'--&gt;'\\0'\n  '\\0'--&gt;'1'\n  '1'--&gt;'2'\n  '2'--&gt;2('\\0')\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220808111208\">　　如果这个时候，想修改字符串 ABCD 成 ABCDE ，就会侵占相邻字符串的空间，自身数据溢出导致其他字符串的内容被修改。</p>\n<div data-content=\"graph LR;\n  'A'--&gt;'B'\n  'B'--&gt;'C'\n  'C'--&gt;'D'\n  'D'--&gt;'E'\n  'E'--&gt;'\\0'\n  '\\0'--&gt;'2'\n  '2'--&gt;2('\\0')\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220808111208\">　　而SDS很好的规避了这点，当我们需要修改数据时，首先会检查当前SDS空间len是否满足，不满足则自动扩容空间至修改所需的大小，然后再执行修改。</p>\n<h2 id=\"内存重分配策略\">内存重分配策略</h2>\n<p updated=\"20220808111208\">　　C字符串的长度是一定的，所以每次在增长或者是缩短字符串的时候，都需要做内存的重新分配，而内存重新分配又是一个<br />\n比较耗时的操作。</p>\n<p updated=\"20220808111208\">　　SDS通过两种内存重分配策略，在解决字符串增长和缩短时兼顾效率和性能</p>\n<ol updated=\"20220808111208\">\n<li id=\"20220808111208-ushr6ce\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">空间预分配 优化SDS字符串增长</p>\n<p updated=\"20220808111208\">当修改字符串并需要对SDS空间进行扩展式，不仅会分配修改所必要的空间，还会为SDS分配额外的未使用空间，<br />\n下次修改先检查未使用空间是否满足，满足则不用再扩展空间。</p>\n</li>\n</ol>\n<ul updated=\"20220808111208\">\n<li id=\"20220808111208-avvuhva\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">如果对 SDS 字符串修改后，len 值小于 1M，那么此时额外分配未使用空间 free 的大小与len相等。</p>\n</li>\n<li id=\"20220808111208-hh9muyl\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">如果对 SDS 字符串修改后，len 值大于等于 1M，那么此时额外分配未使用空间 free 的大小为1M。</p>\n</li>\n</ul>\n<ol start=\"3\" updated=\"20220808111208\">\n<li id=\"20220808111208-3nf56pl\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">惰性空间释放 优化SDS字符串缩短</p>\n</li>\n</ol>\n<p updated=\"20220808111208\">　　惰性空间释放策略则用于优化SDS字符串缩短操作，当缩短SDS字符串后，并不会立即执行内存重分配来回收多余的空间，而是用free属性将这些空间记录下来，如果后续有增长操作，则可直接使用。</p>\n<h2 id=\"数据格式多样性\">数据格式多样性</h2>\n<p updated=\"20220808111208\">　　C字符串中的字符必须符合某些特定的编码格式，C字符串以\\0空字符结尾标识一个字符串结束，所以字符串里边是不能包含\\0的，不然就会被误认是多个。<br />\n由于这种限制，使得C字符串只能保存文本数据，像音视频、图片等二进制格式的数据是无法存储的。</p>\n<p updated=\"20220808111208\">　　redis 会以处理二进制的方式操作Buf数组中的数据，所以对存入其中的数据做任何的限制、过滤，只要存进来什么样，取出来还是什么样。</p>\n<table updated=\"20220808111208\">\n<thead>\n<tr>\n<th align=\"center\"></th>\n<th>C语言</th>\n<th>SDS</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td align=\"center\">字符串长度处理</td>\n<td>需要从头开始遍历，直到遇到 '\\0' 为止，时间复杂度O(N)</td>\n<td>记录当前字符串的长度，直接读取即可，时间复杂度 O(1)</td>\n</tr>\n<tr>\n<td align=\"center\">内存重新分配</td>\n<td>分配内存空间超过后，<br />会导致数组下标越级或者内存分配溢出</td>\n<td>空间预分配 &lt;br&gt;SDS 修改后，len 长度小于 1M，那么将会额外分配与 len 相同长度的未使用空间。如果修改后长度大于 1M，那么将分配1M的使用空间。&lt;br&gt;惰性空间释放有&lt;br&gt;空间分配对应的就有空间释放。SDS 缩短时并不会回收多余的内存空间，而是使用 free 字段将多出来的空间记录下来。如果后续有变更操作，直接使用 free 中记录的空间，减少了内存的分配。</td>\n</tr>\n<tr>\n<td align=\"center\">二进制安全</td>\n<td>二进制数据并不是规则的字符串格式，可能会包含一些特殊的字符，比如 '\\0' 等。<br />前面提到过，C中字符串遇到 '\\0' 会结束，那 '\\0' 之后的数据就读取不上了</td>\n<td>根据 len 长度来判断字符串结束的，二进制安全的问题就解决了</td>\n</tr>\n</tbody>\n</table>\n<h1 id=\"三大编码\">三大编码</h1>\n<p updated=\"20220808111208\">　　Redis 内部会根据用户给的不同键值而使用不同的编码格式!</p>\n<ul updated=\"20220808111208\">\n<li id=\"20220808111208-zs7jw6y\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">int: 保存long型的64位有符号整数,范围 [ -2<sup>63 , 2</sup>63-1 ]</p>\n</li>\n<li id=\"20220808111208-16ttt7a\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">embstr: 保存长度小于44字节的字符串</p>\n</li>\n<li id=\"20220808111208-fwkkj7w\" updated=\"20220808111208\">\n<p updated=\"20220808111208\">raw: 保存长度大于44字节的字符串</p>\n</li>\n</ul>\n<p updated=\"20220808111208\">　　以下是处理流程</p>\n<div data-content=\"graph TD;\n    开始--&gt;B(是不是embstr或者raw字符串?);\n    B--&gt;|否|结束;\n    B--&gt;|是|C{字符串长度&lt;20 并且可以 转换为long类型};\n    C--&gt;|是|D{是否配置maxmemory切整数范围 0 ,10000};\n    D--&gt;|是|E(直接从共享数据里面拿到);\n    D--&gt;|否,根据embstr和raw再分别处理|结束;\n    C--&gt;|否|F{字符串长度&lt;44}\n    F--&gt;|是,编码为emstr|结束\n    F--&gt;|否,直接返回原始对象|结束\n    E--&gt;结束\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n","headings":[{"depth":1,"value":"SDS 结构"},{"depth":1,"value":"相对于C语言的优势"},{"depth":2,"value":"统计长度时间复杂度 O(1)"},{"depth":2,"value":"数据溢出"},{"depth":2,"value":"内存重分配策略"},{"depth":2,"value":"数据格式多样性"},{"depth":1,"value":"三大编码"}],"path":"/topic/redis/Redis基本数据结构/String的底层实现"},"tree":{"title":"redis","id":"20220428141727-a3p03i0","parentId":"","href":"/topic/redis","path":"/topic/redis","children":[{"title":"Redis为什么这么快","id":"20220428141727-jbyo2wp","type":"d","href":"/topic/redis/Redis为什么这么快","parentId":"","path":"/topic/redis/Redis为什么这么快","parentPath":"/topic/redis","sort":1,"children":[{"title":"完全基于内存","id":"20220428141727-m8thckv","type":"h","href":"/topic/redis/Redis为什么这么快#完全基于内存","parentId":"20220428141727-jbyo2wp","path":"/topic/redis/Redis为什么这么快","parentPath":"/topic/redis","children":[],"level":2},{"title":"数据结构简单","id":"20220428141727-0532nq9","type":"h","href":"/topic/redis/Redis为什么这么快#数据结构简单","parentId":"20220428141727-jbyo2wp","path":"/topic/redis/Redis为什么这么快","parentPath":"/topic/redis","children":[],"level":2},{"title":"工作线程采用单线程，避免了线程上下文切换所带来的损耗","id":"20220428141727-kw7bg9v","type":"h","href":"/topic/redis/Redis为什么这么快#工作线程采用单线程，避免了线程上下文切换所带来的损耗","parentId":"20220428141727-jbyo2wp","path":"/topic/redis/Redis为什么这么快","parentPath":"/topic/redis","children":[],"level":2},{"title":"对于客户端的连接采用多路复用和非阻塞I/O","id":"20220428141727-m7ruuk1","type":"h","href":"/topic/redis/Redis为什么这么快#对于客户端的连接采用多路复用和非阻塞I/O","parentId":"20220428141727-jbyo2wp","path":"/topic/redis/Redis为什么这么快","parentPath":"/topic/redis","children":[],"level":2},{"title":"redis单线程的问题","id":"20220428141728-w6wf4kq","type":"d","href":"/topic/redis/Redis为什么这么快/redis单线程的问题","parentId":"","path":"/topic/redis/Redis为什么这么快/redis单线程的问题","parentPath":"/topic/redis/Redis为什么这么快","sort":11,"children":[],"level":2}],"level":1},{"title":"Redis基本数据结构","id":"20220428141727-imsmasu","type":"d","href":"/topic/redis/Redis基本数据结构","parentId":"","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","sort":2,"children":[{"title":"常用的","id":"20220428141727-1gclyg6","type":"h","href":"/topic/redis/Redis基本数据结构#常用的","parentId":"20220428141727-imsmasu","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[{"title":"string","id":"20220428141727-u2m7nzt","type":"h","href":"/topic/redis/Redis基本数据结构#string","parentId":"20220428141727-1gclyg6","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"hash","id":"20220428141727-po0l8p4","type":"h","href":"/topic/redis/Redis基本数据结构#hash","parentId":"20220428141727-1gclyg6","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"list","id":"20220428141727-nyjx5v1","type":"h","href":"/topic/redis/Redis基本数据结构#list","parentId":"20220428141727-1gclyg6","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"set","id":"20220428141727-ujl3jkq","type":"h","href":"/topic/redis/Redis基本数据结构#set","parentId":"20220428141727-1gclyg6","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"zset","id":"20220428141727-8lh8dqt","type":"h","href":"/topic/redis/Redis基本数据结构#zset","parentId":"20220428141727-1gclyg6","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"扩展结构","id":"20220428141727-9xu8ei1","type":"h","href":"/topic/redis/Redis基本数据结构#扩展结构","parentId":"20220428141727-imsmasu","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[{"title":"bitmap","id":"20220428141727-89gt7iy","type":"h","href":"/topic/redis/Redis基本数据结构#bitmap","parentId":"20220428141727-9xu8ei1","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"hyperloglog","id":"20220428141727-08upaib","type":"h","href":"/topic/redis/Redis基本数据结构#hyperloglog","parentId":"20220428141727-9xu8ei1","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"GEO","id":"20220428141727-6z03dvm","type":"h","href":"/topic/redis/Redis基本数据结构#GEO","parentId":"20220428141727-9xu8ei1","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"扩展功能","id":"20220428141727-x5n4s7y","type":"h","href":"/topic/redis/Redis基本数据结构#扩展功能","parentId":"20220428141727-imsmasu","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[{"title":"pub/sub","id":"20220428141727-zay76x9","type":"h","href":"/topic/redis/Redis基本数据结构#pub/sub","parentId":"20220428141727-x5n4s7y","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"pipeline","id":"20220428141727-m3750uw","type":"h","href":"/topic/redis/Redis基本数据结构#pipeline","parentId":"20220428141727-x5n4s7y","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"Lua 脚本","id":"20220428141727-6rc0qt7","type":"h","href":"/topic/redis/Redis基本数据结构#Lua 脚本","parentId":"20220428141727-x5n4s7y","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3},{"title":"事务","id":"20220428141727-8i9gpxn","type":"h","href":"/topic/redis/Redis基本数据结构#事务","parentId":"20220428141727-x5n4s7y","path":"/topic/redis/Redis基本数据结构","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"String的底层实现","id":"20220428141728-d2hmuxd","type":"d","href":"/topic/redis/Redis基本数据结构/String的底层实现","parentId":"","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","sort":1,"children":[{"title":"SDS 结构","id":"20220428141728-y2039os","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#SDS 结构","parentId":"20220428141728-d2hmuxd","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":3},{"title":"相对于C语言的优势","id":"20220428141728-8t63ohh","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#相对于C语言的优势","parentId":"20220428141728-d2hmuxd","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[{"title":"统计长度时间复杂度 O(1)","id":"20220428141728-xeqpgol","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#统计长度时间复杂度 O(1)","parentId":"20220428141728-8t63ohh","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":4},{"title":"数据溢出","id":"20220428141728-coew455","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#数据溢出","parentId":"20220428141728-8t63ohh","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":4},{"title":"内存重分配策略","id":"20220428141728-mbwnou1","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#内存重分配策略","parentId":"20220428141728-8t63ohh","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":4},{"title":"数据格式多样性","id":"20220428141728-5h2se0u","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#数据格式多样性","parentId":"20220428141728-8t63ohh","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":4}],"level":3},{"title":"三大编码","id":"20220428141728-t4votze","type":"h","href":"/topic/redis/Redis基本数据结构/String的底层实现#三大编码","parentId":"20220428141728-d2hmuxd","path":"/topic/redis/Redis基本数据结构/String的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":3}],"level":2},{"title":"List的底层实现","id":"20220428141727-skh553t","type":"d","href":"/topic/redis/Redis基本数据结构/List的底层实现","parentId":"","path":"/topic/redis/Redis基本数据结构/List的底层实现","parentPath":"/topic/redis/Redis基本数据结构","sort":2,"children":[],"level":2},{"title":"Hash的底层实现","id":"20220428141727-g51ewzt","type":"d","href":"/topic/redis/Redis基本数据结构/Hash的底层实现","parentId":"","path":"/topic/redis/Redis基本数据结构/Hash的底层实现","parentPath":"/topic/redis/Redis基本数据结构","sort":3,"children":[{"title":"ZipList编码的哈希对象","id":"20220428141727-fo8pixs","type":"h","href":"/topic/redis/Redis基本数据结构/Hash的底层实现#ZipList编码的哈希对象","parentId":"20220428141727-g51ewzt","path":"/topic/redis/Redis基本数据结构/Hash的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":3},{"title":"hashtable对象","id":"20220428141727-f7zok8f","type":"h","href":"/topic/redis/Redis基本数据结构/Hash的底层实现#hashtable对象","parentId":"20220428141727-g51ewzt","path":"/topic/redis/Redis基本数据结构/Hash的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":3}],"level":2},{"title":"Set的底层实现","id":"20220428141728-5c6e914","type":"d","href":"/topic/redis/Redis基本数据结构/Set的底层实现","parentId":"","path":"/topic/redis/Redis基本数据结构/Set的底层实现","parentPath":"/topic/redis/Redis基本数据结构","sort":4,"children":[],"level":2},{"title":"ZSet的底层实现","id":"20220428141728-58eined","type":"d","href":"/topic/redis/Redis基本数据结构/ZSet的底层实现","parentId":"","path":"/topic/redis/Redis基本数据结构/ZSet的底层实现","parentPath":"/topic/redis/Redis基本数据结构","sort":5,"children":[{"title":"跳表是什么?","id":"20220428141728-9by553n","type":"h","href":"/topic/redis/Redis基本数据结构/ZSet的底层实现#跳表是什么?","parentId":"20220428141728-58eined","path":"/topic/redis/Redis基本数据结构/ZSet的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[{"title":"优缺点","id":"20220428141728-rvbr2il","type":"h","href":"/topic/redis/Redis基本数据结构/ZSet的底层实现#优缺点","parentId":"20220428141728-9by553n","path":"/topic/redis/Redis基本数据结构/ZSet的底层实现","parentPath":"/topic/redis/Redis基本数据结构","children":[],"level":4}],"level":3}],"level":2}],"level":1},{"title":"Redis分布式缓存","id":"20220428141727-3x1i5zp","type":"d","href":"/topic/redis/Redis分布式缓存","parentId":"","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","sort":3,"children":[{"title":"双写一致性","id":"20220428141727-zahxna7","type":"h","href":"/topic/redis/Redis分布式缓存#双写一致性","parentId":"20220428141727-3x1i5zp","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":2},{"title":"缓存更新策略","id":"20220428141727-iqgn80l","type":"h","href":"/topic/redis/Redis分布式缓存#缓存更新策略","parentId":"20220428141727-3x1i5zp","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"最常见的策略","id":"20220428141727-45wxv7a","type":"h","href":"/topic/redis/Redis分布式缓存#最常见的策略","parentId":"20220428141727-iqgn80l","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"优点剖析","id":"20220428141727-tfanvhu","type":"h","href":"/topic/redis/Redis分布式缓存#优点剖析","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"1. “先淘汰缓存，再写数据库” 合理","id":"20220428141727-vzyp7bi","type":"h","href":"/topic/redis/Redis分布式缓存#1. “先淘汰缓存，再写数据库” 合理","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"2. 异步刷新，补缺补漏","id":"20220428141727-kbueoxr","type":"h","href":"/topic/redis/Redis分布式缓存#2. 异步刷新，补缺补漏","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"缺点剖析","id":"20220428141727-sd1lbh3","type":"h","href":"/topic/redis/Redis分布式缓存#缺点剖析","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"1. 容灾不足","id":"20220428141727-aff14q4","type":"h","href":"/topic/redis/Redis分布式缓存#1. 容灾不足","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"2. 并发问题","id":"20220428141727-7kjhtfn","type":"h","href":"/topic/redis/Redis分布式缓存#2. 并发问题","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"方案总结","id":"20220428141727-5w2loli","type":"h","href":"/topic/redis/Redis分布式缓存#方案总结","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"写流程：","id":"20220428141727-s959uv0","type":"h","href":"/topic/redis/Redis分布式缓存#写流程：","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"读流程：","id":"20220428141727-sceljri","type":"h","href":"/topic/redis/Redis分布式缓存#读流程：","parentId":"20220428141727-45wxv7a","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4}],"level":3},{"title":"方案分析","id":"20220428141727-7flpl0m","type":"h","href":"/topic/redis/Redis分布式缓存#方案分析","parentId":"20220428141727-iqgn80l","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"优点剖析","id":"20220428141727-1cqjx66","type":"h","href":"/topic/redis/Redis分布式缓存#优点剖析","parentId":"20220428141727-7flpl0m","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"1. 容灾","id":"20220428141727-w9bvsqf","type":"h","href":"/topic/redis/Redis分布式缓存#1. 容灾","parentId":"20220428141727-1cqjx66","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":5}],"level":4},{"title":"缺点剖析","id":"20220428141727-n1twxfd","type":"h","href":"/topic/redis/Redis分布式缓存#缺点剖析","parentId":"20220428141727-7flpl0m","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"1. 只适合简单业务，复杂业务容易发生并发问题","id":"20220428141727-t5kobxh","type":"h","href":"/topic/redis/Redis分布式缓存#1. 只适合简单业务，复杂业务容易发生并发问题","parentId":"20220428141727-n1twxfd","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"缺点1的改进","id":"20220428141727-bz5ta88","type":"h","href":"/topic/redis/Redis分布式缓存#缺点1的改进","parentId":"20220428141727-t5kobxh","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":6}],"level":5},{"title":"2. 依然是并发问题","id":"20220428141727-gysgmg1","type":"h","href":"/topic/redis/Redis分布式缓存#2. 依然是并发问题","parentId":"20220428141727-n1twxfd","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":5}],"level":4}],"level":3},{"title":"方案总结","id":"20220428141727-01sdgjy","type":"h","href":"/topic/redis/Redis分布式缓存#方案总结","parentId":"20220428141727-iqgn80l","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"写流程：","id":"20220428141727-eglmgkf","type":"h","href":"/topic/redis/Redis分布式缓存#写流程：","parentId":"20220428141727-01sdgjy","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4},{"title":"读流程：","id":"20220428141727-1vywbk4","type":"h","href":"/topic/redis/Redis分布式缓存#读流程：","parentId":"20220428141727-01sdgjy","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":4}],"level":3},{"title":"方案分析","id":"20220428141727-137lw2k","type":"h","href":"/topic/redis/Redis分布式缓存#方案分析","parentId":"20220428141727-iqgn80l","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"优点剖析","id":"20220428141727-p0zad1o","type":"h","href":"/topic/redis/Redis分布式缓存#优点剖析","parentId":"20220428141727-137lw2k","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"1. 容灾完善","id":"20220428141727-cawius6","type":"h","href":"/topic/redis/Redis分布式缓存#1. 容灾完善","parentId":"20220428141727-p0zad1o","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"写流程容灾分析","id":"20220428141727-2d2z7fz","type":"h","href":"/topic/redis/Redis分布式缓存#写流程容灾分析","parentId":"20220428141727-cawius6","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":6},{"title":"读流程容灾分析","id":"20220428141727-4hr5okn","type":"h","href":"/topic/redis/Redis分布式缓存#读流程容灾分析","parentId":"20220428141727-cawius6","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":6}],"level":5},{"title":"2. 无并发问题","id":"20220428141727-uvwj2ga","type":"h","href":"/topic/redis/Redis分布式缓存#2. 无并发问题","parentId":"20220428141727-p0zad1o","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":5}],"level":4},{"title":"缺点剖析","id":"20220428141727-fmiz5zl","type":"h","href":"/topic/redis/Redis分布式缓存#缺点剖析","parentId":"20220428141727-137lw2k","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[{"title":"1. 增加Cache_0强依赖","id":"20220428141727-hr6lxu9","type":"h","href":"/topic/redis/Redis分布式缓存#1. 增加Cache_0强依赖","parentId":"20220428141727-fmiz5zl","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":5},{"title":"2. 复杂度是比较高的","id":"20220428141727-vbiftey","type":"h","href":"/topic/redis/Redis分布式缓存#2. 复杂度是比较高的","parentId":"20220428141727-fmiz5zl","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":5}],"level":4}],"level":3},{"title":"方案总结","id":"20220428141727-0an20z6","type":"h","href":"/topic/redis/Redis分布式缓存#方案总结","parentId":"20220428141727-iqgn80l","path":"/topic/redis/Redis分布式缓存","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"缓存击穿","id":"20220428141728-p93afgy","type":"d","href":"/topic/redis/Redis分布式缓存/缓存击穿","parentId":"","path":"/topic/redis/Redis分布式缓存/缓存击穿","parentPath":"/topic/redis/Redis分布式缓存","sort":1,"children":[{"title":"解决方案","id":"20220428141728-27esyuz","type":"h","href":"/topic/redis/Redis分布式缓存/缓存击穿#解决方案","parentId":"20220428141728-p93afgy","path":"/topic/redis/Redis分布式缓存/缓存击穿","parentPath":"/topic/redis/Redis分布式缓存","children":[{"title":"不过期","id":"20220428141728-foxjedm","type":"h","href":"/topic/redis/Redis分布式缓存/缓存击穿#不过期","parentId":"20220428141728-27esyuz","path":"/topic/redis/Redis分布式缓存/缓存击穿","parentPath":"/topic/redis/Redis分布式缓存","children":[],"level":4},{"title":"互斥锁","id":"20220428141728-68zg08m","type":"h","href":"/topic/redis/Redis分布式缓存/缓存击穿#互斥锁","parentId":"20220428141728-27esyuz","path":"/topic/redis/Redis分布式缓存/缓存击穿","parentPath":"/topic/redis/Redis分布式缓存","children":[],"level":4}],"level":3}],"level":2},{"title":"缓存穿透","id":"20220428141728-64iljj5","type":"d","href":"/topic/redis/Redis分布式缓存/缓存穿透","parentId":"","path":"/topic/redis/Redis分布式缓存/缓存穿透","parentPath":"/topic/redis/Redis分布式缓存","sort":3,"children":[{"title":"接口校验","id":"20220428141728-wny00tb","type":"h","href":"/topic/redis/Redis分布式缓存/缓存穿透#接口校验","parentId":"20220428141728-64iljj5","path":"/topic/redis/Redis分布式缓存/缓存穿透","parentPath":"/topic/redis/Redis分布式缓存","children":[],"level":3},{"title":"空对象缓存或者缺省值","id":"20220428141728-6wjc642","type":"h","href":"/topic/redis/Redis分布式缓存/缓存穿透#空对象缓存或者缺省值","parentId":"20220428141728-64iljj5","path":"/topic/redis/Redis分布式缓存/缓存穿透","parentPath":"/topic/redis/Redis分布式缓存","children":[],"level":3},{"title":"布隆过滤器","id":"20220428141728-r9yad28","type":"h","href":"/topic/redis/Redis分布式缓存/缓存穿透#布隆过滤器","parentId":"20220428141728-64iljj5","path":"/topic/redis/Redis分布式缓存/缓存穿透","parentPath":"/topic/redis/Redis分布式缓存","children":[],"level":3}],"level":2},{"title":"缓存雪崩","id":"20220428141728-9ti4duq","type":"d","href":"/topic/redis/Redis分布式缓存/缓存雪崩","parentId":"","path":"/topic/redis/Redis分布式缓存/缓存雪崩","parentPath":"/topic/redis/Redis分布式缓存","sort":4,"children":[{"title":"解决方案","id":"20220428141728-zu9jxq3","type":"h","href":"/topic/redis/Redis分布式缓存/缓存雪崩#解决方案","parentId":"20220428141728-9ti4duq","path":"/topic/redis/Redis分布式缓存/缓存雪崩","parentPath":"/topic/redis/Redis分布式缓存","children":[{"title":"三步骤","id":"20220428141728-0vnf8gp","type":"h","href":"/topic/redis/Redis分布式缓存/缓存雪崩#三步骤","parentId":"20220428141728-zu9jxq3","path":"/topic/redis/Redis分布式缓存/缓存雪崩","parentPath":"/topic/redis/Redis分布式缓存","children":[],"level":4}],"level":3}],"level":2},{"title":"缓存预热","id":"20220428141728-fz10tn2","type":"d","href":"/topic/redis/Redis分布式缓存/缓存预热","parentId":"","path":"/topic/redis/Redis分布式缓存/缓存预热","parentPath":"/topic/redis/Redis分布式缓存","sort":7,"children":[],"level":2}],"level":1},{"title":"Redis的分布式锁","id":"20220428141727-sgydg0x","type":"d","href":"/topic/redis/Redis的分布式锁","parentId":"","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","sort":4,"children":[{"title":"利用redis实现分布式锁","id":"20220428141727-e4nwnv1","type":"h","href":"/topic/redis/Redis的分布式锁#利用redis实现分布式锁","parentId":"20220428141727-sgydg0x","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[{"title":"三个重要因素","id":"20220428141727-zthzzjq","type":"h","href":"/topic/redis/Redis的分布式锁#三个重要因素","parentId":"20220428141727-e4nwnv1","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[],"level":3},{"title":"涉及命令","id":"20220428141727-hs1yg88","type":"h","href":"/topic/redis/Redis的分布式锁#涉及命令","parentId":"20220428141727-e4nwnv1","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"实现思想","id":"20220428141727-5jo3h6s","type":"h","href":"/topic/redis/Redis的分布式锁#实现思想","parentId":"20220428141727-sgydg0x","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[{"title":"业务执行的时间大于redis锁过期的时间","id":"20220428141727-q83o36l","type":"h","href":"/topic/redis/Redis的分布式锁#业务执行的时间大于redis锁过期的时间","parentId":"20220428141727-5jo3h6s","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[],"level":3},{"title":"redis部署模式的影响","id":"20220428141727-9xczwbf","type":"h","href":"/topic/redis/Redis的分布式锁#redis部署模式的影响","parentId":"20220428141727-5jo3h6s","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[],"level":3},{"title":"原子性问题","id":"20220428141727-u4jomll","type":"h","href":"/topic/redis/Redis的分布式锁#原子性问题","parentId":"20220428141727-5jo3h6s","path":"/topic/redis/Redis的分布式锁","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"看门狗模式","id":"20220428141728-gdeeql2","type":"d","href":"/topic/redis/Redis的分布式锁/看门狗模式","parentId":"","path":"/topic/redis/Redis的分布式锁/看门狗模式","parentPath":"/topic/redis/Redis的分布式锁","sort":1,"children":[],"level":2},{"title":"Redlock","id":"20220428141728-qbzn1tc","type":"d","href":"/topic/redis/Redis的分布式锁/Redlock","parentId":"","path":"/topic/redis/Redis的分布式锁/Redlock","parentPath":"/topic/redis/Redis的分布式锁","sort":2,"children":[{"title":"问题1","id":"20220428141728-lg0r797","type":"h","href":"/topic/redis/Redis的分布式锁/Redlock#问题1","parentId":"20220428141728-qbzn1tc","path":"/topic/redis/Redis的分布式锁/Redlock","parentPath":"/topic/redis/Redis的分布式锁","children":[],"level":3},{"title":"问题2","id":"20220428141728-nhr8fen","type":"h","href":"/topic/redis/Redis的分布式锁/Redlock#问题2","parentId":"20220428141728-qbzn1tc","path":"/topic/redis/Redis的分布式锁/Redlock","parentPath":"/topic/redis/Redis的分布式锁","children":[],"level":3},{"title":"问题3","id":"20220428141728-5jc3ave","type":"h","href":"/topic/redis/Redis的分布式锁/Redlock#问题3","parentId":"20220428141728-qbzn1tc","path":"/topic/redis/Redis的分布式锁/Redlock","parentPath":"/topic/redis/Redis的分布式锁","children":[],"level":3}],"level":2}],"level":1},{"title":"Redis集群","id":"20220428141727-awm7yu5","type":"d","href":"/topic/redis/Redis集群","parentId":"","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","sort":6,"children":[{"title":"三种集群方案","id":"20220428141727-id6w37y","type":"h","href":"/topic/redis/Redis集群#三种集群方案","parentId":"20220428141727-awm7yu5","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":2},{"title":"主从复制模式","id":"20220428141727-01yokji","type":"h","href":"/topic/redis/Redis集群#主从复制模式","parentId":"20220428141727-awm7yu5","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[{"title":"原理","id":"20220428141727-2xgqon2","type":"h","href":"/topic/redis/Redis集群#原理","parentId":"20220428141727-01yokji","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3},{"title":"redis主从复制的坑","id":"20220428141727-h04f0fa","type":"h","href":"/topic/redis/Redis集群#redis主从复制的坑","parentId":"20220428141727-01yokji","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"哨兵模式","id":"20220428141727-jxcatge","type":"h","href":"/topic/redis/Redis集群#哨兵模式","parentId":"20220428141727-awm7yu5","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[{"title":"哨兵模式的作用","id":"20220428141727-3jb6vil","type":"h","href":"/topic/redis/Redis集群#哨兵模式的作用","parentId":"20220428141727-jxcatge","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3},{"title":"故障切换的过程","id":"20220428141727-uscl9hh","type":"h","href":"/topic/redis/Redis集群#故障切换的过程","parentId":"20220428141727-jxcatge","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3},{"title":"哨兵模式的工作方式：","id":"20220428141727-fe5liq6","type":"h","href":"/topic/redis/Redis集群#哨兵模式的工作方式：","parentId":"20220428141727-jxcatge","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3},{"title":"哨兵模式的优缺点","id":"20220428141727-fq18erp","type":"h","href":"/topic/redis/Redis集群#哨兵模式的优缺点","parentId":"20220428141727-jxcatge","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"Cluster 集群模式（Redis官方）","id":"20220428141727-z0udk1o","type":"h","href":"/topic/redis/Redis集群#Cluster 集群模式（Redis官方）","parentId":"20220428141727-awm7yu5","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[{"title":"集群的数据分片","id":"20220428141727-zez6jhc","type":"h","href":"/topic/redis/Redis集群#集群的数据分片","parentId":"20220428141727-z0udk1o","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3},{"title":"Redis 集群的主从复制模型","id":"20220428141727-guu9h2l","type":"h","href":"/topic/redis/Redis集群#Redis 集群的主从复制模型","parentId":"20220428141727-z0udk1o","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3},{"title":"集群的特点","id":"20220428141727-a9a9ogo","type":"h","href":"/topic/redis/Redis集群#集群的特点","parentId":"20220428141727-z0udk1o","path":"/topic/redis/Redis集群","parentPath":"/topic/redis","children":[],"level":3}],"level":2},{"title":"Redis数据淘汰策略","id":"20220428141727-oaw8wmd","type":"d","href":"/topic/redis/Redis集群/Redis数据淘汰策略","parentId":"","path":"/topic/redis/Redis集群/Redis数据淘汰策略","parentPath":"/topic/redis/Redis集群","sort":5,"children":[{"title":"Redis的内存淘汰策略，有以下几种","id":"20220428141727-aort8cn","type":"h","href":"/topic/redis/Redis集群/Redis数据淘汰策略#Redis的内存淘汰策略，有以下几种","parentId":"20220428141727-oaw8wmd","path":"/topic/redis/Redis集群/Redis数据淘汰策略","parentPath":"/topic/redis/Redis集群","children":[],"level":3},{"title":"数据库中有 3000w 的数据，而 Redis 中只有 100w 数据，如何保证 Redis 中存放的都是热点数据","id":"20220428141727-egla613","type":"h","href":"/topic/redis/Redis集群/Redis数据淘汰策略#数据库中有 3000w 的数据，而 Redis 中只有 100w 数据，如何保证 Redis 中存放的都是热点数据","parentId":"20220428141727-oaw8wmd","path":"/topic/redis/Redis集群/Redis数据淘汰策略","parentPath":"/topic/redis/Redis集群","children":[],"level":3}],"level":2},{"title":"redis持久化","id":"20220428141728-ahu8hnn","type":"d","href":"/topic/redis/Redis集群/redis持久化","parentId":"","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","sort":8,"children":[{"title":"策略","id":"20220428141728-h8spnbe","type":"h","href":"/topic/redis/Redis集群/redis持久化#策略","parentId":"20220428141728-ahu8hnn","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":3},{"title":"AOF持久化","id":"20220428141728-8sb3e90","type":"h","href":"/topic/redis/Redis集群/redis持久化#AOF持久化","parentId":"20220428141728-ahu8hnn","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[{"title":"执行流程","id":"20220428141728-xdy9wq3","type":"h","href":"/topic/redis/Redis集群/redis持久化#执行流程","parentId":"20220428141728-8sb3e90","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":4},{"title":"怎么防止AOF文件越来越大？","id":"20220428141728-2fjjnsi","type":"h","href":"/topic/redis/Redis集群/redis持久化#怎么防止AOF文件越来越大？","parentId":"20220428141728-8sb3e90","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[{"title":"AOF文件追加阻塞？","id":"20220428141728-jggnla6","type":"h","href":"/topic/redis/Redis集群/redis持久化#AOF文件追加阻塞？","parentId":"20220428141728-2fjjnsi","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":5}],"level":4}],"level":3},{"title":"RDB持久化","id":"20220428141728-3uk1dzb","type":"h","href":"/topic/redis/Redis集群/redis持久化#RDB持久化","parentId":"20220428141728-ahu8hnn","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[{"title":"执行流程","id":"20220428141728-b6xujxs","type":"h","href":"/topic/redis/Redis集群/redis持久化#执行流程","parentId":"20220428141728-3uk1dzb","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":4}],"level":3},{"title":"混合持久化（Redis4.0+）","id":"20220428141728-z9bdsb4","type":"h","href":"/topic/redis/Redis集群/redis持久化#混合持久化（Redis4.0+）","parentId":"20220428141728-ahu8hnn","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[{"title":"执行流程","id":"20220428141728-flzi42f","type":"h","href":"/topic/redis/Redis集群/redis持久化#执行流程","parentId":"20220428141728-z9bdsb4","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":4}],"level":3},{"title":"Redis的数据恢复策略","id":"20220428141728-x9y47t6","type":"h","href":"/topic/redis/Redis集群/redis持久化#Redis的数据恢复策略","parentId":"20220428141728-ahu8hnn","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":3},{"title":"Redis持久化策略该如何进行选择","id":"20220428141728-54y3bdq","type":"h","href":"/topic/redis/Redis集群/redis持久化#Redis持久化策略该如何进行选择","parentId":"20220428141728-ahu8hnn","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[{"title":"1.不需要考虑数据丢失的情况","id":"20220428141728-ujbrmwt","type":"h","href":"/topic/redis/Redis集群/redis持久化#1.不需要考虑数据丢失的情况","parentId":"20220428141728-54y3bdq","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":4},{"title":"2.单机实例情况下","id":"20220428141728-zahznfw","type":"h","href":"/topic/redis/Redis集群/redis持久化#2.单机实例情况下","parentId":"20220428141728-54y3bdq","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":4},{"title":"3.在主从环境下","id":"20220428141728-jbd8vij","type":"h","href":"/topic/redis/Redis集群/redis持久化#3.在主从环境下","parentId":"20220428141728-54y3bdq","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[{"title":"那么在从服务器进行数据热备份的情况下，是否还需要持久化呢？","id":"20220428141728-sjs8krt","type":"h","href":"/topic/redis/Redis集群/redis持久化#那么在从服务器进行数据热备份的情况下，是否还需要持久化呢？","parentId":"20220428141728-jbd8vij","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":5},{"title":"4.异地灾备","id":"20220428141728-aryf17w","type":"h","href":"/topic/redis/Redis集群/redis持久化#4.异地灾备","parentId":"20220428141728-jbd8vij","path":"/topic/redis/Redis集群/redis持久化","parentPath":"/topic/redis/Redis集群","children":[],"level":5}],"level":4}],"level":3}],"level":2},{"title":"Redis数据删除策略","id":"20220428141727-pvzi1zo","type":"d","href":"/topic/redis/Redis集群/Redis数据删除策略","parentId":"","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","sort":13,"children":[{"title":"惰性删除","id":"20220428141727-o0rija8","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#惰性删除","parentId":"20220428141727-pvzi1zo","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":3},{"title":"定期删除","id":"20220428141727-wq9axfb","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#定期删除","parentId":"20220428141727-pvzi1zo","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":3},{"title":"AOF、RDB 和复制功能对过期键的处理","id":"20220428141727-gr8a4lk","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#AOF、RDB 和复制功能对过期键的处理","parentId":"20220428141727-pvzi1zo","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[{"title":"RDB","id":"20220428141727-xhxrdyf","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#RDB","parentId":"20220428141727-gr8a4lk","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":4},{"title":"AOF","id":"20220428141727-z7l5azb","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#AOF","parentId":"20220428141727-gr8a4lk","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":4},{"title":"复制","id":"20220428141727-vdap5h4","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#复制","parentId":"20220428141727-gr8a4lk","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":4}],"level":3},{"title":"疑问点？","id":"20220428141727-5x39avu","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#疑问点？","parentId":"20220428141727-pvzi1zo","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[{"title":"如果主从服务器链接断开怎么办？","id":"20220428141727-4505lb0","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#如果主从服务器链接断开怎么办？","parentId":"20220428141727-5x39avu","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":4},{"title":"如果发生网络抖动，主服务器发送的 del 命令没有传递到从服务器怎么办？","id":"20220428141727-4x9rpfk","type":"h","href":"/topic/redis/Redis集群/Redis数据删除策略#如果发生网络抖动，主服务器发送的 del 命令没有传递到从服务器怎么办？","parentId":"20220428141727-5x39avu","path":"/topic/redis/Redis集群/Redis数据删除策略","parentPath":"/topic/redis/Redis集群","children":[],"level":4}],"level":3}],"level":2}],"level":1}],"level":0},"headings":[{"depth":1,"value":"SDS 结构","slug":"sds-结构"},{"depth":1,"value":"相对于C语言的优势","slug":"相对于c语言的优势"},{"depth":2,"value":"统计长度时间复杂度 O(1)","slug":"统计长度时间复杂度-o1"},{"depth":2,"value":"数据溢出","slug":"数据溢出"},{"depth":2,"value":"内存重分配策略","slug":"内存重分配策略"},{"depth":2,"value":"数据格式多样性","slug":"数据格式多样性"},{"depth":1,"value":"三大编码","slug":"三大编码"}]}},
    "staticQueryHashes": ["630634786","928362550"]}