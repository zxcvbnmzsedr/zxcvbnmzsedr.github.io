{
    "componentChunkName": "component---src-templates-topic-page-template-tsx",
    "path": "/topic/系统设计/样例/短链系统",
    "result": {"pageContext":{"id":"/topic/系统设计/样例/短链系统","htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"a短链系统设计看起来简单，但是每个点都能展开很多知识点。短链是通过访问服务器上的链接，通过Http返回的302Code，对链接进行重定向，然后访问到对应的地址上。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659665713332","width":"100%","xmlns":"http://www.w3.org/2000/svg","height":"315","style":"max-width: 710px;","viewBox":"-50 -10 710 315"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659665713332 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659665713332 .error-icon{fill:#552222;}#mermaid-1659665713332 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659665713332 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659665713332 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659665713332 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659665713332 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659665713332 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659665713332 .marker{fill:#333333;stroke:#333333;}#mermaid-1659665713332 .marker.cross{stroke:#333333;}#mermaid-1659665713332 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659665713332 .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1659665713332 text.actor>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .actor-line{stroke:grey;}#mermaid-1659665713332 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1659665713332 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1659665713332 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1659665713332 .sequenceNumber{fill:white;}#mermaid-1659665713332 #sequencenumber{fill:#333;}#mermaid-1659665713332 #crosshead path{fill:#333;stroke:#333;}#mermaid-1659665713332 .messageText{fill:#333;stroke:#333;}#mermaid-1659665713332 .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1659665713332 .labelText,#mermaid-1659665713332 .labelText>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .loopText,#mermaid-1659665713332 .loopText>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mermaid-1659665713332 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1659665713332 .noteText,#mermaid-1659665713332 .noteText>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1659665713332 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1659665713332 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1659665713332 .actorPopupMenu{position:absolute;}#mermaid-1659665713332 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mermaid-1659665713332 .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1659665713332 .actor-man circle,#mermaid-1659665713332 line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#mermaid-1659665713332 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"symbol","properties":{"id":"computer","width":"24","height":"24"},"children":[{"type":"element","tagName":"path","properties":{"transform":"scale(.5)","d":"M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"symbol","properties":{"id":"database","fillRule":"evenodd","clipRule":"evenodd"},"children":[{"type":"element","tagName":"path","properties":{"transform":"scale(.5)","d":"M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"symbol","properties":{"id":"clock","width":"24","height":"24"},"children":[{"type":"element","tagName":"path","properties":{"transform":"scale(.5)","d":"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z"},"children":[]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"line","properties":{"id":"actor0","x1":"75","y1":"5","x2":"75","y2":"249","className":["200"],"strokeWidth":"0.5px","stroke":"#999"},"children":[]},{"type":"element","tagName":"g","properties":{"id":"root-0"},"children":[{"type":"element","tagName":"rect","properties":{"x":"0","y":"0","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"75","y":"32.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"75","dy":"0"},"children":[{"type":"text","value":"客户端"}]}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"line","properties":{"id":"actor1","x1":"335","y1":"5","x2":"335","y2":"249","className":["200"],"strokeWidth":"0.5px","stroke":"#999"},"children":[]},{"type":"element","tagName":"g","properties":{"id":"root-1"},"children":[{"type":"element","tagName":"rect","properties":{"x":"260","y":"0","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"335","y":"32.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"335","dy":"0"},"children":[{"type":"text","value":"短链服务器"}]}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"line","properties":{"id":"actor2","x1":"535","y1":"5","x2":"535","y2":"249","className":["200"],"strokeWidth":"0.5px","stroke":"#999"},"children":[]},{"type":"element","tagName":"g","properties":{"id":"root-2"},"children":[{"type":"element","tagName":"rect","properties":{"x":"460","y":"0","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"535","y":"32.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"535","dy":"0"},"children":[{"type":"text","value":"B服务器"}]}]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead","refX":"9","refY":"5","markerUnits":"userSpaceOnUse","markerWidth":"12","markerHeight":"12","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"crosshead","markerWidth":"15","markerHeight":"8","orient":"auto","refX":"16","refY":"4"},"children":[{"type":"element","tagName":"path","properties":{"fill":"black","stroke":"#000000","strokeWidth":"1px","d":"M 9,2 V 6 L16,4 Z","style":"stroke-dasharray: 0, 0;"},"children":[]},{"type":"element","tagName":"path","properties":{"fill":"none","stroke":"#000000","strokeWidth":"1px","d":"M 0,1 L 6,7 M 6,1 L 0,7","style":"stroke-dasharray: 0, 0;"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"filled-head","refX":"18","refY":"7","markerWidth":"20","markerHeight":"28","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 18,7 L9,13 L14,7 L9,1 Z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"sequencenumber","refX":"15","refY":"15","markerWidth":"60","markerHeight":"40","orient":"auto"},"children":[{"type":"element","tagName":"circle","properties":{"cx":"15","cy":"15","r":"6"},"children":[]}]}]},{"type":"element","tagName":"text","properties":{"x":"205","y":"80","textAnchor":"middle","dominantBaseline":"middle","alignmentBaseline":"middle","className":["messageText"],"dy":"1em","style":"font-family: \"trebuchet ms\", verdana, arial, sans-serif; font-size: 16px; font-weight: 400;"},"children":[{"type":"text","value":"访问A"}]},{"type":"element","tagName":"line","properties":{"x1":"75","y1":"113","x2":"335","y2":"113","className":["messageLine0"],"strokeWidth":"2","stroke":"none","markerEnd":"url(#arrowhead)","style":"fill: none;"},"children":[]},{"type":"element","tagName":"text","properties":{"x":"205","y":"128","textAnchor":"middle","dominantBaseline":"middle","alignmentBaseline":"middle","className":["messageText"],"dy":"1em","style":"font-family: \"trebuchet ms\", verdana, arial, sans-serif; font-size: 16px; font-weight: 400;"},"children":[{"type":"text","value":"status code:302  location:B"}]},{"type":"element","tagName":"line","properties":{"x1":"335","y1":"161","x2":"75","y2":"161","className":["messageLine0"],"strokeWidth":"2","stroke":"none","markerEnd":"url(#arrowhead)","style":"fill: none;"},"children":[]},{"type":"element","tagName":"text","properties":{"x":"305","y":"176","textAnchor":"middle","dominantBaseline":"middle","alignmentBaseline":"middle","className":["messageText"],"dy":"1em","style":"font-family: \"trebuchet ms\", verdana, arial, sans-serif; font-size: 16px; font-weight: 400;"},"children":[{"type":"text","value":"访问B"}]},{"type":"element","tagName":"line","properties":{"x1":"75","y1":"209","x2":"535","y2":"209","className":["messageLine0"],"strokeWidth":"2","stroke":"none","markerEnd":"url(#arrowhead)","style":"fill: none;"},"children":[]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"rect","properties":{"x":"0","y":"229","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"75","y":"261.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"75","dy":"0"},"children":[{"type":"text","value":"客户端"}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"rect","properties":{"x":"260","y":"229","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"335","y":"261.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"335","dy":"0"},"children":[{"type":"text","value":"短链服务器"}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"rect","properties":{"x":"460","y":"229","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"535","y":"261.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"535","dy":"0"},"children":[{"type":"text","value":"B服务器"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　Http协议中重定向有两种code: 301 、302"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"301: 代表永久"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"重定向"}]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"302: 代表"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"临时重定向"}]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　他们的区别就在于浏览器会对301做缓存的效果，如果返回的code是301，则浏览器缓存A到B的映射，在下次发起请求的时候不会再去请求A的服务器。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"概述用例和约束"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":" 输入一段文本，然后得到一个随机生成的链接"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"过期设置"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"默认的设置是不会过期的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"可以选择设置一个过期的时间"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":" 输入一个 paste 的 url 后，可以看到它存储的内容"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":" 是匿名的"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":" 跟踪页面分析"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"一个月的访问统计"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":" 删除过期的 pastes"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":" 需要高可用"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"约束和假设"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"访问流量不是均匀分布的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"打开一个短链接应该是很快的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pastes 只能是文本"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"页面访问分析数据可以不用实时"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"一千万的用户量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每个月一千万的 paste 写入量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每个月一亿的 paste 读取量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"读写比例在 10:1"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"预估容量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"每个 paste 的大小"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每一个 paste 1 KB"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"shortlink"}]},{"type":"text","value":" - 7 bytes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"expiration_length_in_minutes"}]},{"type":"text","value":" - 4 bytes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"created_at"}]},{"type":"text","value":" - 5 bytes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"总共 = ~1.27 KB"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"每个月新的 paste 内容在 12.7GB"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"(1.27 * 10000000)KB / 月的 paste"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"三年内将近 450GB 的新 paste 内容"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"三年内 3.6 亿短链接"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"假设大部分都是新的 paste，而不是需要更新已存在的 paste"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"平均 4paste/s 的写入速度"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"平均 40paste/s 的读取速度"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"创建一个高层次设计"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　用webServer作为请求的入口，然后调用API去访问SQL。最后采用Analytics对请求数据进行分析。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659665713332","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"324","style":"max-width: 359.515625px;","viewBox":"0 0 359.515625 324"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659665713332 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659665713332 .error-icon{fill:#552222;}#mermaid-1659665713332 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659665713332 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659665713332 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659665713332 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659665713332 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659665713332 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659665713332 .marker{fill:#333333;stroke:#333333;}#mermaid-1659665713332 .marker.cross{stroke:#333333;}#mermaid-1659665713332 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659665713332 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659665713332 .cluster-label text{fill:#333;}#mermaid-1659665713332 .cluster-label span{color:#333;}#mermaid-1659665713332 .label text,#mermaid-1659665713332 span{fill:#333;color:#333;}#mermaid-1659665713332 .node rect,#mermaid-1659665713332 .node circle,#mermaid-1659665713332 .node ellipse,#mermaid-1659665713332 .node polygon,#mermaid-1659665713332 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659665713332 .node .label{text-align:center;}#mermaid-1659665713332 .node.clickable{cursor:pointer;}#mermaid-1659665713332 .arrowheadPath{fill:#333333;}#mermaid-1659665713332 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659665713332 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659665713332 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659665713332 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659665713332 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659665713332 .cluster text{fill:#333;}#mermaid-1659665713332 .cluster span{color:#333;}#mermaid-1659665713332 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659665713332 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-客户端","LE-WebServer"],"id":"L-客户端-WebServer","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M111.515625,50.5L111.515625,54.666666666666664C111.515625,58.833333333333336,111.515625,67.16666666666667,111.515625,75.5C111.515625,83.83333333333333,111.515625,92.16666666666667,111.515625,96.33333333333333L111.515625,100.5","markerEnd":"url(#arrowhead20)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead20","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-WriteAPI"],"id":"L-WebServer-WriteAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M139.68540342514123,139L145.7827580626177,143.16666666666666C151.88011270009414,147.33333333333334,164.07482197504706,155.66666666666666,170.17217661252354,164C176.26953125,172.33333333333334,176.26953125,180.66666666666666,176.26953125,184.83333333333334L176.26953125,189","markerEnd":"url(#arrowhead21)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead21","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-ReadAPI"],"id":"L-WebServer-ReadAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M83.34584657485875,139L77.2484919373823,143.16666666666666C71.15113729990584,147.33333333333334,58.95642802495291,155.66666666666666,52.85907338747646,164C46.76171875,172.33333333333334,46.76171875,180.66666666666666,46.76171875,184.83333333333334L46.76171875,189","markerEnd":"url(#arrowhead22)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead22","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-ReadAPI","LE-SQL"],"id":"L-ReadAPI-SQL","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M46.76171875,227.5L46.76171875,231.66666666666666C46.76171875,235.83333333333334,46.76171875,244.16666666666666,64.46223958333333,254.38121594176673C82.16276041666667,264.59576521686677,117.56380208333333,276.6915304337335,135.26432291666666,282.73941304216686L152.96484375,288.78729565060024","markerEnd":"url(#arrowhead23)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead23","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WriteAPI","LE-SQL"],"id":"L-WriteAPI-SQL","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M176.26953125,227.5L176.26953125,231.66666666666666C176.26953125,235.83333333333334,176.26953125,244.16666666666666,176.26953125,252.5C176.26953125,260.8333333333333,176.26953125,269.1666666666667,176.26953125,273.3333333333333L176.26953125,277.5","markerEnd":"url(#arrowhead24)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead24","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Analytics","LE-SQL"],"id":"L-Analytics-SQL","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M309.265625,227.5L309.265625,231.66666666666666C309.265625,235.83333333333334,309.265625,244.16666666666666,290.9837239583333,254.41602417246747C272.7018229166667,264.66538167826826,236.13802083333334,276.8307633565366,217.85611979166666,282.9134541956707L199.57421875,288.99614503480484","markerEnd":"url(#arrowhead25)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead25","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-客户端-WebServer","className":["edgeLabel","L-LS-客户端'","L-LE-WebServer"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-WriteAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-WriteAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-ReadAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-ReadAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-ReadAPI-SQL","className":["edgeLabel","L-LS-ReadAPI'","L-LE-SQL"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WriteAPI-SQL","className":["edgeLabel","L-LS-WriteAPI'","L-LE-SQL"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Analytics-SQL","className":["edgeLabel","L-LS-Analytics'","L-LE-SQL"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-客户端-12","transform":"translate(111.515625,29.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-34","y":"-21.25","width":"68","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-24,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"48","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"客户端"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WebServer-13","transform":"translate(111.515625,119.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-47.98046875","y":"-19.25","width":"95.9609375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-37.98046875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"75.9609375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WebServer"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WriteAPI-15","transform":"translate(176.26953125,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-40.74609375","y":"-19.25","width":"81.4921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-30.74609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"61.4921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WriteAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-ReadAPI-17","transform":"translate(46.76171875,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-38.76171875","y":"-19.25","width":"77.5234375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-28.76171875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"57.5234375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"ReadAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQL-19","transform":"translate(176.26953125,296.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-23.3046875","y":"-19.25","width":"46.609375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-13.3046875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"26.609375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQL"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-Analytics-22","transform":"translate(309.265625,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-42.25","y":"-19.25","width":"84.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-32.25,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"64.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"Analytics"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"设计核心组件"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例: "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":"输入一段文本，然后得到一个随机生成的链接"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　用关系型数据库直接将生成的URL映射成用户的URL。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"客户端"}]},{"type":"text","value":" 发送一个创建 paste 的请求到作为一个"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8"},"children":[{"type":"text","value":"反向代理"}]},{"type":"text","value":"启动的  "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web 服务器"}]},{"type":"text","value":" 。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web 服务器"}]},{"type":"text","value":" 转发请求给 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"写接口"}]},{"type":"text","value":" 服务器"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"写接口"}]},{"type":"text","value":" 服务器执行如下操作："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"生成一个唯一的 url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"检查这个 url 在 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 里面是否是唯一的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果这个 url 不是唯一的，生成另外一个 url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果我们支持自定义 url，我们可以使用用户提供的 url（也需要检查是否重复）"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"把生成的 url 和用户的url 存储到 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 的 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pastes"}]},{"type":"text","value":" 表里面"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"返回生成的 url"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pastes"}]},{"type":"text","value":"结构如下:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","dark-default-dark"],"dataLanguage":"sql","dataIndex":"0"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"shortlink "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"char"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"7"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"expiration_length_in_minutes "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"created_at "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"datetime"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"paste "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"varchar"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"2048"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"PRIMARY"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"KEY"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"(shortlink)"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　在"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"shortlink"}]},{"type":"text","value":"上创建一个数据库索引，用来提高查询的速度。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例：用户输入一个 paste 的 url 后可以看到它存储的内容"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"客户端"}]},{"type":"text","value":" 发送一个获取 paste 请求到 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web Server"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web Server"}]},{"type":"text","value":" 转发请求给 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"读取接口"}]},{"type":"text","value":" 服务器"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"读取接口"}]},{"type":"text","value":" 服务器执行如下操作："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 检查这个生成的 url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果这个 url 在 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 里面，则从返回这个 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"paste"}]},{"type":"text","value":" 的内容"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"否则，返回一个错误页面给用户"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例： 服务跟踪分析页面"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　因为实时分析不是必须的，所以我们可以简单的 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"MapReduce"}]},{"type":"text","value":" "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web Server"}]},{"type":"text","value":" 的日志，用来生成点击次数。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例： 服务删除过期的 pastes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　为了删除过期的 pastes，我们可以直接搜索 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 中所有的过期时间比当前时间更早的记录， 所有过期的记录将从这张表里面删除（或者将其标记为过期）。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"扩展设计"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659665713333","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"589.5","style":"max-width: 445.16796875px;","viewBox":"0 0 445.16796875 589.5"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659665713333 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659665713333 .error-icon{fill:#552222;}#mermaid-1659665713333 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659665713333 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659665713333 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659665713333 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659665713333 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659665713333 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659665713333 .marker{fill:#333333;stroke:#333333;}#mermaid-1659665713333 .marker.cross{stroke:#333333;}#mermaid-1659665713333 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659665713333 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659665713333 .cluster-label text{fill:#333;}#mermaid-1659665713333 .cluster-label span{color:#333;}#mermaid-1659665713333 .label text,#mermaid-1659665713333 span{fill:#333;color:#333;}#mermaid-1659665713333 .node rect,#mermaid-1659665713333 .node circle,#mermaid-1659665713333 .node ellipse,#mermaid-1659665713333 .node polygon,#mermaid-1659665713333 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659665713333 .node .label{text-align:center;}#mermaid-1659665713333 .node.clickable{cursor:pointer;}#mermaid-1659665713333 .arrowheadPath{fill:#333333;}#mermaid-1659665713333 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659665713333 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659665713333 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659665713333 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659665713333 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659665713333 .cluster text{fill:#333;}#mermaid-1659665713333 .cluster span{color:#333;}#mermaid-1659665713333 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659665713333 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Client","LE-DNS负载"],"id":"L-Client-DNS负载","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M108.51842778954803,46.5L103.40793461629004,50.666666666666664C98.29744144303201,54.833333333333336,88.076455096516,63.166666666666664,82.965961923258,71.5C77.85546875,79.83333333333333,77.85546875,88.16666666666667,77.85546875,92.33333333333333L77.85546875,96.5","markerEnd":"url(#arrowhead40)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead40","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Client","LE-CDN回源"],"id":"L-Client-CDN回源","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M163.4609375,45.401235041423746L170.96940104166666,49.75102920118646C178.47786458333334,54.100823360949164,193.49479166666666,62.80041168047458,201.00325520833334,71.31687250690396C208.51171875,79.83333333333333,208.51171875,88.16666666666667,208.51171875,92.33333333333333L208.51171875,96.5","markerEnd":"url(#arrowhead41)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead41","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-DNS负载","LE-LoadBalancer"],"id":"L-DNS负载-LoadBalancer","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M77.85546875,139L77.85546875,143.16666666666666C77.85546875,147.33333333333334,77.85546875,155.66666666666666,77.85546875,164C77.85546875,172.33333333333334,77.85546875,180.66666666666666,77.85546875,184.83333333333334L77.85546875,189","markerEnd":"url(#arrowhead42)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead42","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-LoadBalancer","LE-WebServer"],"id":"L-LoadBalancer-WebServer","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M77.85546875,227.5L77.85546875,231.66666666666666C77.85546875,235.83333333333334,77.85546875,244.16666666666666,77.85546875,252.5C77.85546875,260.8333333333333,77.85546875,269.1666666666667,77.85546875,273.3333333333333L77.85546875,277.5","markerEnd":"url(#arrowhead43)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead43","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-WriteAPI"],"id":"L-WebServer-WriteAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M125.8359375,310.23390557939916L144.08203125,315.36158798283265C162.328125,320.4892703862661,198.8203125,330.74463519313304,217.06640625,340.0389842632332C235.3125,349.3333333333333,235.3125,357.6666666666667,235.3125,361.8333333333333L235.3125,366","markerEnd":"url(#arrowhead44)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead44","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-ReadAPI"],"id":"L-WebServer-ReadAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M77.85546875,316L77.85546875,320.1666666666667C77.85546875,324.3333333333333,77.85546875,332.6666666666667,77.85546875,344.2083333333333C77.85546875,355.75,77.85546875,370.5,77.85546875,385.25C77.85546875,400,77.85546875,414.75,77.85546875,426.2916666666667C77.85546875,437.8333333333333,77.85546875,446.1666666666667,77.85546875,450.3333333333333L77.85546875,454.5","markerEnd":"url(#arrowhead45)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead45","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-ReadAPI","LE-MemoryCache"],"id":"L-ReadAPI-MemoryCache","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M116.6171875,483.3019317366051L140.08463541666666,489.0849431138376C163.55208333333334,494.8679544910701,210.48697916666666,506.43397724553506,233.95442708333334,516.3836552894342C257.421875,526.3333333333334,257.421875,534.6666666666666,257.421875,538.8333333333334L257.421875,543","markerEnd":"url(#arrowhead46)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead46","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WriteAPI","LE-SQLMaster-Slave"],"id":"L-WriteAPI-SQLMaster-Slave","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M235.3125,404.5L235.3125,408.6666666666667C235.3125,412.8333333333333,235.3125,421.1666666666667,235.3125,429.5C235.3125,437.8333333333333,235.3125,446.1666666666667,235.3125,450.3333333333333L235.3125,454.5","markerEnd":"url(#arrowhead47)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead47","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-ReadAPI","LE-SQLReadReplicas"],"id":"L-ReadAPI-SQLReadReplicas","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M56.570522157485875,493L51.9633908604049,497.1666666666667C47.35625956332391,501.3333333333333,38.14199696916196,509.6666666666667,38.14199696916196,518C38.14199696916196,526.3333333333334,47.35625956332391,534.6666666666666,51.9633908604049,538.8333333333334L56.570522157485875,543","markerEnd":"url(#arrowhead48)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead48","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-SQLMaster-Slave","LE-SQLReadReplicas"],"id":"L-SQLMaster-Slave-SQLReadReplicas","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M228.07675670903956,493L226.51057850753295,497.1666666666667C224.94440030602638,501.3333333333333,221.81204390301318,509.6666666666667,206.98558145009414,518C192.15911899717514,526.3333333333334,165.63855049435028,534.6666666666666,152.37826624293785,538.8333333333334L139.11798199152543,543","markerEnd":"url(#arrowhead49)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead49","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 0 0 L 0 0 z","style":"fill: #333"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Analytics","LE-SQLAnalytics"],"id":"L-Analytics-SQLAnalytics","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M381.61328125,316L381.61328125,320.1666666666667C381.61328125,324.3333333333333,381.61328125,332.6666666666667,381.61328125,341C381.61328125,349.3333333333333,381.61328125,357.6666666666667,381.61328125,361.8333333333333L381.61328125,366","markerEnd":"url(#arrowhead50)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead50","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-SQLAnalytics","LE-SQLMaster-Slave"],"id":"L-SQLAnalytics-SQLMaster-Slave","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M381.61328125,404.5L381.61328125,408.6666666666667C381.61328125,412.8333333333333,381.61328125,421.1666666666667,367.83731314736343,429.5C354.0613450447269,437.8333333333333,326.5094088394539,446.1666666666667,312.73344073681733,450.3333333333333L298.9574726341808,454.5","markerEnd":"url(#arrowhead51)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead51","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Client-DNS负载","className":["edgeLabel","L-LS-Client'","L-LE-DNS负载"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Client-CDN回源","className":["edgeLabel","L-LS-Client'","L-LE-CDN回源"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-DNS负载-LoadBalancer","className":["edgeLabel","L-LS-DNS负载'","L-LE-LoadBalancer"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-LoadBalancer-WebServer","className":["edgeLabel","L-LS-LoadBalancer'","L-LE-WebServer"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-WriteAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-WriteAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-ReadAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-ReadAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-ReadAPI-MemoryCache","className":["edgeLabel","L-LS-ReadAPI'","L-LE-MemoryCache"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WriteAPI-SQLMaster-Slave","className":["edgeLabel","L-LS-WriteAPI'","L-LE-SQLMaster-Slave"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-ReadAPI-SQLReadReplicas","className":["edgeLabel","L-LS-ReadAPI'","L-LE-SQLReadReplicas"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-SQLMaster-Slave-SQLReadReplicas","className":["edgeLabel","L-LS-SQLMaster-Slave'","L-LE-SQLReadReplicas"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Analytics-SQLAnalytics","className":["edgeLabel","L-LS-Analytics'","L-LE-SQLAnalytics"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-SQLAnalytics-SQLMaster-Slave","className":["edgeLabel","L-LS-SQLAnalytics'","L-LE-SQLMaster-Slave"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-Client-24","transform":"translate(132.12890625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-31.33203125","y":"-19.25","width":"62.6640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-21.33203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"42.6640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"Client"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-DNS负载-25","transform":"translate(77.85546875,117.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-39.859375","y":"-21.25","width":"79.71875","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-29.859375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"59.71875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"DNS负载"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-CDN回源-27","transform":"translate(208.51171875,117.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-40.796875","y":"-21.25","width":"81.59375","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-30.796875,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"61.59375","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"CDN回源"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-LoadBalancer-29","transform":"translate(77.85546875,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-58.1015625","y":"-19.25","width":"116.203125","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-48.1015625,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"96.203125","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"LoadBalancer"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WebServer-31","transform":"translate(77.85546875,296.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-47.98046875","y":"-19.25","width":"95.9609375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-37.98046875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"75.9609375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WebServer"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WriteAPI-33","transform":"translate(235.3125,385.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-40.74609375","y":"-19.25","width":"81.4921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-30.74609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"61.4921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WriteAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-ReadAPI-35","transform":"translate(77.85546875,473.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-38.76171875","y":"-19.25","width":"77.5234375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-28.76171875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"57.5234375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"ReadAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-MemoryCache-37","transform":"translate(257.421875,562.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-59.7109375","y":"-19.25","width":"119.421875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-49.7109375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"99.421875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"MemoryCache"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQLMaster-Slave-39","transform":"translate(235.3125,473.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-68.6953125","y":"-19.25","width":"137.390625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-58.6953125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"117.390625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQLMaster-Slave"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQLReadReplicas-41","transform":"translate(77.85546875,562.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-69.85546875","y":"-19.25","width":"139.7109375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-59.85546875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"119.7109375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQLReadReplicas"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-Analytics-44","transform":"translate(381.61328125,296.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-42.25","y":"-19.25","width":"84.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-32.25,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"64.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"Analytics"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQLAnalytics-45","transform":"translate(381.61328125,385.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-55.5546875","y":"-19.25","width":"111.109375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-45.5546875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"91.109375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQLAnalytics"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"对于请求量比较大的，应该将数据留在上游，这部分可以采用CDN来代理源站，将数据放在边缘"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"使用LoadBalancer来代理我们具体的服务器，以便于可以对webServer进行水平扩展"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"处理每秒40的读请求，其内容应该交由给内存级别的缓存来处理。比如Redis这种"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"对于单个关系型数据库，主从切分之后每秒4次的写入问题不大。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果写入出现了瓶颈，需要额外采用别的方式。包括但不限于："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"水平、垂直分片"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"非规范化"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"SQL调优"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"总结"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　对于短链系统，整体的系统的设计大概如此，从架构方面应该是满足要求了。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　其次，还有一些细节在我看来就是属于业务上的东西了，需要自行衡量,比如: 短链生成方法有好几种方式，Hash、Md5、UUID、redis、Snowflake、Mysql 自增主键。其选型并没有什么优劣之分，只有合适与否。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　整个系统的诞生是一个不断优化的过程，我们需要先解决有的问题，再持续进行优化。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"继续对系统进行基准测试和监控，以在瓶颈出现时解决它们"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"扩展是一个迭代的过程"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n"}]}],"data":{"quirksMode":false}},"html":"<p updated=\"20220805101449\">　　a短链系统设计看起来简单，但是每个点都能展开很多知识点。短链是通过访问服务器上的链接，通过Http返回的302Code，对链接进行重定向，然后访问到对应的地址上。</p>\n<div data-content=\"sequenceDiagram\n    客户端-&amp;gt;&amp;gt;短链服务器: 访问A\n    短链服务器-&amp;gt;&amp;gt;客户端: status code:302  location:B\n    客户端 -&amp;gt;&amp;gt; B服务器: 访问B\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220805101449\">　　Http协议中重定向有两种code: 301 、302</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-f7hylyq\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">301: 代表永久<strong>重定向</strong>。</p>\n</li>\n<li id=\"20220805101449-35th3n6\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">302: 代表<strong>临时重定向</strong>。</p>\n</li>\n</ul>\n<p updated=\"20220805101449\">　　他们的区别就在于浏览器会对301做缓存的效果，如果返回的code是301，则浏览器缓存A到B的映射，在下次发起请求的时候不会再去请求A的服务器。</p>\n<h1 id=\"概述用例和约束\">概述用例和约束</h1>\n<h2 id=\"用例\">用例</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-b942l6m\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>用户</strong> 输入一段文本，然后得到一个随机生成的链接</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-w112n9u\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">过期设置</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-u6948li\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">默认的设置是不会过期的</p>\n</li>\n<li id=\"20220805101449-19phlkd\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">可以选择设置一个过期的时间</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-xc04f4p\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>用户</strong> 输入一个 paste 的 url 后，可以看到它存储的内容</p>\n</li>\n<li id=\"20220805101449-9cfgydy\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>用户</strong> 是匿名的</p>\n</li>\n<li id=\"20220805101449-583sn2t\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Service</strong> 跟踪页面分析</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-9gw54as\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">一个月的访问统计</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-ex3160s\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Service</strong> 删除过期的 pastes</p>\n</li>\n<li id=\"20220805101449-gms7hj2\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Service</strong> 需要高可用</p>\n</li>\n</ul>\n<h2 id=\"约束和假设\">约束和假设</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-g1sk3iq\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">访问流量不是均匀分布的</p>\n</li>\n<li id=\"20220805101449-joo77cz\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">打开一个短链接应该是很快的</p>\n</li>\n<li id=\"20220805101449-z1s551i\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">pastes 只能是文本</p>\n</li>\n<li id=\"20220805101449-fqivp97\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">页面访问分析数据可以不用实时</p>\n</li>\n<li id=\"20220805101449-k7c7kgo\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">一千万的用户量</p>\n</li>\n<li id=\"20220805101449-e5uo30b\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个月一千万的 paste 写入量</p>\n</li>\n<li id=\"20220805101449-3svayds\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个月一亿的 paste 读取量</p>\n</li>\n<li id=\"20220805101449-dapyl1w\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">读写比例在 10:1</p>\n</li>\n</ul>\n<h2 id=\"预估容量\">预估容量</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-6gtyime\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个 paste 的大小</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-vo1i9vt\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每一个 paste 1 KB</p>\n</li>\n<li id=\"20220805101449-c3nrl7s\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><code>shortlink</code> - 7 bytes</p>\n</li>\n<li id=\"20220805101449-89zy5we\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><code>expiration_length_in_minutes</code> - 4 bytes</p>\n</li>\n<li id=\"20220805101449-cliki2v\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><code>created_at</code> - 5 bytes</p>\n</li>\n<li id=\"20220805101449-oqapqz3\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">总共 = ~1.27 KB</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-gqkc75u\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个月新的 paste 内容在 12.7GB</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-8ccxh2z\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">(1.27 * 10000000)KB / 月的 paste</p>\n</li>\n<li id=\"20220805101449-twx4mli\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">三年内将近 450GB 的新 paste 内容</p>\n</li>\n<li id=\"20220805101449-aw2lrz1\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">三年内 3.6 亿短链接</p>\n</li>\n<li id=\"20220805101449-aa6w4k4\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">假设大部分都是新的 paste，而不是需要更新已存在的 paste</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-vibz0il\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">平均 4paste/s 的写入速度</p>\n</li>\n<li id=\"20220805101449-s4hvjku\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">平均 40paste/s 的读取速度</p>\n</li>\n</ul>\n<h1 id=\"创建一个高层次设计\">创建一个高层次设计</h1>\n<p updated=\"20220805101449\">　　用webServer作为请求的入口，然后调用API去访问SQL。最后采用Analytics对请求数据进行分析。</p>\n<div data-content=\"graph TD;\n    客户端--&amp;gt;WebServer;\n    WebServer--&amp;gt;WriteAPI;\n    WebServer--&amp;gt;ReadAPI;\n    ReadAPI--&amp;gt;SQL;\n    WriteAPI--&amp;gt;SQL;\n   Analytics --&amp;gt;SQL;\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<h1 id=\"设计核心组件\">设计核心组件</h1>\n<h2 id=\"用例--用户输入一段文本-然后得到一个随机生成的链接\">用例: <strong>用户</strong>输入一段文本，然后得到一个随机生成的链接</h2>\n<p updated=\"20220805101449\">　　用关系型数据库直接将生成的URL映射成用户的URL。</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-m1z5hc2\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>客户端</strong> 发送一个创建 paste 的请求到作为一个<a href=\"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8\">反向代理</a>启动的  <strong>Web 服务器</strong> 。</p>\n</li>\n<li id=\"20220805101449-xsrvalm\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Web 服务器</strong> 转发请求给 <strong>写接口</strong> 服务器</p>\n</li>\n<li id=\"20220805101449-o00224g\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>写接口</strong> 服务器执行如下操作：</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-hdqpvvr\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">生成一个唯一的 url</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-q6e8o1c\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">检查这个 url 在 <strong>SQL 数据库</strong> 里面是否是唯一的</p>\n</li>\n<li id=\"20220805101449-9pow1mz\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">如果这个 url 不是唯一的，生成另外一个 url</p>\n</li>\n<li id=\"20220805101449-ryq7xia\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">如果我们支持自定义 url，我们可以使用用户提供的 url（也需要检查是否重复）</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-x8bot5f\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">把生成的 url 和用户的url 存储到 <strong>SQL 数据库</strong> 的 <code>pastes</code> 表里面</p>\n</li>\n<li id=\"20220805101449-4xgsv14\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">返回生成的 url</p>\n</li>\n</ul>\n</li>\n</ul>\n<p updated=\"20220805101449\">　　<code>pastes</code>结构如下:</p>\n<pre class=\"code-block\" data-language=\"sql\"><code class=\"hljs\">shortlink char(7) NOT NULL\nexpiration_length_in_minutes int NOT NULL\ncreated_at datetime NOT NULL\npaste varchar(2048) NOT NULL\nPRIMARY KEY(shortlink)\n</code></pre>\n<p updated=\"20220805101449\">　　在<code>shortlink</code>上创建一个数据库索引，用来提高查询的速度。</p>\n<h2 id=\"用例-用户输入一个-paste-的-url-后可以看到它存储的内容\">用例：用户输入一个 paste 的 url 后可以看到它存储的内容</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-2uoesim\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>客户端</strong> 发送一个获取 paste 请求到 <strong>Web Server</strong></p>\n</li>\n<li id=\"20220805101449-n71zekn\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Web Server</strong> 转发请求给 <strong>读取接口</strong> 服务器</p>\n</li>\n<li id=\"20220805101449-4oa90r8\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>读取接口</strong> 服务器执行如下操作：</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-3jjst5i\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">在 <strong>SQL 数据库</strong> 检查这个生成的 url</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-5km4aly\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">如果这个 url 在 <strong>SQL 数据库</strong> 里面，则从返回这个 <code>paste</code> 的内容</p>\n</li>\n<li id=\"20220805101449-h7ep887\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">否则，返回一个错误页面给用户</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"用例--服务跟踪分析页面\">用例： 服务跟踪分析页面</h2>\n<p updated=\"20220805101449\">　　因为实时分析不是必须的，所以我们可以简单的 <strong>MapReduce</strong> <strong>Web Server</strong> 的日志，用来生成点击次数。</p>\n<h2 id=\"用例--服务删除过期的-pastes\">用例： 服务删除过期的 pastes</h2>\n<p updated=\"20220805101449\">　　为了删除过期的 pastes，我们可以直接搜索 <strong>SQL 数据库</strong> 中所有的过期时间比当前时间更早的记录， 所有过期的记录将从这张表里面删除（或者将其标记为过期）。</p>\n<h1 id=\"扩展设计\">扩展设计</h1>\n<div data-content=\"graph TD;\n\tClient--&amp;gt;DNS负载;\n        Client--&amp;gt;CDN回源;\n\tDNS负载--&amp;gt;LoadBalancer;\n\tLoadBalancer--&amp;gt;WebServer;\n\tWebServer--&amp;gt;WriteAPI;\n\tWebServer--&amp;gt;ReadAPI;\n\tReadAPI--&amp;gt;MemoryCache;\n\tWriteAPI--&amp;gt;SQLMaster-Slave;\n\tReadAPI--&amp;gt;SQLReadReplicas;\n\tSQLMaster-Slave --- SQLReadReplicas;\n\tAnalytics--&amp;gt;SQLAnalytics;\n\tSQLAnalytics--&amp;gt;SQLMaster-Slave\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-ahxq184\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">对于请求量比较大的，应该将数据留在上游，这部分可以采用CDN来代理源站，将数据放在边缘</p>\n</li>\n<li id=\"20220805101449-zr1vchg\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">使用LoadBalancer来代理我们具体的服务器，以便于可以对webServer进行水平扩展</p>\n</li>\n<li id=\"20220805101449-sr9gxsq\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">处理每秒40的读请求，其内容应该交由给内存级别的缓存来处理。比如Redis这种</p>\n</li>\n<li id=\"20220805101449-rz45515\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">对于单个关系型数据库，主从切分之后每秒4次的写入问题不大。</p>\n<p updated=\"20220805101449\">如果写入出现了瓶颈，需要额外采用别的方式。包括但不限于：</p>\n<ol updated=\"20220805101449\">\n<li id=\"20220805101449-zmcb77p\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">水平、垂直分片</p>\n</li>\n<li id=\"20220805101449-f069p7j\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">非规范化</p>\n</li>\n<li id=\"20220805101449-nf9oxq2\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">SQL调优</p>\n</li>\n</ol>\n</li>\n</ul>\n<h1 id=\"总结\">总结</h1>\n<p updated=\"20220805101449\">　　对于短链系统，整体的系统的设计大概如此，从架构方面应该是满足要求了。</p>\n<p updated=\"20220805101449\">　　其次，还有一些细节在我看来就是属于业务上的东西了，需要自行衡量,比如: 短链生成方法有好几种方式，Hash、Md5、UUID、redis、Snowflake、Mysql 自增主键。其选型并没有什么优劣之分，只有合适与否。</p>\n<p updated=\"20220805101449\">　　整个系统的诞生是一个不断优化的过程，我们需要先解决有的问题，再持续进行优化。</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-xh7yl3h\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">继续对系统进行基准测试和监控，以在瓶颈出现时解决它们</p>\n</li>\n<li id=\"20220805101449-tfw3cfk\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">扩展是一个迭代的过程</p>\n</li>\n</ul>\n","articleNode":{"field":{"contentType":"topic","topic":"系统设计"},"frontmatter":{"id":"/topic/系统设计/样例/短链系统","title":"短链系统","date":"2022-05-23 14:28","absolute_path":"/topic/系统设计/样例/短链系统"},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"a短链系统设计看起来简单，但是每个点都能展开很多知识点。短链是通过访问服务器上的链接，通过Http返回的302Code，对链接进行重定向，然后访问到对应的地址上。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659665713332","width":"100%","xmlns":"http://www.w3.org/2000/svg","height":"315","style":"max-width: 710px;","viewBox":"-50 -10 710 315"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659665713332 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659665713332 .error-icon{fill:#552222;}#mermaid-1659665713332 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659665713332 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659665713332 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659665713332 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659665713332 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659665713332 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659665713332 .marker{fill:#333333;stroke:#333333;}#mermaid-1659665713332 .marker.cross{stroke:#333333;}#mermaid-1659665713332 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659665713332 .actor{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1659665713332 text.actor>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .actor-line{stroke:grey;}#mermaid-1659665713332 .messageLine0{stroke-width:1.5;stroke-dasharray:none;stroke:#333;}#mermaid-1659665713332 .messageLine1{stroke-width:1.5;stroke-dasharray:2,2;stroke:#333;}#mermaid-1659665713332 #arrowhead path{fill:#333;stroke:#333;}#mermaid-1659665713332 .sequenceNumber{fill:white;}#mermaid-1659665713332 #sequencenumber{fill:#333;}#mermaid-1659665713332 #crosshead path{fill:#333;stroke:#333;}#mermaid-1659665713332 .messageText{fill:#333;stroke:#333;}#mermaid-1659665713332 .labelBox{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1659665713332 .labelText,#mermaid-1659665713332 .labelText>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .loopText,#mermaid-1659665713332 .loopText>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .loopLine{stroke-width:2px;stroke-dasharray:2,2;stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);}#mermaid-1659665713332 .note{stroke:#aaaa33;fill:#fff5ad;}#mermaid-1659665713332 .noteText,#mermaid-1659665713332 .noteText>tspan{fill:black;stroke:none;}#mermaid-1659665713332 .activation0{fill:#f4f4f4;stroke:#666;}#mermaid-1659665713332 .activation1{fill:#f4f4f4;stroke:#666;}#mermaid-1659665713332 .activation2{fill:#f4f4f4;stroke:#666;}#mermaid-1659665713332 .actorPopupMenu{position:absolute;}#mermaid-1659665713332 .actorPopupMenuPanel{position:absolute;fill:#ECECFF;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2);filter:drop-shadow(3px 5px 2px rgb(0 0 0 / 0.4));}#mermaid-1659665713332 .actor-man line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;}#mermaid-1659665713332 .actor-man circle,#mermaid-1659665713332 line{stroke:hsl(259.6261682243, 59.7765363128%, 87.9019607843%);fill:#ECECFF;stroke-width:2px;}#mermaid-1659665713332 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"symbol","properties":{"id":"computer","width":"24","height":"24"},"children":[{"type":"element","tagName":"path","properties":{"transform":"scale(.5)","d":"M2 2v13h20v-13h-20zm18 11h-16v-9h16v9zm-10.228 6l.466-1h3.524l.467 1h-4.457zm14.228 3h-24l2-6h2.104l-1.33 4h18.45l-1.297-4h2.073l2 6zm-5-10h-14v-7h14v7z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"symbol","properties":{"id":"database","fillRule":"evenodd","clipRule":"evenodd"},"children":[{"type":"element","tagName":"path","properties":{"transform":"scale(.5)","d":"M12.258.001l.256.004.255.005.253.008.251.01.249.012.247.015.246.016.242.019.241.02.239.023.236.024.233.027.231.028.229.031.225.032.223.034.22.036.217.038.214.04.211.041.208.043.205.045.201.046.198.048.194.05.191.051.187.053.183.054.18.056.175.057.172.059.168.06.163.061.16.063.155.064.15.066.074.033.073.033.071.034.07.034.069.035.068.035.067.035.066.035.064.036.064.036.062.036.06.036.06.037.058.037.058.037.055.038.055.038.053.038.052.038.051.039.05.039.048.039.047.039.045.04.044.04.043.04.041.04.04.041.039.041.037.041.036.041.034.041.033.042.032.042.03.042.029.042.027.042.026.043.024.043.023.043.021.043.02.043.018.044.017.043.015.044.013.044.012.044.011.045.009.044.007.045.006.045.004.045.002.045.001.045v17l-.001.045-.002.045-.004.045-.006.045-.007.045-.009.044-.011.045-.012.044-.013.044-.015.044-.017.043-.018.044-.02.043-.021.043-.023.043-.024.043-.026.043-.027.042-.029.042-.03.042-.032.042-.033.042-.034.041-.036.041-.037.041-.039.041-.04.041-.041.04-.043.04-.044.04-.045.04-.047.039-.048.039-.05.039-.051.039-.052.038-.053.038-.055.038-.055.038-.058.037-.058.037-.06.037-.06.036-.062.036-.064.036-.064.036-.066.035-.067.035-.068.035-.069.035-.07.034-.071.034-.073.033-.074.033-.15.066-.155.064-.16.063-.163.061-.168.06-.172.059-.175.057-.18.056-.183.054-.187.053-.191.051-.194.05-.198.048-.201.046-.205.045-.208.043-.211.041-.214.04-.217.038-.22.036-.223.034-.225.032-.229.031-.231.028-.233.027-.236.024-.239.023-.241.02-.242.019-.246.016-.247.015-.249.012-.251.01-.253.008-.255.005-.256.004-.258.001-.258-.001-.256-.004-.255-.005-.253-.008-.251-.01-.249-.012-.247-.015-.245-.016-.243-.019-.241-.02-.238-.023-.236-.024-.234-.027-.231-.028-.228-.031-.226-.032-.223-.034-.22-.036-.217-.038-.214-.04-.211-.041-.208-.043-.204-.045-.201-.046-.198-.048-.195-.05-.19-.051-.187-.053-.184-.054-.179-.056-.176-.057-.172-.059-.167-.06-.164-.061-.159-.063-.155-.064-.151-.066-.074-.033-.072-.033-.072-.034-.07-.034-.069-.035-.068-.035-.067-.035-.066-.035-.064-.036-.063-.036-.062-.036-.061-.036-.06-.037-.058-.037-.057-.037-.056-.038-.055-.038-.053-.038-.052-.038-.051-.039-.049-.039-.049-.039-.046-.039-.046-.04-.044-.04-.043-.04-.041-.04-.04-.041-.039-.041-.037-.041-.036-.041-.034-.041-.033-.042-.032-.042-.03-.042-.029-.042-.027-.042-.026-.043-.024-.043-.023-.043-.021-.043-.02-.043-.018-.044-.017-.043-.015-.044-.013-.044-.012-.044-.011-.045-.009-.044-.007-.045-.006-.045-.004-.045-.002-.045-.001-.045v-17l.001-.045.002-.045.004-.045.006-.045.007-.045.009-.044.011-.045.012-.044.013-.044.015-.044.017-.043.018-.044.02-.043.021-.043.023-.043.024-.043.026-.043.027-.042.029-.042.03-.042.032-.042.033-.042.034-.041.036-.041.037-.041.039-.041.04-.041.041-.04.043-.04.044-.04.046-.04.046-.039.049-.039.049-.039.051-.039.052-.038.053-.038.055-.038.056-.038.057-.037.058-.037.06-.037.061-.036.062-.036.063-.036.064-.036.066-.035.067-.035.068-.035.069-.035.07-.034.072-.034.072-.033.074-.033.151-.066.155-.064.159-.063.164-.061.167-.06.172-.059.176-.057.179-.056.184-.054.187-.053.19-.051.195-.05.198-.048.201-.046.204-.045.208-.043.211-.041.214-.04.217-.038.22-.036.223-.034.226-.032.228-.031.231-.028.234-.027.236-.024.238-.023.241-.02.243-.019.245-.016.247-.015.249-.012.251-.01.253-.008.255-.005.256-.004.258-.001.258.001zm-9.258 20.499v.01l.001.021.003.021.004.022.005.021.006.022.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.023.018.024.019.024.021.024.022.025.023.024.024.025.052.049.056.05.061.051.066.051.07.051.075.051.079.052.084.052.088.052.092.052.097.052.102.051.105.052.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.048.144.049.147.047.152.047.155.047.16.045.163.045.167.043.171.043.176.041.178.041.183.039.187.039.19.037.194.035.197.035.202.033.204.031.209.03.212.029.216.027.219.025.222.024.226.021.23.02.233.018.236.016.24.015.243.012.246.01.249.008.253.005.256.004.259.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.021.224-.024.22-.026.216-.027.212-.028.21-.031.205-.031.202-.034.198-.034.194-.036.191-.037.187-.039.183-.04.179-.04.175-.042.172-.043.168-.044.163-.045.16-.046.155-.046.152-.047.148-.048.143-.049.139-.049.136-.05.131-.05.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.053.083-.051.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.05.023-.024.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.023.01-.022.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.127l-.077.055-.08.053-.083.054-.085.053-.087.052-.09.052-.093.051-.095.05-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.045-.118.044-.12.043-.122.042-.124.042-.126.041-.128.04-.13.04-.132.038-.134.038-.135.037-.138.037-.139.035-.142.035-.143.034-.144.033-.147.032-.148.031-.15.03-.151.03-.153.029-.154.027-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.01-.179.008-.179.008-.181.006-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.006-.179-.008-.179-.008-.178-.01-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.027-.153-.029-.151-.03-.15-.03-.148-.031-.146-.032-.145-.033-.143-.034-.141-.035-.14-.035-.137-.037-.136-.037-.134-.038-.132-.038-.13-.04-.128-.04-.126-.041-.124-.042-.122-.042-.12-.044-.117-.043-.116-.045-.113-.045-.112-.046-.109-.047-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.05-.093-.052-.09-.051-.087-.052-.085-.053-.083-.054-.08-.054-.077-.054v4.127zm0-5.654v.011l.001.021.003.021.004.021.005.022.006.022.007.022.009.022.01.022.011.023.012.023.013.023.015.024.016.023.017.024.018.024.019.024.021.024.022.024.023.025.024.024.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.052.11.051.114.051.119.052.123.05.127.051.131.05.135.049.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.044.171.042.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.022.23.02.233.018.236.016.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.012.241-.015.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.048.139-.05.136-.049.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.051.051-.049.023-.025.023-.024.021-.025.02-.024.019-.024.018-.024.017-.024.015-.023.014-.023.013-.024.012-.022.01-.023.01-.023.008-.022.006-.022.006-.022.004-.021.004-.022.001-.021.001-.021v-4.139l-.077.054-.08.054-.083.054-.085.052-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.049-.105.048-.106.047-.109.047-.111.046-.114.045-.115.044-.118.044-.12.044-.122.042-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.035-.143.033-.144.033-.147.033-.148.031-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.025-.161.024-.162.023-.163.022-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.011-.178.009-.179.009-.179.007-.181.007-.182.005-.182.004-.184.003-.184.002h-.37l-.184-.002-.184-.003-.182-.004-.182-.005-.181-.007-.179-.007-.179-.009-.178-.009-.176-.011-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.022-.162-.023-.161-.024-.159-.025-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.031-.146-.033-.145-.033-.143-.033-.141-.035-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.04-.126-.041-.124-.042-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.047-.105-.048-.102-.049-.1-.049-.097-.05-.095-.051-.093-.051-.09-.051-.087-.053-.085-.052-.083-.054-.08-.054-.077-.054v4.139zm0-5.666v.011l.001.02.003.022.004.021.005.022.006.021.007.022.009.023.01.022.011.023.012.023.013.023.015.023.016.024.017.024.018.023.019.024.021.025.022.024.023.024.024.025.052.05.056.05.061.05.066.051.07.051.075.052.079.051.084.052.088.052.092.052.097.052.102.052.105.051.11.052.114.051.119.051.123.051.127.05.131.05.135.05.139.049.144.048.147.048.152.047.155.046.16.045.163.045.167.043.171.043.176.042.178.04.183.04.187.038.19.037.194.036.197.034.202.033.204.032.209.03.212.028.216.027.219.025.222.024.226.021.23.02.233.018.236.017.24.014.243.012.246.01.249.008.253.006.256.003.259.001.26-.001.257-.003.254-.006.25-.008.247-.01.244-.013.241-.014.237-.016.233-.018.231-.02.226-.022.224-.024.22-.025.216-.027.212-.029.21-.03.205-.032.202-.033.198-.035.194-.036.191-.037.187-.039.183-.039.179-.041.175-.042.172-.043.168-.044.163-.045.16-.045.155-.047.152-.047.148-.048.143-.049.139-.049.136-.049.131-.051.126-.05.123-.051.118-.052.114-.051.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.052.07-.051.065-.051.06-.051.056-.05.051-.049.023-.025.023-.025.021-.024.02-.024.019-.024.018-.024.017-.024.015-.023.014-.024.013-.023.012-.023.01-.022.01-.023.008-.022.006-.022.006-.022.004-.022.004-.021.001-.021.001-.021v-4.153l-.077.054-.08.054-.083.053-.085.053-.087.053-.09.051-.093.051-.095.051-.097.05-.1.049-.102.048-.105.048-.106.048-.109.046-.111.046-.114.046-.115.044-.118.044-.12.043-.122.043-.124.042-.126.041-.128.04-.13.039-.132.039-.134.038-.135.037-.138.036-.139.036-.142.034-.143.034-.144.033-.147.032-.148.032-.15.03-.151.03-.153.028-.154.028-.156.027-.158.026-.159.024-.161.024-.162.023-.163.023-.165.021-.166.02-.167.019-.169.018-.169.017-.171.016-.173.015-.173.014-.175.013-.175.012-.177.01-.178.01-.179.009-.179.007-.181.006-.182.006-.182.004-.184.003-.184.001-.185.001-.185-.001-.184-.001-.184-.003-.182-.004-.182-.006-.181-.006-.179-.007-.179-.009-.178-.01-.176-.01-.176-.012-.175-.013-.173-.014-.172-.015-.171-.016-.17-.017-.169-.018-.167-.019-.166-.02-.165-.021-.163-.023-.162-.023-.161-.024-.159-.024-.157-.026-.156-.027-.155-.028-.153-.028-.151-.03-.15-.03-.148-.032-.146-.032-.145-.033-.143-.034-.141-.034-.14-.036-.137-.036-.136-.037-.134-.038-.132-.039-.13-.039-.128-.041-.126-.041-.124-.041-.122-.043-.12-.043-.117-.044-.116-.044-.113-.046-.112-.046-.109-.046-.106-.048-.105-.048-.102-.048-.1-.05-.097-.049-.095-.051-.093-.051-.09-.052-.087-.052-.085-.053-.083-.053-.08-.054-.077-.054v4.153zm8.74-8.179l-.257.004-.254.005-.25.008-.247.011-.244.012-.241.014-.237.016-.233.018-.231.021-.226.022-.224.023-.22.026-.216.027-.212.028-.21.031-.205.032-.202.033-.198.034-.194.036-.191.038-.187.038-.183.04-.179.041-.175.042-.172.043-.168.043-.163.045-.16.046-.155.046-.152.048-.148.048-.143.048-.139.049-.136.05-.131.05-.126.051-.123.051-.118.051-.114.052-.11.052-.106.052-.101.052-.096.052-.092.052-.088.052-.083.052-.079.052-.074.051-.07.052-.065.051-.06.05-.056.05-.051.05-.023.025-.023.024-.021.024-.02.025-.019.024-.018.024-.017.023-.015.024-.014.023-.013.023-.012.023-.01.023-.01.022-.008.022-.006.023-.006.021-.004.022-.004.021-.001.021-.001.021.001.021.001.021.004.021.004.022.006.021.006.023.008.022.01.022.01.023.012.023.013.023.014.023.015.024.017.023.018.024.019.024.02.025.021.024.023.024.023.025.051.05.056.05.06.05.065.051.07.052.074.051.079.052.083.052.088.052.092.052.096.052.101.052.106.052.11.052.114.052.118.051.123.051.126.051.131.05.136.05.139.049.143.048.148.048.152.048.155.046.16.046.163.045.168.043.172.043.175.042.179.041.183.04.187.038.191.038.194.036.198.034.202.033.205.032.21.031.212.028.216.027.22.026.224.023.226.022.231.021.233.018.237.016.241.014.244.012.247.011.25.008.254.005.257.004.26.001.26-.001.257-.004.254-.005.25-.008.247-.011.244-.012.241-.014.237-.016.233-.018.231-.021.226-.022.224-.023.22-.026.216-.027.212-.028.21-.031.205-.032.202-.033.198-.034.194-.036.191-.038.187-.038.183-.04.179-.041.175-.042.172-.043.168-.043.163-.045.16-.046.155-.046.152-.048.148-.048.143-.048.139-.049.136-.05.131-.05.126-.051.123-.051.118-.051.114-.052.11-.052.106-.052.101-.052.096-.052.092-.052.088-.052.083-.052.079-.052.074-.051.07-.052.065-.051.06-.05.056-.05.051-.05.023-.025.023-.024.021-.024.02-.025.019-.024.018-.024.017-.023.015-.024.014-.023.013-.023.012-.023.01-.023.01-.022.008-.022.006-.023.006-.021.004-.022.004-.021.001-.021.001-.021-.001-.021-.001-.021-.004-.021-.004-.022-.006-.021-.006-.023-.008-.022-.01-.022-.01-.023-.012-.023-.013-.023-.014-.023-.015-.024-.017-.023-.018-.024-.019-.024-.02-.025-.021-.024-.023-.024-.023-.025-.051-.05-.056-.05-.06-.05-.065-.051-.07-.052-.074-.051-.079-.052-.083-.052-.088-.052-.092-.052-.096-.052-.101-.052-.106-.052-.11-.052-.114-.052-.118-.051-.123-.051-.126-.051-.131-.05-.136-.05-.139-.049-.143-.048-.148-.048-.152-.048-.155-.046-.16-.046-.163-.045-.168-.043-.172-.043-.175-.042-.179-.041-.183-.04-.187-.038-.191-.038-.194-.036-.198-.034-.202-.033-.205-.032-.21-.031-.212-.028-.216-.027-.22-.026-.224-.023-.226-.022-.231-.021-.233-.018-.237-.016-.241-.014-.244-.012-.247-.011-.25-.008-.254-.005-.257-.004-.26-.001-.26.001z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"symbol","properties":{"id":"clock","width":"24","height":"24"},"children":[{"type":"element","tagName":"path","properties":{"transform":"scale(.5)","d":"M12 2c5.514 0 10 4.486 10 10s-4.486 10-10 10-10-4.486-10-10 4.486-10 10-10zm0-2c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.848 12.459c.202.038.202.333.001.372-1.907.361-6.045 1.111-6.547 1.111-.719 0-1.301-.582-1.301-1.301 0-.512.77-5.447 1.125-7.445.034-.192.312-.181.343.014l.985 6.238 5.394 1.011z"},"children":[]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"line","properties":{"id":"actor0","x1":"75","y1":"5","x2":"75","y2":"249","className":["200"],"strokeWidth":"0.5px","stroke":"#999"},"children":[]},{"type":"element","tagName":"g","properties":{"id":"root-0"},"children":[{"type":"element","tagName":"rect","properties":{"x":"0","y":"0","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"75","y":"32.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"75","dy":"0"},"children":[{"type":"text","value":"客户端"}]}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"line","properties":{"id":"actor1","x1":"335","y1":"5","x2":"335","y2":"249","className":["200"],"strokeWidth":"0.5px","stroke":"#999"},"children":[]},{"type":"element","tagName":"g","properties":{"id":"root-1"},"children":[{"type":"element","tagName":"rect","properties":{"x":"260","y":"0","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"335","y":"32.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"335","dy":"0"},"children":[{"type":"text","value":"短链服务器"}]}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"line","properties":{"id":"actor2","x1":"535","y1":"5","x2":"535","y2":"249","className":["200"],"strokeWidth":"0.5px","stroke":"#999"},"children":[]},{"type":"element","tagName":"g","properties":{"id":"root-2"},"children":[{"type":"element","tagName":"rect","properties":{"x":"460","y":"0","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"535","y":"32.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"535","dy":"0"},"children":[{"type":"text","value":"B服务器"}]}]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead","refX":"9","refY":"5","markerUnits":"userSpaceOnUse","markerWidth":"12","markerHeight":"12","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"crosshead","markerWidth":"15","markerHeight":"8","orient":"auto","refX":"16","refY":"4"},"children":[{"type":"element","tagName":"path","properties":{"fill":"black","stroke":"#000000","strokeWidth":"1px","d":"M 9,2 V 6 L16,4 Z","style":"stroke-dasharray: 0, 0;"},"children":[]},{"type":"element","tagName":"path","properties":{"fill":"none","stroke":"#000000","strokeWidth":"1px","d":"M 0,1 L 6,7 M 6,1 L 0,7","style":"stroke-dasharray: 0, 0;"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"filled-head","refX":"18","refY":"7","markerWidth":"20","markerHeight":"28","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 18,7 L9,13 L14,7 L9,1 Z"},"children":[]}]}]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"sequencenumber","refX":"15","refY":"15","markerWidth":"60","markerHeight":"40","orient":"auto"},"children":[{"type":"element","tagName":"circle","properties":{"cx":"15","cy":"15","r":"6"},"children":[]}]}]},{"type":"element","tagName":"text","properties":{"x":"205","y":"80","textAnchor":"middle","dominantBaseline":"middle","alignmentBaseline":"middle","className":["messageText"],"dy":"1em","style":"font-family: \"trebuchet ms\", verdana, arial, sans-serif; font-size: 16px; font-weight: 400;"},"children":[{"type":"text","value":"访问A"}]},{"type":"element","tagName":"line","properties":{"x1":"75","y1":"113","x2":"335","y2":"113","className":["messageLine0"],"strokeWidth":"2","stroke":"none","markerEnd":"url(#arrowhead)","style":"fill: none;"},"children":[]},{"type":"element","tagName":"text","properties":{"x":"205","y":"128","textAnchor":"middle","dominantBaseline":"middle","alignmentBaseline":"middle","className":["messageText"],"dy":"1em","style":"font-family: \"trebuchet ms\", verdana, arial, sans-serif; font-size: 16px; font-weight: 400;"},"children":[{"type":"text","value":"status code:302  location:B"}]},{"type":"element","tagName":"line","properties":{"x1":"335","y1":"161","x2":"75","y2":"161","className":["messageLine0"],"strokeWidth":"2","stroke":"none","markerEnd":"url(#arrowhead)","style":"fill: none;"},"children":[]},{"type":"element","tagName":"text","properties":{"x":"305","y":"176","textAnchor":"middle","dominantBaseline":"middle","alignmentBaseline":"middle","className":["messageText"],"dy":"1em","style":"font-family: \"trebuchet ms\", verdana, arial, sans-serif; font-size: 16px; font-weight: 400;"},"children":[{"type":"text","value":"访问B"}]},{"type":"element","tagName":"line","properties":{"x1":"75","y1":"209","x2":"535","y2":"209","className":["messageLine0"],"strokeWidth":"2","stroke":"none","markerEnd":"url(#arrowhead)","style":"fill: none;"},"children":[]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"rect","properties":{"x":"0","y":"229","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"75","y":"261.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"75","dy":"0"},"children":[{"type":"text","value":"客户端"}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"rect","properties":{"x":"260","y":"229","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"335","y":"261.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"335","dy":"0"},"children":[{"type":"text","value":"短链服务器"}]}]}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"rect","properties":{"x":"460","y":"229","fill":"#eaeaea","stroke":"#666","width":"150","height":"65","rx":"3","ry":"3","className":["actor"]},"children":[]},{"type":"element","tagName":"text","properties":{"x":"535","y":"261.5","dominantBaseline":"central","alignmentBaseline":"central","className":["actor"],"style":"text-anchor: middle; font-size: 14px; font-weight: 400; font-family: Open-Sans, \"sans-serif\";"},"children":[{"type":"element","tagName":"tspan","properties":{"x":"535","dy":"0"},"children":[{"type":"text","value":"B服务器"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　Http协议中重定向有两种code: 301 、302"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"301: 代表永久"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"重定向"}]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"302: 代表"},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"临时重定向"}]},{"type":"text","value":"。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　他们的区别就在于浏览器会对301做缓存的效果，如果返回的code是301，则浏览器缓存A到B的映射，在下次发起请求的时候不会再去请求A的服务器。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"概述用例和约束"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":" 输入一段文本，然后得到一个随机生成的链接"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"过期设置"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"默认的设置是不会过期的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"可以选择设置一个过期的时间"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":" 输入一个 paste 的 url 后，可以看到它存储的内容"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":" 是匿名的"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":" 跟踪页面分析"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"一个月的访问统计"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":" 删除过期的 pastes"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Service"}]},{"type":"text","value":" 需要高可用"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"约束和假设"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"访问流量不是均匀分布的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"打开一个短链接应该是很快的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"pastes 只能是文本"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"页面访问分析数据可以不用实时"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"一千万的用户量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每个月一千万的 paste 写入量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每个月一亿的 paste 读取量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"读写比例在 10:1"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"预估容量"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"每个 paste 的大小"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"每一个 paste 1 KB"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"shortlink"}]},{"type":"text","value":" - 7 bytes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"expiration_length_in_minutes"}]},{"type":"text","value":" - 4 bytes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"created_at"}]},{"type":"text","value":" - 5 bytes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"总共 = ~1.27 KB"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"每个月新的 paste 内容在 12.7GB"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"(1.27 * 10000000)KB / 月的 paste"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"三年内将近 450GB 的新 paste 内容"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"三年内 3.6 亿短链接"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"假设大部分都是新的 paste，而不是需要更新已存在的 paste"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"平均 4paste/s 的写入速度"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"平均 40paste/s 的读取速度"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"创建一个高层次设计"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　用webServer作为请求的入口，然后调用API去访问SQL。最后采用Analytics对请求数据进行分析。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659665713332","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"324","style":"max-width: 359.515625px;","viewBox":"0 0 359.515625 324"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659665713332 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659665713332 .error-icon{fill:#552222;}#mermaid-1659665713332 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659665713332 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659665713332 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659665713332 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659665713332 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659665713332 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659665713332 .marker{fill:#333333;stroke:#333333;}#mermaid-1659665713332 .marker.cross{stroke:#333333;}#mermaid-1659665713332 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659665713332 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659665713332 .cluster-label text{fill:#333;}#mermaid-1659665713332 .cluster-label span{color:#333;}#mermaid-1659665713332 .label text,#mermaid-1659665713332 span{fill:#333;color:#333;}#mermaid-1659665713332 .node rect,#mermaid-1659665713332 .node circle,#mermaid-1659665713332 .node ellipse,#mermaid-1659665713332 .node polygon,#mermaid-1659665713332 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659665713332 .node .label{text-align:center;}#mermaid-1659665713332 .node.clickable{cursor:pointer;}#mermaid-1659665713332 .arrowheadPath{fill:#333333;}#mermaid-1659665713332 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659665713332 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659665713332 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659665713332 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659665713332 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659665713332 .cluster text{fill:#333;}#mermaid-1659665713332 .cluster span{color:#333;}#mermaid-1659665713332 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659665713332 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-客户端","LE-WebServer"],"id":"L-客户端-WebServer","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M111.515625,50.5L111.515625,54.666666666666664C111.515625,58.833333333333336,111.515625,67.16666666666667,111.515625,75.5C111.515625,83.83333333333333,111.515625,92.16666666666667,111.515625,96.33333333333333L111.515625,100.5","markerEnd":"url(#arrowhead20)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead20","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-WriteAPI"],"id":"L-WebServer-WriteAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M139.68540342514123,139L145.7827580626177,143.16666666666666C151.88011270009414,147.33333333333334,164.07482197504706,155.66666666666666,170.17217661252354,164C176.26953125,172.33333333333334,176.26953125,180.66666666666666,176.26953125,184.83333333333334L176.26953125,189","markerEnd":"url(#arrowhead21)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead21","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-ReadAPI"],"id":"L-WebServer-ReadAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M83.34584657485875,139L77.2484919373823,143.16666666666666C71.15113729990584,147.33333333333334,58.95642802495291,155.66666666666666,52.85907338747646,164C46.76171875,172.33333333333334,46.76171875,180.66666666666666,46.76171875,184.83333333333334L46.76171875,189","markerEnd":"url(#arrowhead22)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead22","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-ReadAPI","LE-SQL"],"id":"L-ReadAPI-SQL","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M46.76171875,227.5L46.76171875,231.66666666666666C46.76171875,235.83333333333334,46.76171875,244.16666666666666,64.46223958333333,254.38121594176673C82.16276041666667,264.59576521686677,117.56380208333333,276.6915304337335,135.26432291666666,282.73941304216686L152.96484375,288.78729565060024","markerEnd":"url(#arrowhead23)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead23","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WriteAPI","LE-SQL"],"id":"L-WriteAPI-SQL","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M176.26953125,227.5L176.26953125,231.66666666666666C176.26953125,235.83333333333334,176.26953125,244.16666666666666,176.26953125,252.5C176.26953125,260.8333333333333,176.26953125,269.1666666666667,176.26953125,273.3333333333333L176.26953125,277.5","markerEnd":"url(#arrowhead24)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead24","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Analytics","LE-SQL"],"id":"L-Analytics-SQL","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M309.265625,227.5L309.265625,231.66666666666666C309.265625,235.83333333333334,309.265625,244.16666666666666,290.9837239583333,254.41602417246747C272.7018229166667,264.66538167826826,236.13802083333334,276.8307633565366,217.85611979166666,282.9134541956707L199.57421875,288.99614503480484","markerEnd":"url(#arrowhead25)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead25","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-客户端-WebServer","className":["edgeLabel","L-LS-客户端'","L-LE-WebServer"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-WriteAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-WriteAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-ReadAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-ReadAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-ReadAPI-SQL","className":["edgeLabel","L-LS-ReadAPI'","L-LE-SQL"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WriteAPI-SQL","className":["edgeLabel","L-LS-WriteAPI'","L-LE-SQL"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Analytics-SQL","className":["edgeLabel","L-LS-Analytics'","L-LE-SQL"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-客户端-12","transform":"translate(111.515625,29.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-34","y":"-21.25","width":"68","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-24,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"48","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"客户端"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WebServer-13","transform":"translate(111.515625,119.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-47.98046875","y":"-19.25","width":"95.9609375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-37.98046875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"75.9609375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WebServer"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WriteAPI-15","transform":"translate(176.26953125,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-40.74609375","y":"-19.25","width":"81.4921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-30.74609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"61.4921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WriteAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-ReadAPI-17","transform":"translate(46.76171875,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-38.76171875","y":"-19.25","width":"77.5234375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-28.76171875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"57.5234375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"ReadAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQL-19","transform":"translate(176.26953125,296.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-23.3046875","y":"-19.25","width":"46.609375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-13.3046875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"26.609375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQL"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-Analytics-22","transform":"translate(309.265625,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-42.25","y":"-19.25","width":"84.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-32.25,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"64.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"Analytics"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"设计核心组件"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例: "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"用户"}]},{"type":"text","value":"输入一段文本，然后得到一个随机生成的链接"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　用关系型数据库直接将生成的URL映射成用户的URL。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"客户端"}]},{"type":"text","value":" 发送一个创建 paste 的请求到作为一个"},{"type":"element","tagName":"a","properties":{"href":"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8"},"children":[{"type":"text","value":"反向代理"}]},{"type":"text","value":"启动的  "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web 服务器"}]},{"type":"text","value":" 。"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web 服务器"}]},{"type":"text","value":" 转发请求给 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"写接口"}]},{"type":"text","value":" 服务器"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"写接口"}]},{"type":"text","value":" 服务器执行如下操作："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"生成一个唯一的 url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"检查这个 url 在 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 里面是否是唯一的"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果这个 url 不是唯一的，生成另外一个 url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果我们支持自定义 url，我们可以使用用户提供的 url（也需要检查是否重复）"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"把生成的 url 和用户的url 存储到 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 的 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pastes"}]},{"type":"text","value":" 表里面"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"返回生成的 url"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"pastes"}]},{"type":"text","value":"结构如下:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"pre","properties":{"className":["grvsc-container","dark-default-dark"],"dataLanguage":"sql","dataIndex":"0"},"children":[{"type":"element","tagName":"code","properties":{"className":["grvsc-code"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"shortlink "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"char"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"7"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"expiration_length_in_minutes "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"int"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"created_at "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"datetime"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"paste "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"varchar"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"("}]},{"type":"element","tagName":"span","properties":{"className":["mtk7"]},"children":[{"type":"text","value":"2048"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":") "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NOT"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"NULL"}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"span","properties":{"className":["grvsc-line"]},"children":[{"type":"element","tagName":"span","properties":{"className":["grvsc-source"]},"children":[{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"PRIMARY"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":" "}]},{"type":"element","tagName":"span","properties":{"className":["mtk4"]},"children":[{"type":"text","value":"KEY"}]},{"type":"element","tagName":"span","properties":{"className":["mtk1"]},"children":[{"type":"text","value":"(shortlink)"}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　在"},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"shortlink"}]},{"type":"text","value":"上创建一个数据库索引，用来提高查询的速度。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例：用户输入一个 paste 的 url 后可以看到它存储的内容"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"客户端"}]},{"type":"text","value":" 发送一个获取 paste 请求到 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web Server"}]}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web Server"}]},{"type":"text","value":" 转发请求给 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"读取接口"}]},{"type":"text","value":" 服务器"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"读取接口"}]},{"type":"text","value":" 服务器执行如下操作："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"在 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 检查这个生成的 url"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"如果这个 url 在 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 里面，则从返回这个 "},{"type":"element","tagName":"code","properties":{},"children":[{"type":"text","value":"paste"}]},{"type":"text","value":" 的内容"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"否则，返回一个错误页面给用户"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例： 服务跟踪分析页面"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　因为实时分析不是必须的，所以我们可以简单的 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"MapReduce"}]},{"type":"text","value":" "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Web Server"}]},{"type":"text","value":" 的日志，用来生成点击次数。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{},"children":[{"type":"text","value":"用例： 服务删除过期的 pastes"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　为了删除过期的 pastes，我们可以直接搜索 "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"SQL 数据库"}]},{"type":"text","value":" 中所有的过期时间比当前时间更早的记录， 所有过期的记录将从这张表里面删除（或者将其标记为过期）。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"扩展设计"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"div","properties":{"className":["mermaid"],"dataProcessed":"true"},"children":[{"type":"element","tagName":"svg","properties":{"id":"mermaid-1659665713333","width":"100%","xmlns":"http://www.w3.org/2000/svg","xmlnsXLink":"http://www.w3.org/1999/xlink","height":"589.5","style":"max-width: 445.16796875px;","viewBox":"0 0 445.16796875 589.5"},"children":[{"type":"element","tagName":"style","properties":{},"children":[{"type":"text","value":"#mermaid-1659665713333 {font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1659665713333 .error-icon{fill:#552222;}#mermaid-1659665713333 .error-text{fill:#552222;stroke:#552222;}#mermaid-1659665713333 .edge-thickness-normal{stroke-width:2px;}#mermaid-1659665713333 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1659665713333 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1659665713333 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1659665713333 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1659665713333 .marker{fill:#333333;stroke:#333333;}#mermaid-1659665713333 .marker.cross{stroke:#333333;}#mermaid-1659665713333 svg{font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:16px;}#mermaid-1659665713333 .label{font-family:\"trebuchet ms\",verdana,arial,sans-serif;color:#333;}#mermaid-1659665713333 .cluster-label text{fill:#333;}#mermaid-1659665713333 .cluster-label span{color:#333;}#mermaid-1659665713333 .label text,#mermaid-1659665713333 span{fill:#333;color:#333;}#mermaid-1659665713333 .node rect,#mermaid-1659665713333 .node circle,#mermaid-1659665713333 .node ellipse,#mermaid-1659665713333 .node polygon,#mermaid-1659665713333 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1659665713333 .node .label{text-align:center;}#mermaid-1659665713333 .node.clickable{cursor:pointer;}#mermaid-1659665713333 .arrowheadPath{fill:#333333;}#mermaid-1659665713333 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1659665713333 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1659665713333 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1659665713333 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1659665713333 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1659665713333 .cluster text{fill:#333;}#mermaid-1659665713333 .cluster span{color:#333;}#mermaid-1659665713333 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:\"trebuchet ms\",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1659665713333 :root{--mermaid-font-family:\"trebuchet ms\",verdana,arial,sans-serif;}"}]},{"type":"element","tagName":"g","properties":{},"children":[{"type":"element","tagName":"g","properties":{"className":["output"]},"children":[{"type":"element","tagName":"g","properties":{"className":["clusters"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["edgePaths"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Client","LE-DNS负载"],"id":"L-Client-DNS负载","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M108.51842778954803,46.5L103.40793461629004,50.666666666666664C98.29744144303201,54.833333333333336,88.076455096516,63.166666666666664,82.965961923258,71.5C77.85546875,79.83333333333333,77.85546875,88.16666666666667,77.85546875,92.33333333333333L77.85546875,96.5","markerEnd":"url(#arrowhead40)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead40","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Client","LE-CDN回源"],"id":"L-Client-CDN回源","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M163.4609375,45.401235041423746L170.96940104166666,49.75102920118646C178.47786458333334,54.100823360949164,193.49479166666666,62.80041168047458,201.00325520833334,71.31687250690396C208.51171875,79.83333333333333,208.51171875,88.16666666666667,208.51171875,92.33333333333333L208.51171875,96.5","markerEnd":"url(#arrowhead41)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead41","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-DNS负载","LE-LoadBalancer"],"id":"L-DNS负载-LoadBalancer","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M77.85546875,139L77.85546875,143.16666666666666C77.85546875,147.33333333333334,77.85546875,155.66666666666666,77.85546875,164C77.85546875,172.33333333333334,77.85546875,180.66666666666666,77.85546875,184.83333333333334L77.85546875,189","markerEnd":"url(#arrowhead42)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead42","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-LoadBalancer","LE-WebServer"],"id":"L-LoadBalancer-WebServer","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M77.85546875,227.5L77.85546875,231.66666666666666C77.85546875,235.83333333333334,77.85546875,244.16666666666666,77.85546875,252.5C77.85546875,260.8333333333333,77.85546875,269.1666666666667,77.85546875,273.3333333333333L77.85546875,277.5","markerEnd":"url(#arrowhead43)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead43","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-WriteAPI"],"id":"L-WebServer-WriteAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M125.8359375,310.23390557939916L144.08203125,315.36158798283265C162.328125,320.4892703862661,198.8203125,330.74463519313304,217.06640625,340.0389842632332C235.3125,349.3333333333333,235.3125,357.6666666666667,235.3125,361.8333333333333L235.3125,366","markerEnd":"url(#arrowhead44)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead44","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WebServer","LE-ReadAPI"],"id":"L-WebServer-ReadAPI","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M77.85546875,316L77.85546875,320.1666666666667C77.85546875,324.3333333333333,77.85546875,332.6666666666667,77.85546875,344.2083333333333C77.85546875,355.75,77.85546875,370.5,77.85546875,385.25C77.85546875,400,77.85546875,414.75,77.85546875,426.2916666666667C77.85546875,437.8333333333333,77.85546875,446.1666666666667,77.85546875,450.3333333333333L77.85546875,454.5","markerEnd":"url(#arrowhead45)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead45","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-ReadAPI","LE-MemoryCache"],"id":"L-ReadAPI-MemoryCache","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M116.6171875,483.3019317366051L140.08463541666666,489.0849431138376C163.55208333333334,494.8679544910701,210.48697916666666,506.43397724553506,233.95442708333334,516.3836552894342C257.421875,526.3333333333334,257.421875,534.6666666666666,257.421875,538.8333333333334L257.421875,543","markerEnd":"url(#arrowhead46)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead46","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-WriteAPI","LE-SQLMaster-Slave"],"id":"L-WriteAPI-SQLMaster-Slave","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M235.3125,404.5L235.3125,408.6666666666667C235.3125,412.8333333333333,235.3125,421.1666666666667,235.3125,429.5C235.3125,437.8333333333333,235.3125,446.1666666666667,235.3125,450.3333333333333L235.3125,454.5","markerEnd":"url(#arrowhead47)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead47","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-ReadAPI","LE-SQLReadReplicas"],"id":"L-ReadAPI-SQLReadReplicas","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M56.570522157485875,493L51.9633908604049,497.1666666666667C47.35625956332391,501.3333333333333,38.14199696916196,509.6666666666667,38.14199696916196,518C38.14199696916196,526.3333333333334,47.35625956332391,534.6666666666666,51.9633908604049,538.8333333333334L56.570522157485875,543","markerEnd":"url(#arrowhead48)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead48","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-SQLMaster-Slave","LE-SQLReadReplicas"],"id":"L-SQLMaster-Slave-SQLReadReplicas","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M228.07675670903956,493L226.51057850753295,497.1666666666667C224.94440030602638,501.3333333333333,221.81204390301318,509.6666666666667,206.98558145009414,518C192.15911899717514,526.3333333333334,165.63855049435028,534.6666666666666,152.37826624293785,538.8333333333334L139.11798199152543,543","markerEnd":"url(#arrowhead49)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead49","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 0 0 L 0 0 z","style":"fill: #333"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-Analytics","LE-SQLAnalytics"],"id":"L-Analytics-SQLAnalytics","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M381.61328125,316L381.61328125,320.1666666666667C381.61328125,324.3333333333333,381.61328125,332.6666666666667,381.61328125,341C381.61328125,349.3333333333333,381.61328125,357.6666666666667,381.61328125,361.8333333333333L381.61328125,366","markerEnd":"url(#arrowhead50)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead50","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgePath","LS-SQLAnalytics","LE-SQLMaster-Slave"],"id":"L-SQLAnalytics-SQLMaster-Slave","style":"opacity: 1;"},"children":[{"type":"element","tagName":"path","properties":{"className":["path"],"d":"M381.61328125,404.5L381.61328125,408.6666666666667C381.61328125,412.8333333333333,381.61328125,421.1666666666667,367.83731314736343,429.5C354.0613450447269,437.8333333333333,326.5094088394539,446.1666666666667,312.73344073681733,450.3333333333333L298.9574726341808,454.5","markerEnd":"url(#arrowhead51)","style":"fill:none"},"children":[]},{"type":"element","tagName":"defs","properties":{},"children":[{"type":"element","tagName":"marker","properties":{"id":"arrowhead51","viewBox":"0 0 10 10","refX":"9","refY":"5","markerUnits":"strokeWidth","markerWidth":"8","markerHeight":"6","orient":"auto"},"children":[{"type":"element","tagName":"path","properties":{"d":"M 0 0 L 10 5 L 0 10 z","className":["arrowheadPath"],"style":"stroke-width: 1; stroke-dasharray: 1, 0;"},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabels"]},"children":[{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Client-DNS负载","className":["edgeLabel","L-LS-Client'","L-LE-DNS负载"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Client-CDN回源","className":["edgeLabel","L-LS-Client'","L-LE-CDN回源"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-DNS负载-LoadBalancer","className":["edgeLabel","L-LS-DNS负载'","L-LE-LoadBalancer"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-LoadBalancer-WebServer","className":["edgeLabel","L-LS-LoadBalancer'","L-LE-WebServer"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-WriteAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-WriteAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WebServer-ReadAPI","className":["edgeLabel","L-LS-WebServer'","L-LE-ReadAPI"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-ReadAPI-MemoryCache","className":["edgeLabel","L-LS-ReadAPI'","L-LE-MemoryCache"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-WriteAPI-SQLMaster-Slave","className":["edgeLabel","L-LS-WriteAPI'","L-LE-SQLMaster-Slave"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-ReadAPI-SQLReadReplicas","className":["edgeLabel","L-LS-ReadAPI'","L-LE-SQLReadReplicas"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-SQLMaster-Slave-SQLReadReplicas","className":["edgeLabel","L-LS-SQLMaster-Slave'","L-LE-SQLReadReplicas"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-Analytics-SQLAnalytics","className":["edgeLabel","L-LS-Analytics'","L-LE-SQLAnalytics"]},"children":[]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["edgeLabel"],"transform":"","style":"opacity: 1;"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(0,0)","className":["label"]},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","width":"0","height":"0"},"children":[]},{"type":"element","tagName":"foreignObject","properties":{"width":"0","height":"0"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"element","tagName":"span","properties":{"id":"L-L-SQLAnalytics-SQLMaster-Slave","className":["edgeLabel","L-LS-SQLAnalytics'","L-LE-SQLMaster-Slave"]},"children":[]}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["nodes"]},"children":[{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-Client-24","transform":"translate(132.12890625,27.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-31.33203125","y":"-19.25","width":"62.6640625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-21.33203125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"42.6640625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"Client"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-DNS负载-25","transform":"translate(77.85546875,117.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-39.859375","y":"-21.25","width":"79.71875","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-29.859375,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"59.71875","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"DNS负载"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-CDN回源-27","transform":"translate(208.51171875,117.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-40.796875","y":"-21.25","width":"81.59375","height":"42.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-30.796875,-11.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"61.59375","height":"22.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"CDN回源"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-LoadBalancer-29","transform":"translate(77.85546875,208.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-58.1015625","y":"-19.25","width":"116.203125","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-48.1015625,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"96.203125","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"LoadBalancer"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WebServer-31","transform":"translate(77.85546875,296.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-47.98046875","y":"-19.25","width":"95.9609375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-37.98046875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"75.9609375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WebServer"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-WriteAPI-33","transform":"translate(235.3125,385.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-40.74609375","y":"-19.25","width":"81.4921875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-30.74609375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"61.4921875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"WriteAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-ReadAPI-35","transform":"translate(77.85546875,473.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-38.76171875","y":"-19.25","width":"77.5234375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-28.76171875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"57.5234375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"ReadAPI"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-MemoryCache-37","transform":"translate(257.421875,562.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-59.7109375","y":"-19.25","width":"119.421875","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-49.7109375,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"99.421875","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"MemoryCache"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQLMaster-Slave-39","transform":"translate(235.3125,473.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-68.6953125","y":"-19.25","width":"137.390625","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-58.6953125,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"117.390625","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQLMaster-Slave"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQLReadReplicas-41","transform":"translate(77.85546875,562.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-69.85546875","y":"-19.25","width":"139.7109375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-59.85546875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"119.7109375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQLReadReplicas"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-Analytics-44","transform":"translate(381.61328125,296.75)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-42.25","y":"-19.25","width":"84.5","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-32.25,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"64.5","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"Analytics"}]}]}]}]}]},{"type":"element","tagName":"g","properties":{"className":["node","default"],"id":"flowchart-SQLAnalytics-45","transform":"translate(381.61328125,385.25)","style":"opacity: 1;"},"children":[{"type":"element","tagName":"rect","properties":{"rx":"0","ry":"0","x":"-55.5546875","y":"-19.25","width":"111.109375","height":"38.5","className":["label-container"]},"children":[]},{"type":"element","tagName":"g","properties":{"className":["label"],"transform":"translate(0,0)"},"children":[{"type":"element","tagName":"g","properties":{"transform":"translate(-45.5546875,-9.25)"},"children":[{"type":"element","tagName":"foreignObject","properties":{"width":"91.109375","height":"18.5"},"children":[{"type":"element","tagName":"div","properties":{"xmlns":"http://www.w3.org/1999/xhtml","style":"display: inline-block; white-space: nowrap;"},"children":[{"type":"text","value":"SQLAnalytics"}]}]}]}]}]}]}]}]}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"对于请求量比较大的，应该将数据留在上游，这部分可以采用CDN来代理源站，将数据放在边缘"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"使用LoadBalancer来代理我们具体的服务器，以便于可以对webServer进行水平扩展"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"处理每秒40的读请求，其内容应该交由给内存级别的缓存来处理。比如Redis这种"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"对于单个关系型数据库，主从切分之后每秒4次的写入问题不大。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"如果写入出现了瓶颈，需要额外采用别的方式。包括但不限于："}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"水平、垂直分片"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"非规范化"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"SQL调优"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h1","properties":{},"children":[{"type":"text","value":"总结"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　对于短链系统，整体的系统的设计大概如此，从架构方面应该是满足要求了。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　其次，还有一些细节在我看来就是属于业务上的东西了，需要自行衡量,比如: 短链生成方法有好几种方式，Hash、Md5、UUID、redis、Snowflake、Mysql 自增主键。其选型并没有什么优劣之分，只有合适与否。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　整个系统的诞生是一个不断优化的过程，我们需要先解决有的问题，再持续进行优化。"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"继续对系统进行基准测试和监控，以在瓶颈出现时解决它们"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"扩展是一个迭代的过程"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"　　"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"style","properties":{"className":["grvsc-styles"]},"children":[{"type":"text","value":"\n  .grvsc-container {\n    overflow: auto;\n    position: relative;\n    -webkit-overflow-scrolling: touch;\n    padding-top: 1rem;\n    padding-top: var(--grvsc-padding-top, var(--grvsc-padding-v, 1rem));\n    padding-bottom: 1rem;\n    padding-bottom: var(--grvsc-padding-bottom, var(--grvsc-padding-v, 1rem));\n    border-radius: 8px;\n    border-radius: var(--grvsc-border-radius, 8px);\n    font-feature-settings: normal;\n    line-height: 1.4;\n  }\n  \n  .grvsc-code {\n    display: table;\n  }\n  \n  .grvsc-line {\n    display: table-row;\n    box-sizing: border-box;\n    width: 100%;\n    position: relative;\n  }\n  \n  .grvsc-line > * {\n    position: relative;\n  }\n  \n  .grvsc-gutter-pad {\n    display: table-cell;\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  .grvsc-gutter {\n    display: table-cell;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter::before {\n    content: attr(data-content);\n  }\n  \n  .grvsc-source {\n    display: table-cell;\n    padding-left: 1.5rem;\n    padding-left: var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem));\n    padding-right: 1.5rem;\n    padding-right: var(--grvsc-padding-right, var(--grvsc-padding-h, 1.5rem));\n  }\n  \n  .grvsc-source:empty::after {\n    content: ' ';\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    user-select: none;\n  }\n  \n  .grvsc-gutter + .grvsc-source {\n    padding-left: 0.75rem;\n    padding-left: calc(var(--grvsc-padding-left, var(--grvsc-padding-h, 1.5rem)) / 2);\n  }\n  \n  /* Line transformer styles */\n  \n  .grvsc-has-line-highlighting > .grvsc-code > .grvsc-line::before {\n    content: ' ';\n    position: absolute;\n    width: 100%;\n  }\n  \n  .grvsc-line-diff-add::before {\n    background-color: var(--grvsc-line-diff-add-background-color, rgba(0, 255, 60, 0.2));\n  }\n  \n  .grvsc-line-diff-del::before {\n    background-color: var(--grvsc-line-diff-del-background-color, rgba(255, 0, 20, 0.2));\n  }\n  \n  .grvsc-line-number {\n    padding: 0 2px;\n    text-align: right;\n    opacity: 0.7;\n  }\n  \n  .dark-default-dark {\n    background-color: #1E1E1E;\n    color: #D4D4D4;\n  }\n  .dark-default-dark .mtk1 { color: #D4D4D4; }\n  .dark-default-dark .mtk4 { color: #569CD6; }\n  .dark-default-dark .mtk7 { color: #B5CEA8; }\n  .dark-default-dark .grvsc-line-highlighted::before {\n    background-color: var(--grvsc-line-highlighted-background-color, rgba(255, 255, 255, 0.1));\n    box-shadow: inset var(--grvsc-line-highlighted-border-width, 4px) 0 0 0 var(--grvsc-line-highlighted-border-color, rgba(255, 255, 255, 0.5));\n  }\n"}]}],"data":{"quirksMode":false}},"html":"<p updated=\"20220805101449\">　　a短链系统设计看起来简单，但是每个点都能展开很多知识点。短链是通过访问服务器上的链接，通过Http返回的302Code，对链接进行重定向，然后访问到对应的地址上。</p>\n<div data-content=\"sequenceDiagram\n    客户端-&amp;gt;&amp;gt;短链服务器: 访问A\n    短链服务器-&amp;gt;&amp;gt;客户端: status code:302  location:B\n    客户端 -&amp;gt;&amp;gt; B服务器: 访问B\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<p updated=\"20220805101449\">　　Http协议中重定向有两种code: 301 、302</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-f7hylyq\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">301: 代表永久<strong>重定向</strong>。</p>\n</li>\n<li id=\"20220805101449-35th3n6\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">302: 代表<strong>临时重定向</strong>。</p>\n</li>\n</ul>\n<p updated=\"20220805101449\">　　他们的区别就在于浏览器会对301做缓存的效果，如果返回的code是301，则浏览器缓存A到B的映射，在下次发起请求的时候不会再去请求A的服务器。</p>\n<h1 id=\"概述用例和约束\">概述用例和约束</h1>\n<h2 id=\"用例\">用例</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-b942l6m\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>用户</strong> 输入一段文本，然后得到一个随机生成的链接</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-w112n9u\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">过期设置</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-u6948li\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">默认的设置是不会过期的</p>\n</li>\n<li id=\"20220805101449-19phlkd\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">可以选择设置一个过期的时间</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-xc04f4p\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>用户</strong> 输入一个 paste 的 url 后，可以看到它存储的内容</p>\n</li>\n<li id=\"20220805101449-9cfgydy\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>用户</strong> 是匿名的</p>\n</li>\n<li id=\"20220805101449-583sn2t\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Service</strong> 跟踪页面分析</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-9gw54as\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">一个月的访问统计</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-ex3160s\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Service</strong> 删除过期的 pastes</p>\n</li>\n<li id=\"20220805101449-gms7hj2\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Service</strong> 需要高可用</p>\n</li>\n</ul>\n<h2 id=\"约束和假设\">约束和假设</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-g1sk3iq\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">访问流量不是均匀分布的</p>\n</li>\n<li id=\"20220805101449-joo77cz\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">打开一个短链接应该是很快的</p>\n</li>\n<li id=\"20220805101449-z1s551i\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">pastes 只能是文本</p>\n</li>\n<li id=\"20220805101449-fqivp97\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">页面访问分析数据可以不用实时</p>\n</li>\n<li id=\"20220805101449-k7c7kgo\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">一千万的用户量</p>\n</li>\n<li id=\"20220805101449-e5uo30b\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个月一千万的 paste 写入量</p>\n</li>\n<li id=\"20220805101449-3svayds\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个月一亿的 paste 读取量</p>\n</li>\n<li id=\"20220805101449-dapyl1w\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">读写比例在 10:1</p>\n</li>\n</ul>\n<h2 id=\"预估容量\">预估容量</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-6gtyime\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个 paste 的大小</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-vo1i9vt\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每一个 paste 1 KB</p>\n</li>\n<li id=\"20220805101449-c3nrl7s\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><code>shortlink</code> - 7 bytes</p>\n</li>\n<li id=\"20220805101449-89zy5we\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><code>expiration_length_in_minutes</code> - 4 bytes</p>\n</li>\n<li id=\"20220805101449-cliki2v\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><code>created_at</code> - 5 bytes</p>\n</li>\n<li id=\"20220805101449-oqapqz3\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">总共 = ~1.27 KB</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-gqkc75u\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">每个月新的 paste 内容在 12.7GB</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-8ccxh2z\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">(1.27 * 10000000)KB / 月的 paste</p>\n</li>\n<li id=\"20220805101449-twx4mli\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">三年内将近 450GB 的新 paste 内容</p>\n</li>\n<li id=\"20220805101449-aw2lrz1\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">三年内 3.6 亿短链接</p>\n</li>\n<li id=\"20220805101449-aa6w4k4\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">假设大部分都是新的 paste，而不是需要更新已存在的 paste</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-vibz0il\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">平均 4paste/s 的写入速度</p>\n</li>\n<li id=\"20220805101449-s4hvjku\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">平均 40paste/s 的读取速度</p>\n</li>\n</ul>\n<h1 id=\"创建一个高层次设计\">创建一个高层次设计</h1>\n<p updated=\"20220805101449\">　　用webServer作为请求的入口，然后调用API去访问SQL。最后采用Analytics对请求数据进行分析。</p>\n<div data-content=\"graph TD;\n    客户端--&amp;gt;WebServer;\n    WebServer--&amp;gt;WriteAPI;\n    WebServer--&amp;gt;ReadAPI;\n    ReadAPI--&amp;gt;SQL;\n    WriteAPI--&amp;gt;SQL;\n   Analytics --&amp;gt;SQL;\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<h1 id=\"设计核心组件\">设计核心组件</h1>\n<h2 id=\"用例--用户输入一段文本-然后得到一个随机生成的链接\">用例: <strong>用户</strong>输入一段文本，然后得到一个随机生成的链接</h2>\n<p updated=\"20220805101449\">　　用关系型数据库直接将生成的URL映射成用户的URL。</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-m1z5hc2\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>客户端</strong> 发送一个创建 paste 的请求到作为一个<a href=\"https://github.com/donnemartin/system-design-primer/blob/master/README-zh-Hans.md#%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86web-%E6%9C%8D%E5%8A%A1%E5%99%A8\">反向代理</a>启动的  <strong>Web 服务器</strong> 。</p>\n</li>\n<li id=\"20220805101449-xsrvalm\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Web 服务器</strong> 转发请求给 <strong>写接口</strong> 服务器</p>\n</li>\n<li id=\"20220805101449-o00224g\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>写接口</strong> 服务器执行如下操作：</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-hdqpvvr\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">生成一个唯一的 url</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-q6e8o1c\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">检查这个 url 在 <strong>SQL 数据库</strong> 里面是否是唯一的</p>\n</li>\n<li id=\"20220805101449-9pow1mz\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">如果这个 url 不是唯一的，生成另外一个 url</p>\n</li>\n<li id=\"20220805101449-ryq7xia\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">如果我们支持自定义 url，我们可以使用用户提供的 url（也需要检查是否重复）</p>\n</li>\n</ul>\n</li>\n<li id=\"20220805101449-x8bot5f\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">把生成的 url 和用户的url 存储到 <strong>SQL 数据库</strong> 的 <code>pastes</code> 表里面</p>\n</li>\n<li id=\"20220805101449-4xgsv14\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">返回生成的 url</p>\n</li>\n</ul>\n</li>\n</ul>\n<p updated=\"20220805101449\">　　<code>pastes</code>结构如下:</p>\n<pre class=\"code-block\" data-language=\"sql\"><code class=\"hljs\">shortlink char(7) NOT NULL\nexpiration_length_in_minutes int NOT NULL\ncreated_at datetime NOT NULL\npaste varchar(2048) NOT NULL\nPRIMARY KEY(shortlink)\n</code></pre>\n<p updated=\"20220805101449\">　　在<code>shortlink</code>上创建一个数据库索引，用来提高查询的速度。</p>\n<h2 id=\"用例-用户输入一个-paste-的-url-后可以看到它存储的内容\">用例：用户输入一个 paste 的 url 后可以看到它存储的内容</h2>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-2uoesim\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>客户端</strong> 发送一个获取 paste 请求到 <strong>Web Server</strong></p>\n</li>\n<li id=\"20220805101449-n71zekn\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>Web Server</strong> 转发请求给 <strong>读取接口</strong> 服务器</p>\n</li>\n<li id=\"20220805101449-4oa90r8\" updated=\"20220805101449\">\n<p updated=\"20220805101449\"><strong>读取接口</strong> 服务器执行如下操作：</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-3jjst5i\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">在 <strong>SQL 数据库</strong> 检查这个生成的 url</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-5km4aly\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">如果这个 url 在 <strong>SQL 数据库</strong> 里面，则从返回这个 <code>paste</code> 的内容</p>\n</li>\n<li id=\"20220805101449-h7ep887\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">否则，返回一个错误页面给用户</p>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"用例--服务跟踪分析页面\">用例： 服务跟踪分析页面</h2>\n<p updated=\"20220805101449\">　　因为实时分析不是必须的，所以我们可以简单的 <strong>MapReduce</strong> <strong>Web Server</strong> 的日志，用来生成点击次数。</p>\n<h2 id=\"用例--服务删除过期的-pastes\">用例： 服务删除过期的 pastes</h2>\n<p updated=\"20220805101449\">　　为了删除过期的 pastes，我们可以直接搜索 <strong>SQL 数据库</strong> 中所有的过期时间比当前时间更早的记录， 所有过期的记录将从这张表里面删除（或者将其标记为过期）。</p>\n<h1 id=\"扩展设计\">扩展设计</h1>\n<div data-content=\"graph TD;\n\tClient--&amp;gt;DNS负载;\n        Client--&amp;gt;CDN回源;\n\tDNS负载--&amp;gt;LoadBalancer;\n\tLoadBalancer--&amp;gt;WebServer;\n\tWebServer--&amp;gt;WriteAPI;\n\tWebServer--&amp;gt;ReadAPI;\n\tReadAPI--&amp;gt;MemoryCache;\n\tWriteAPI--&amp;gt;SQLMaster-Slave;\n\tReadAPI--&amp;gt;SQLReadReplicas;\n\tSQLMaster-Slave --- SQLReadReplicas;\n\tAnalytics--&amp;gt;SQLAnalytics;\n\tSQLAnalytics--&amp;gt;SQLMaster-Slave\" data-subtype=\"mermaid\"><div spin=\"1\"></div></div>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-ahxq184\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">对于请求量比较大的，应该将数据留在上游，这部分可以采用CDN来代理源站，将数据放在边缘</p>\n</li>\n<li id=\"20220805101449-zr1vchg\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">使用LoadBalancer来代理我们具体的服务器，以便于可以对webServer进行水平扩展</p>\n</li>\n<li id=\"20220805101449-sr9gxsq\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">处理每秒40的读请求，其内容应该交由给内存级别的缓存来处理。比如Redis这种</p>\n</li>\n<li id=\"20220805101449-rz45515\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">对于单个关系型数据库，主从切分之后每秒4次的写入问题不大。</p>\n<p updated=\"20220805101449\">如果写入出现了瓶颈，需要额外采用别的方式。包括但不限于：</p>\n<ol updated=\"20220805101449\">\n<li id=\"20220805101449-zmcb77p\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">水平、垂直分片</p>\n</li>\n<li id=\"20220805101449-f069p7j\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">非规范化</p>\n</li>\n<li id=\"20220805101449-nf9oxq2\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">SQL调优</p>\n</li>\n</ol>\n</li>\n</ul>\n<h1 id=\"总结\">总结</h1>\n<p updated=\"20220805101449\">　　对于短链系统，整体的系统的设计大概如此，从架构方面应该是满足要求了。</p>\n<p updated=\"20220805101449\">　　其次，还有一些细节在我看来就是属于业务上的东西了，需要自行衡量,比如: 短链生成方法有好几种方式，Hash、Md5、UUID、redis、Snowflake、Mysql 自增主键。其选型并没有什么优劣之分，只有合适与否。</p>\n<p updated=\"20220805101449\">　　整个系统的诞生是一个不断优化的过程，我们需要先解决有的问题，再持续进行优化。</p>\n<ul updated=\"20220805101449\">\n<li id=\"20220805101449-xh7yl3h\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">继续对系统进行基准测试和监控，以在瓶颈出现时解决它们</p>\n</li>\n<li id=\"20220805101449-tfw3cfk\" updated=\"20220805101449\">\n<p updated=\"20220805101449\">扩展是一个迭代的过程</p>\n</li>\n</ul>\n","headings":[{"depth":1,"value":"概述用例和约束"},{"depth":2,"value":"用例"},{"depth":2,"value":"约束和假设"},{"depth":2,"value":"预估容量"},{"depth":1,"value":"创建一个高层次设计"},{"depth":1,"value":"设计核心组件"},{"depth":2,"value":"用例: 用户输入一段文本，然后得到一个随机生成的链接"},{"depth":2,"value":"用例：用户输入一个 paste 的 url 后可以看到它存储的内容"},{"depth":2,"value":"用例： 服务跟踪分析页面"},{"depth":2,"value":"用例： 服务删除过期的 pastes"},{"depth":1,"value":"扩展设计"},{"depth":1,"value":"总结"}],"path":"/topic/系统设计/样例/短链系统"},"tree":{"title":"系统设计","id":"20220523142842-5ohvsi1","parentId":"","href":"/topic/系统设计","path":"/topic/系统设计","children":[{"title":"概念","id":"20220615132453-664g7l0","type":"d","href":"/topic/系统设计/概念","parentId":"","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","sort":1,"children":[{"title":"数据库系统 VS 文件系统","id":"20220615102743-qj0plmz","type":"h","href":"/topic/系统设计/概念#数据库系统 VS 文件系统","parentId":"20220615132453-664g7l0","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[{"title":"关系","id":"20220615102811-lmbzu19","type":"h","href":"/topic/系统设计/概念#关系","parentId":"20220615102743-qj0plmz","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"区别","id":"20220615102835-8kegc0y","type":"h","href":"/topic/系统设计/概念#区别","parentId":"20220615102743-qj0plmz","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"总结","id":"20220615103035-c70ck6k","type":"h","href":"/topic/系统设计/概念#总结","parentId":"20220615102743-qj0plmz","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2},{"title":"单体架构VS微服务架构","id":"20220628154518-x6kau73","type":"h","href":"/topic/系统设计/概念#单体架构VS微服务架构","parentId":"20220615132453-664g7l0","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[{"title":"单体架构","id":"20220628154527-mj1noqe","type":"h","href":"/topic/系统设计/概念#单体架构","parentId":"20220628154518-x6kau73","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"微服务架构","id":"20220628154527-xpc8zw5","type":"h","href":"/topic/系统设计/概念#微服务架构","parentId":"20220628154518-x6kau73","path":"/topic/系统设计/概念","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2}],"level":1},{"title":"4S分析法","id":"20220531175247-wjawyqd","type":"d","href":"/topic/系统设计/4S分析法","parentId":"","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","sort":2,"children":[{"title":"Scenario场景","id":"20220614162313-ymy6pxo","type":"h","href":"/topic/系统设计/4S分析法#Scenario场景","parentId":"20220531175247-wjawyqd","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"需要设计哪些功能","id":"20220616132326-s55nquu","type":"h","href":"/topic/系统设计/4S分析法#需要设计哪些功能","parentId":"20220614162313-ymy6pxo","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"需要承受的访问量","id":"20220616132326-y5xmygg","type":"h","href":"/topic/系统设计/4S分析法#需要承受的访问量","parentId":"20220614162313-ymy6pxo","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2},{"title":"Service服务","id":"20220616132326-j1gz6ab","type":"h","href":"/topic/系统设计/4S分析法#Service服务","parentId":"20220531175247-wjawyqd","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":2},{"title":"Storage存储","id":"20220616132404-d4ylqml","type":"h","href":"/topic/系统设计/4S分析法#Storage存储","parentId":"20220531175247-wjawyqd","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"处理步骤","id":"20220616132411-bvaq4hy","type":"h","href":"/topic/系统设计/4S分析法#处理步骤","parentId":"20220616132404-d4ylqml","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"第一步：为每个Service选择存储结构","id":"20220616132411-o42gm70","type":"h","href":"/topic/系统设计/4S分析法#第一步：为每个Service选择存储结构","parentId":"20220616132411-bvaq4hy","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4},{"title":"第二步：细化表结构","id":"20220616132411-fu7embq","type":"h","href":"/topic/系统设计/4S分析法#第二步：细化表结构","parentId":"20220616132411-bvaq4hy","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4}],"level":3},{"title":"存储模型","id":"20220616132411-wuznh3m","type":"h","href":"/topic/系统设计/4S分析法#存储模型","parentId":"20220616132404-d4ylqml","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"Pull Model 拉模型","id":"20220616132411-ltf0w00","type":"h","href":"/topic/系统设计/4S分析法#Pull Model 拉模型","parentId":"20220616132411-wuznh3m","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4}],"level":3}],"level":2},{"title":"Scala扩展设计","id":"20220616132437-btg0npi","type":"h","href":"/topic/系统设计/4S分析法#Scala扩展设计","parentId":"20220531175247-wjawyqd","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"处理步骤","id":"20220616132443-l9hc1mr","type":"h","href":"/topic/系统设计/4S分析法#处理步骤","parentId":"20220616132437-btg0npi","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"第一步：优化","id":"20220616132443-i0no8v4","type":"h","href":"/topic/系统设计/4S分析法#第一步：优化","parentId":"20220616132443-l9hc1mr","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4},{"title":"第二部：维护","id":"20220616132443-xo6qd61","type":"h","href":"/topic/系统设计/4S分析法#第二部：维护","parentId":"20220616132443-l9hc1mr","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4}],"level":3},{"title":"Pull的缺陷","id":"20220616132451-87l1875","type":"h","href":"/topic/系统设计/4S分析法#Pull的缺陷","parentId":"20220616132437-btg0npi","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"Push的缺陷","id":"20220616132443-bjr9ha0","type":"h","href":"/topic/系统设计/4S分析法#Push的缺陷","parentId":"20220616132437-btg0npi","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"处理","id":"20220616132443-ezk0war","type":"h","href":"/topic/系统设计/4S分析法#处理","parentId":"20220616132437-btg0npi","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[{"title":"最小改动","id":"20220616132443-lmdkzs3","type":"h","href":"/topic/系统设计/4S分析法#最小改动","parentId":"20220616132443-ezk0war","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4},{"title":"增长预估","id":"20220616132443-1x7j1ed","type":"h","href":"/topic/系统设计/4S分析法#增长预估","parentId":"20220616132443-ezk0war","path":"/topic/系统设计/4S分析法","parentPath":"/topic/系统设计","children":[],"level":4}],"level":3}],"level":2}],"level":1},{"title":"样例","id":"20220523161014-1vkr1si","type":"d","href":"/topic/系统设计/样例","parentId":"","path":"/topic/系统设计/样例","parentPath":"/topic/系统设计","sort":3,"children":[{"title":"短链系统","id":"20220523142856-tm0dduf","type":"d","href":"/topic/系统设计/样例/短链系统","parentId":"","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","sort":1,"children":[{"title":"概述用例和约束","id":"20220523152802-ora3luz","type":"h","href":"/topic/系统设计/样例/短链系统#概述用例和约束","parentId":"20220523142856-tm0dduf","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[{"title":"用例","id":"20220523153231-cqe7c6z","type":"h","href":"/topic/系统设计/样例/短链系统#用例","parentId":"20220523152802-ora3luz","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"约束和假设","id":"20220523153213-tyokdre","type":"h","href":"/topic/系统设计/样例/短链系统#约束和假设","parentId":"20220523152802-ora3luz","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"预估容量","id":"20220523153245-akx221a","type":"h","href":"/topic/系统设计/样例/短链系统#预估容量","parentId":"20220523152802-ora3luz","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4}],"level":3},{"title":"创建一个高层次设计","id":"20220523154027-n2m6mb0","type":"h","href":"/topic/系统设计/样例/短链系统#创建一个高层次设计","parentId":"20220523142856-tm0dduf","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":3},{"title":"设计核心组件","id":"20220523155756-as6zfq4","type":"h","href":"/topic/系统设计/样例/短链系统#设计核心组件","parentId":"20220523142856-tm0dduf","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[{"title":"用例: 用户输入一段文本，然后得到一个随机生成的链接","id":"20220523155920-i5awrmn","type":"h","href":"/topic/系统设计/样例/短链系统#用例: 用户输入一段文本，然后得到一个随机生成的链接","parentId":"20220523155756-as6zfq4","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"用例：用户输入一个 paste 的 url 后可以看到它存储的内容","id":"20220523160445-ppzjfcg","type":"h","href":"/topic/系统设计/样例/短链系统#用例：用户输入一个 paste 的 url 后可以看到它存储的内容","parentId":"20220523155756-as6zfq4","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"用例： 服务跟踪分析页面","id":"20220523160523-x0zwdli","type":"h","href":"/topic/系统设计/样例/短链系统#用例： 服务跟踪分析页面","parentId":"20220523155756-as6zfq4","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"用例： 服务删除过期的 pastes","id":"20220523160541-cln3fph","type":"h","href":"/topic/系统设计/样例/短链系统#用例： 服务删除过期的 pastes","parentId":"20220523155756-as6zfq4","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":4}],"level":3},{"title":"扩展设计","id":"20220523160546-vbv6n9j","type":"h","href":"/topic/系统设计/样例/短链系统#扩展设计","parentId":"20220523142856-tm0dduf","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":3},{"title":"总结","id":"20220523163729-9u3wkrv","type":"h","href":"/topic/系统设计/样例/短链系统#总结","parentId":"20220523142856-tm0dduf","path":"/topic/系统设计/样例/短链系统","parentPath":"/topic/系统设计/样例","children":[],"level":3}],"level":2},{"title":"微博架构设计","id":"20220524140048-zkiqvui","type":"d","href":"/topic/系统设计/样例/微博架构设计","parentId":"","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","sort":2,"children":[{"title":"概述用例和约束","id":"20220524140533-yb6pk63","type":"h","href":"/topic/系统设计/样例/微博架构设计#概述用例和约束","parentId":"20220524140048-zkiqvui","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[{"title":"用例","id":"20220524140955-hl15d6z","type":"h","href":"/topic/系统设计/样例/微博架构设计#用例","parentId":"20220524140533-yb6pk63","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"限制条件与假设","id":"20220524142056-m6nm6xm","type":"h","href":"/topic/系统设计/样例/微博架构设计#限制条件与假设","parentId":"20220524140533-yb6pk63","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":4}],"level":3},{"title":"概要设计","id":"20220524145303-hrsunb1","type":"h","href":"/topic/系统设计/样例/微博架构设计#概要设计","parentId":"20220524140048-zkiqvui","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":3},{"title":"设计核心组件","id":"20220524154837-c7lw852","type":"h","href":"/topic/系统设计/样例/微博架构设计#设计核心组件","parentId":"20220524140048-zkiqvui","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[{"title":"用例: 用户发表了一篇微博","id":"20220524155958-ygnj4py","type":"h","href":"/topic/系统设计/样例/微博架构设计#用例: 用户发表了一篇微博","parentId":"20220524154837-c7lw852","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"用例：用户浏览聚合主页时间轴","id":"20220524163832-k1u2urx","type":"h","href":"/topic/系统设计/样例/微博架构设计#用例：用户浏览聚合主页时间轴","parentId":"20220524154837-c7lw852","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"用例：用户浏览用户时间轴","id":"20220524164247-audibq3","type":"h","href":"/topic/系统设计/样例/微博架构设计#用例：用户浏览用户时间轴","parentId":"20220524154837-c7lw852","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"用例：用户搜索关键词","id":"20220524164312-1obgv97","type":"h","href":"/topic/系统设计/样例/微博架构设计#用例：用户搜索关键词","parentId":"20220524154837-c7lw852","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":4}],"level":3},{"title":"架构扩展","id":"20220524164325-q9o9ung","type":"h","href":"/topic/系统设计/样例/微博架构设计#架构扩展","parentId":"20220524140048-zkiqvui","path":"/topic/系统设计/样例/微博架构设计","parentPath":"/topic/系统设计/样例","children":[],"level":3}],"level":2},{"title":"秒杀","id":"20220616202141-hy1nbif","type":"d","href":"/topic/系统设计/样例/秒杀","parentId":"","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","sort":4,"children":[{"title":"Scenario场景","id":"20220616202308-9bgzn5z","type":"h","href":"/topic/系统设计/样例/秒杀#Scenario场景","parentId":"20220616202141-hy1nbif","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[{"title":"需求拆解","id":"20220623170337-upk31iw","type":"h","href":"/topic/系统设计/样例/秒杀#需求拆解","parentId":"20220616202308-9bgzn5z","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4}],"level":3},{"title":"Service 服务","id":"20220623170617-lfeu5ob","type":"h","href":"/topic/系统设计/样例/秒杀#Service 服务","parentId":"20220616202141-hy1nbif","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":3},{"title":"Storage存储","id":"20220623210002-oh2z3zd","type":"h","href":"/topic/系统设计/样例/秒杀#Storage存储","parentId":"20220616202141-hy1nbif","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[{"title":"商品信息表 commodity_info","id":"20220624113741-lsybjg4","type":"h","href":"/topic/系统设计/样例/秒杀#商品信息表 commodity_info","parentId":"20220623210002-oh2z3zd","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"秒杀活动表 seckill_info","id":"20220624113935-pc2me4m","type":"h","href":"/topic/系统设计/样例/秒杀#秒杀活动表 seckill_info","parentId":"20220623210002-oh2z3zd","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"库存信息表 stock_info","id":"20220624131344-2oot3xz","type":"h","href":"/topic/系统设计/样例/秒杀#库存信息表 stock_info","parentId":"20220623210002-oh2z3zd","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"订单信息表 order_info","id":"20220624131601-lgvwksl","type":"h","href":"/topic/系统设计/样例/秒杀#订单信息表 order_info","parentId":"20220623210002-oh2z3zd","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"数据流向","id":"20220624131855-pzpipel","type":"h","href":"/topic/系统设计/样例/秒杀#数据流向","parentId":"20220623210002-oh2z3zd","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4}],"level":3},{"title":"Scala扩展设计","id":"20220628155648-7dj6e6e","type":"h","href":"/topic/系统设计/样例/秒杀#Scala扩展设计","parentId":"20220616202141-hy1nbif","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[{"title":"数据一致性","id":"20220628155654-6w1zago","type":"h","href":"/topic/系统设计/样例/秒杀#数据一致性","parentId":"20220628155648-7dj6e6e","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"应对高QPS","id":"20220628155339-dp92t46","type":"h","href":"/topic/系统设计/样例/秒杀#应对高QPS","parentId":"20220628155648-7dj6e6e","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"Redis的缺陷优化","id":"20220628132922-1wcck7q","type":"h","href":"/topic/系统设计/样例/秒杀#Redis的缺陷优化","parentId":"20220628155648-7dj6e6e","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"这样就完美了吗？","id":"20220628134645-m8f0zw1","type":"h","href":"/topic/系统设计/样例/秒杀#这样就完美了吗？","parentId":"20220628155648-7dj6e6e","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"分布式事务","id":"20220628135940-s7irnu6","type":"h","href":"/topic/系统设计/样例/秒杀#分布式事务","parentId":"20220628155648-7dj6e6e","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":4},{"title":"其他的小细节","id":"20220628165937-aaii6h7","type":"h","href":"/topic/系统设计/样例/秒杀#其他的小细节","parentId":"20220628155648-7dj6e6e","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[{"title":"防止刷爆商品页面","id":"20220628140318-7jb6y79","type":"h","href":"/topic/系统设计/样例/秒杀#防止刷爆商品页面","parentId":"20220628165937-aaii6h7","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":5},{"title":"服务高可用","id":"20220628140639-2r8f6ir","type":"h","href":"/topic/系统设计/样例/秒杀#服务高可用","parentId":"20220628165937-aaii6h7","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":5},{"title":"防止恶意刷请求或者爬虫请求","id":"20220628140847-bweqsx9","type":"h","href":"/topic/系统设计/样例/秒杀#防止恶意刷请求或者爬虫请求","parentId":"20220628165937-aaii6h7","path":"/topic/系统设计/样例/秒杀","parentPath":"/topic/系统设计/样例","children":[],"level":5}],"level":4}],"level":3}],"level":2}],"level":1},{"title":"每个程序员都应该知道的延迟数字","id":"20220524194105-29b5zns","type":"d","href":"/topic/系统设计/每个程序员都应该知道的延迟数字","parentId":"","path":"/topic/系统设计/每个程序员都应该知道的延迟数字","parentPath":"/topic/系统设计","sort":4,"children":[],"level":1},{"title":"Flux架构","id":"20220630203113-cjoqcbf","type":"d","href":"/topic/系统设计/Flux架构","parentId":"","path":"/topic/系统设计/Flux架构","parentPath":"/topic/系统设计","sort":5,"children":[],"level":1},{"title":"Http进化史","id":"20220701132636-sffchc7","type":"d","href":"/topic/系统设计/Http进化史","parentId":"","path":"/topic/系统设计/Http进化史","parentPath":"/topic/系统设计","children":[],"level":1},{"title":"系统常见故障","id":"20220802204018-p5gpqgu","type":"d","href":"/topic/系统设计/系统常见故障","parentId":"","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"写日志引发的故障","id":"20220802204332-hy5xsnl","type":"h","href":"/topic/系统设计/系统常见故障#写日志引发的故障","parentId":"20220802204018-p5gpqgu","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"故障现象","id":"20220802204350-kpdasf1","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220802204401-md2j3m3","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220802204350-ldt4g70","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"高并发访问数据库引发的故障","id":"20220802204803-glrzawa","type":"h","href":"/topic/系统设计/系统常见故障#高并发访问数据库引发的故障","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"故障现象","id":"20220802204811-i9rkjhk","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220802204811-6m31i3r","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220802204811-9z16at5","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220802204332-hy5xsnl","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2},{"title":"高并发情况下锁引发的故障","id":"20220802212352-0uxx339","type":"h","href":"/topic/系统设计/系统常见故障#高并发情况下锁引发的故障","parentId":"20220802204018-p5gpqgu","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"故障现象","id":"20220802212404-8lfbbya","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220802212352-0uxx339","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220802212408-e2921pf","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220802212352-0uxx339","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220802212400-571z94t","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220802212352-0uxx339","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"缓存引发的故障","id":"20220805093210-m7lrlf2","type":"h","href":"/topic/系统设计/系统常见故障#缓存引发的故障","parentId":"20220802212352-0uxx339","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"故障现象","id":"20220805093221-pm7o2e4","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220802212352-0uxx339","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220805093239-s0zm5uc","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220802212352-0uxx339","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"经验教训","id":"20220805093239-dkcg9j1","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220805093239-s0zm5uc","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":4}],"level":3}],"level":2},{"title":"应用启动不同步引发的故障","id":"20220805093446-cypkdar","type":"h","href":"/topic/系统设计/系统常见故障#应用启动不同步引发的故障","parentId":"20220802204018-p5gpqgu","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"故障现象","id":"20220805093450-omj1m8k","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220805093446-cypkdar","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220805093446-ycpvo18","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220805093446-cypkdar","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220805093511-eji1e9f","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220805093446-cypkdar","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2},{"title":"大文件读写独占磁盘引发的故障","id":"20220805095411-ps3caqq","type":"h","href":"/topic/系统设计/系统常见故障#大文件读写独占磁盘引发的故障","parentId":"20220802204018-p5gpqgu","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"故障现象","id":"20220805095418-yzbpm82","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220805095411-ps3caqq","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220805095411-8oz0ee9","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220805095411-ps3caqq","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220805095411-plav986","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220805095411-ps3caqq","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2},{"title":"滥用生产环境引发的故障","id":"20220805095411-vqiw12l","type":"h","href":"/topic/系统设计/系统常见故障#滥用生产环境引发的故障","parentId":"20220802204018-p5gpqgu","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"故障现象","id":"20220805095411-387t1yi","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220805095411-vqiw12l","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220805095411-g1pdror","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220805095411-vqiw12l","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220805095411-ghccimu","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220805095411-vqiw12l","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2},{"title":"不规范的流程引发的故障","id":"20220805095411-46g2x35","type":"h","href":"/topic/系统设计/系统常见故障#不规范的流程引发的故障","parentId":"20220802204018-p5gpqgu","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[{"title":"故障现象","id":"20220805095650-sp6wd01","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220805095411-mwo9xvd","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220805095411-1h1bd30","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"不好的编程习惯引发的故障","id":"20220805095411-9s3d4la","type":"h","href":"/topic/系统设计/系统常见故障#不好的编程习惯引发的故障","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"故障现象","id":"20220805095411-14szlt8","type":"h","href":"/topic/系统设计/系统常见故障#故障现象","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"原因分析","id":"20220805095411-s1rg4us","type":"h","href":"/topic/系统设计/系统常见故障#原因分析","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3},{"title":"经验教训","id":"20220805095411-nx6hepo","type":"h","href":"/topic/系统设计/系统常见故障#经验教训","parentId":"20220805095411-46g2x35","path":"/topic/系统设计/系统常见故障","parentPath":"/topic/系统设计","children":[],"level":3}],"level":2}],"level":1}],"level":0},"headings":[{"depth":1,"value":"概述用例和约束","slug":"概述用例和约束"},{"depth":2,"value":"用例","slug":"用例"},{"depth":2,"value":"约束和假设","slug":"约束和假设"},{"depth":2,"value":"预估容量","slug":"预估容量"},{"depth":1,"value":"创建一个高层次设计","slug":"创建一个高层次设计"},{"depth":1,"value":"设计核心组件","slug":"设计核心组件"},{"depth":2,"value":"用例: 用户输入一段文本，然后得到一个随机生成的链接","slug":"用例-用户输入一段文本然后得到一个随机生成的链接"},{"depth":2,"value":"用例：用户输入一个 paste 的 url 后可以看到它存储的内容","slug":"用例用户输入一个-paste-的-url-后可以看到它存储的内容"},{"depth":2,"value":"用例： 服务跟踪分析页面","slug":"用例-服务跟踪分析页面"},{"depth":2,"value":"用例： 服务删除过期的 pastes","slug":"用例-服务删除过期的-pastes"},{"depth":1,"value":"扩展设计","slug":"扩展设计"},{"depth":1,"value":"总结","slug":"总结"}]}},
    "staticQueryHashes": ["630634786","928362550"]}