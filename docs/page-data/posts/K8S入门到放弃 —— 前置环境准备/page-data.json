{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/K8S入门到放弃 —— 前置环境准备","result":{"data":{"siYuan":{"excerpt":"K8S入门到放弃 —— 前置环境准备 安装 docker / kubelet 在每台要安装的机器上都执行这段脚本，安装所有k8s运行时需要的软件。 #!/bin/bash 卸载旧版本 sudo yum remove docker \\ doc...","raw":"# K8S入门到放弃 —— 前置环境准备\n\n# 安装 docker / kubelet\n\n在每台要安装的机器上都执行这段脚本，安装所有k8s运行时需要的软件。\n\n```\n#!/bin/bash\n# 卸载旧版本\nsudo yum remove docker \\\n                  docker-client \\\n                  docker-client-latest \\\n                  docker-common \\\n                  docker-latest \\\n                  docker-latest-logrotate \\\n                  docker-logrotate \\\n                  docker-engine\n sudo yum install -y yum-utils\n yum-config-manager \\\n    --add-repo \\\n    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n\nsed -i 's/download.docker.com/mirrors.aliyun.com\\/docker-ce/g' /etc/yum.repos.d/docker-ce.repo\n# 安装并启动 docker\nsudo yum -y install docker-ce docker-ce-cli containerd.io    \nsystemctl enable docker\nsystemctl start docker\nsystemctl stop firewalld\nsystemctl disable firewalld\n\n# 安装 nfs-utils\n# 必须先安装 nfs-utils 才能挂载 nfs 网络存储\nyum install -y nfs-utils\nyum install -y wget\n\n# 关闭 SeLinux\nsetenforce 0\nsed -i \"s/SELINUX=enforcing/SELINUX=disabled/g\" /etc/selinux/config\n\n# 关闭 swap\nswapoff -a\nyes | cp /etc/fstab /etc/fstab_bak\ncat /etc/fstab_bak |grep -v swap > /etc/fstab\n# 修改 /etc/sysctl.conf\n# 如果有配置，则修改\nsed -i \"s#^net.ipv4.ip_forward.*#net.ipv4.ip_forward=1#g\"  /etc/sysctl.conf\nsed -i \"s#^net.bridge.bridge-nf-call-ip6tables.*#net.bridge.bridge-nf-call-ip6tables=1#g\"  /etc/sysctl.conf\nsed -i \"s#^net.bridge.bridge-nf-call-iptables.*#net.bridge.bridge-nf-call-iptables=1#g\"  /etc/sysctl.conf\n# 可能没有，追加\necho \"net.ipv4.ip_forward = 1\" >> /etc/sysctl.conf\necho \"net.bridge.bridge-nf-call-ip6tables = 1\" >> /etc/sysctl.conf\necho \"net.bridge.bridge-nf-call-iptables = 1\" >> /etc/sysctl.conf\n# 执行命令以应用\nsysctl -p\n\n# 卸载旧版本\nsudo yum remove -y kubelet kubeadm kubectl\nsudo yum install -y kubelet kubeadm kubectl\n\n# 重启 docker，并启动 kubelet\nsystemctl daemon-reload\nsystemctl restart docker\nsystemctl enable kubelet && systemctl start kubelet\n```\n","field":{"slug":"/posts/K8S入门到放弃 —— 前置环境准备"},"frontmatter":{"title":"K8S入门到放弃 —— 前置环境准备","tags":["K8S"],"date":"2022-04-21","description":"K8S入门到放弃 —— 前置环境准备 安装 docker / kubelet 在每台要安装的机器上都执行这段脚本，安装所有k8s运行时需要的软件。 #!/bin/bash 卸载旧版本 sudo yum remove docker \\ doc..."}},"prev":{"frontmatter":{"title":"苹果 macOS 12 Monterey 升级"},"field":{"slug":"/posts/苹果 macOS 12 Monterey 升级"}},"next":{"frontmatter":{"title":"K8S入门到放弃 —— 初始化节点"},"field":{"slug":"/posts/K8S入门到放弃 —— 初始化节点"}}},"pageContext":{"slug":"/posts/K8S入门到放弃 —— 前置环境准备","prevSlug":"/posts/苹果 macOS 12 Monterey 升级","nextSlug":"/posts/K8S入门到放弃 —— 初始化节点"}},"staticQueryHashes":["1284643331","2841359383"]}