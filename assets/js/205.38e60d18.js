(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{471:function(_,t,v){"use strict";v.r(t);var i=v(7),s=Object(i.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("h1",{attrs:{id:"缓存雪崩"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缓存雪崩"}},[_._v("#")]),_._v(" 缓存雪崩")]),_._v(" "),t("p",[_._v("当某一个时刻出现大规模的缓存失效，那么就会导致大量的请求打在数据库上面，导致数据库压力巨大，如果在高并发的情况下，可能瞬间就导致数据库党纪。")]),_._v(" "),t("p",[_._v("如果这个时候，马上重启数据库，马上又会有新的流量把数据库打死。")]),_._v(" "),t("p",[t("img",{attrs:{src:"https://www.shiyitopo.tech/uPic/Xnip2021-09-16_16-10-29.jpg",alt:"Xnip2021-09-16_16-10-29"}})]),_._v(" "),t("p",[_._v("造成缓存大规模失效的原因：")]),_._v(" "),t("ol",[t("li",[_._v("Redis宕机")]),_._v(" "),t("li",[_._v("大量的热点Key在相同的时间过期")])]),_._v(" "),t("h1",{attrs:{id:"解决方案"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解决方案"}},[_._v("#")]),_._v(" 解决方案")]),_._v(" "),t("h2",{attrs:{id:"三步骤"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#三步骤"}},[_._v("#")]),_._v(" 三步骤")]),_._v(" "),t("ul",[t("li",[_._v("事前：redis高可用部署，避免全盘崩溃；")]),_._v(" "),t("li",[_._v("事中：本地缓存 + 限流降级，避免数据库被打死；")]),_._v(" "),t("li",[_._v("事后：redis持久化，快速恢复缓存数据；")])]),_._v(" "),t("ul",[t("li",[_._v("Redis集群高可用\n"),t("ul",[t("li",[_._v("主从+哨兵")]),_._v(" "),t("li",[_._v("Redis Cluster")])])]),_._v(" "),t("li",[_._v("Redis开启AOF/RDB，尽快恢复redis访问")]),_._v(" "),t("li",[_._v("热点key随机过期时间\n"),t("ul",[t("li",[_._v("避免在同一个时间，请求涌入数据库")])])]),_._v(" "),t("li",[_._v("提高数据库的容灾能力\n"),t("ul",[t("li",[_._v("分库分表")]),_._v(" "),t("li",[_._v("读写分离")])])]),_._v(" "),t("li",[_._v("熔断限流降级\n"),t("ul",[t("li",[_._v("Hystrix")]),_._v(" "),t("li",[_._v("阿里sentinel")])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);